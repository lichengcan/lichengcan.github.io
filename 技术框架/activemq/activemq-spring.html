<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>CCNAIVE</title>
    <meta name="generator" content="VuePress 1.9.9">
    
    <meta name="description" content="å°ç¿çš„å­¦ä¹ æ—¥è®°">
    
    <link rel="preload" href="/assets/css/0.styles.ac0ba637.css" as="style"><link rel="preload" href="/assets/js/app.9ff2d364.js" as="script"><link rel="preload" href="/assets/js/3.531b82cf.js" as="script"><link rel="preload" href="/assets/js/1.66bfa7cb.js" as="script"><link rel="preload" href="/assets/js/122.a2372c82.js" as="script"><link rel="prefetch" href="/assets/js/10.bbcc4f2b.js"><link rel="prefetch" href="/assets/js/100.7aa78320.js"><link rel="prefetch" href="/assets/js/101.be1a84ed.js"><link rel="prefetch" href="/assets/js/102.e54a66c3.js"><link rel="prefetch" href="/assets/js/103.96ea8db8.js"><link rel="prefetch" href="/assets/js/104.1843f7ee.js"><link rel="prefetch" href="/assets/js/105.5cb7f1d0.js"><link rel="prefetch" href="/assets/js/106.d0836c05.js"><link rel="prefetch" href="/assets/js/107.ac03de3a.js"><link rel="prefetch" href="/assets/js/108.050b9491.js"><link rel="prefetch" href="/assets/js/109.77d90976.js"><link rel="prefetch" href="/assets/js/11.7cbe3508.js"><link rel="prefetch" href="/assets/js/110.d8921d36.js"><link rel="prefetch" href="/assets/js/111.e834d261.js"><link rel="prefetch" href="/assets/js/112.fc17c22f.js"><link rel="prefetch" href="/assets/js/113.4a13e794.js"><link rel="prefetch" href="/assets/js/114.a0fc2dc4.js"><link rel="prefetch" href="/assets/js/115.c52d7495.js"><link rel="prefetch" href="/assets/js/116.18b15740.js"><link rel="prefetch" href="/assets/js/117.d5961bc5.js"><link rel="prefetch" href="/assets/js/118.ae8cd8e7.js"><link rel="prefetch" href="/assets/js/119.dbabe50a.js"><link rel="prefetch" href="/assets/js/12.03e80136.js"><link rel="prefetch" href="/assets/js/120.0a552300.js"><link rel="prefetch" href="/assets/js/121.0b55973d.js"><link rel="prefetch" href="/assets/js/123.9a1ed746.js"><link rel="prefetch" href="/assets/js/124.81c9bce0.js"><link rel="prefetch" href="/assets/js/125.9cc747cb.js"><link rel="prefetch" href="/assets/js/126.63641e51.js"><link rel="prefetch" href="/assets/js/127.afa36756.js"><link rel="prefetch" href="/assets/js/128.c3a0bafc.js"><link rel="prefetch" href="/assets/js/129.626bef76.js"><link rel="prefetch" href="/assets/js/13.98d91332.js"><link rel="prefetch" href="/assets/js/130.718e36e5.js"><link rel="prefetch" href="/assets/js/131.2f866590.js"><link rel="prefetch" href="/assets/js/132.eeae6af5.js"><link rel="prefetch" href="/assets/js/133.5f7161d3.js"><link rel="prefetch" href="/assets/js/134.d370c48c.js"><link rel="prefetch" href="/assets/js/135.cb4d88e1.js"><link rel="prefetch" href="/assets/js/136.49c2b181.js"><link rel="prefetch" href="/assets/js/137.4d5d406c.js"><link rel="prefetch" href="/assets/js/138.35297bdc.js"><link rel="prefetch" href="/assets/js/139.4cde83dd.js"><link rel="prefetch" href="/assets/js/14.5f24a2ff.js"><link rel="prefetch" href="/assets/js/140.1fba8365.js"><link rel="prefetch" href="/assets/js/141.cb4421c0.js"><link rel="prefetch" href="/assets/js/142.ea1fe29a.js"><link rel="prefetch" href="/assets/js/143.b21df084.js"><link rel="prefetch" href="/assets/js/144.a5450651.js"><link rel="prefetch" href="/assets/js/145.4a9f1b6c.js"><link rel="prefetch" href="/assets/js/146.032cd6ee.js"><link rel="prefetch" href="/assets/js/147.0ee0cf1b.js"><link rel="prefetch" href="/assets/js/148.3954607b.js"><link rel="prefetch" href="/assets/js/149.550f7938.js"><link rel="prefetch" href="/assets/js/15.1dd4d056.js"><link rel="prefetch" href="/assets/js/150.6b5ff9f8.js"><link rel="prefetch" href="/assets/js/151.7435d46f.js"><link rel="prefetch" href="/assets/js/152.4bb838b9.js"><link rel="prefetch" href="/assets/js/153.13d7f61b.js"><link rel="prefetch" href="/assets/js/154.c2c89d66.js"><link rel="prefetch" href="/assets/js/155.28853989.js"><link rel="prefetch" href="/assets/js/156.d207ca7c.js"><link rel="prefetch" href="/assets/js/157.9f4a887f.js"><link rel="prefetch" href="/assets/js/158.56a32b96.js"><link rel="prefetch" href="/assets/js/159.ccff2e00.js"><link rel="prefetch" href="/assets/js/16.9df877bb.js"><link rel="prefetch" href="/assets/js/160.1ce908c3.js"><link rel="prefetch" href="/assets/js/161.db87a48e.js"><link rel="prefetch" href="/assets/js/162.da596968.js"><link rel="prefetch" href="/assets/js/163.4b1914f2.js"><link rel="prefetch" href="/assets/js/164.d1428de2.js"><link rel="prefetch" href="/assets/js/165.3555dd76.js"><link rel="prefetch" href="/assets/js/166.3ec9c434.js"><link rel="prefetch" href="/assets/js/167.e1c89e9e.js"><link rel="prefetch" href="/assets/js/168.0a520b94.js"><link rel="prefetch" href="/assets/js/169.4122d818.js"><link rel="prefetch" href="/assets/js/17.cd29530c.js"><link rel="prefetch" href="/assets/js/170.0ac3b66b.js"><link rel="prefetch" href="/assets/js/171.a3a64b2d.js"><link rel="prefetch" href="/assets/js/172.7ac6a10c.js"><link rel="prefetch" href="/assets/js/173.4be2f7b1.js"><link rel="prefetch" href="/assets/js/174.0dfc7fdb.js"><link rel="prefetch" href="/assets/js/175.32ead0bc.js"><link rel="prefetch" href="/assets/js/176.209b5dbb.js"><link rel="prefetch" href="/assets/js/177.11adbb39.js"><link rel="prefetch" href="/assets/js/178.037a7502.js"><link rel="prefetch" href="/assets/js/18.097816ce.js"><link rel="prefetch" href="/assets/js/19.187e5563.js"><link rel="prefetch" href="/assets/js/20.6deb3fe1.js"><link rel="prefetch" href="/assets/js/21.9d82a949.js"><link rel="prefetch" href="/assets/js/22.0edad57f.js"><link rel="prefetch" href="/assets/js/23.b9c5f664.js"><link rel="prefetch" href="/assets/js/24.897f1420.js"><link rel="prefetch" href="/assets/js/25.1311359f.js"><link rel="prefetch" href="/assets/js/26.17a94cd7.js"><link rel="prefetch" href="/assets/js/27.fa379248.js"><link rel="prefetch" href="/assets/js/28.f6aab20b.js"><link rel="prefetch" href="/assets/js/29.d9c56383.js"><link rel="prefetch" href="/assets/js/30.8dba19c8.js"><link rel="prefetch" href="/assets/js/31.10a83a0f.js"><link rel="prefetch" href="/assets/js/32.edae26a7.js"><link rel="prefetch" href="/assets/js/33.72f0a131.js"><link rel="prefetch" href="/assets/js/34.5a0fb7ca.js"><link rel="prefetch" href="/assets/js/35.9f28286e.js"><link rel="prefetch" href="/assets/js/36.ae243faa.js"><link rel="prefetch" href="/assets/js/37.381ff339.js"><link rel="prefetch" href="/assets/js/38.17ebee17.js"><link rel="prefetch" href="/assets/js/39.876319cd.js"><link rel="prefetch" href="/assets/js/4.979f9922.js"><link rel="prefetch" href="/assets/js/40.b2cec200.js"><link rel="prefetch" href="/assets/js/41.91b3553a.js"><link rel="prefetch" href="/assets/js/42.80320f96.js"><link rel="prefetch" href="/assets/js/43.783075f8.js"><link rel="prefetch" href="/assets/js/44.5b01350d.js"><link rel="prefetch" href="/assets/js/45.95d4d094.js"><link rel="prefetch" href="/assets/js/46.96cea9c3.js"><link rel="prefetch" href="/assets/js/47.23ced73b.js"><link rel="prefetch" href="/assets/js/48.04da13e7.js"><link rel="prefetch" href="/assets/js/49.2b134421.js"><link rel="prefetch" href="/assets/js/5.dda74e2f.js"><link rel="prefetch" href="/assets/js/50.cbbc36b3.js"><link rel="prefetch" href="/assets/js/51.c1a47ca0.js"><link rel="prefetch" href="/assets/js/52.36261b66.js"><link rel="prefetch" href="/assets/js/53.4d53e570.js"><link rel="prefetch" href="/assets/js/54.13e1603f.js"><link rel="prefetch" href="/assets/js/55.809c8ddc.js"><link rel="prefetch" href="/assets/js/56.5df2380e.js"><link rel="prefetch" href="/assets/js/57.2194d408.js"><link rel="prefetch" href="/assets/js/58.2c620696.js"><link rel="prefetch" href="/assets/js/59.34ee045d.js"><link rel="prefetch" href="/assets/js/6.5eed2fc3.js"><link rel="prefetch" href="/assets/js/60.3f617150.js"><link rel="prefetch" href="/assets/js/61.92698d83.js"><link rel="prefetch" href="/assets/js/62.0bfecc40.js"><link rel="prefetch" href="/assets/js/63.8da717e4.js"><link rel="prefetch" href="/assets/js/64.200fd49a.js"><link rel="prefetch" href="/assets/js/65.72a58cca.js"><link rel="prefetch" href="/assets/js/66.2985426d.js"><link rel="prefetch" href="/assets/js/67.8862ebfb.js"><link rel="prefetch" href="/assets/js/68.6f5b02a9.js"><link rel="prefetch" href="/assets/js/69.aa496fb1.js"><link rel="prefetch" href="/assets/js/7.8f40985b.js"><link rel="prefetch" href="/assets/js/70.b26013d6.js"><link rel="prefetch" href="/assets/js/71.1b1ae916.js"><link rel="prefetch" href="/assets/js/72.3035363e.js"><link rel="prefetch" href="/assets/js/73.eca6d0df.js"><link rel="prefetch" href="/assets/js/74.d4240c34.js"><link rel="prefetch" href="/assets/js/75.4dcd7ab1.js"><link rel="prefetch" href="/assets/js/76.e0675e49.js"><link rel="prefetch" href="/assets/js/77.edf24e37.js"><link rel="prefetch" href="/assets/js/78.552224f2.js"><link rel="prefetch" href="/assets/js/79.be7a41b6.js"><link rel="prefetch" href="/assets/js/8.e3dca3e1.js"><link rel="prefetch" href="/assets/js/80.147a04c7.js"><link rel="prefetch" href="/assets/js/81.3ecd3a95.js"><link rel="prefetch" href="/assets/js/82.b647894f.js"><link rel="prefetch" href="/assets/js/83.200bc3a6.js"><link rel="prefetch" href="/assets/js/84.a15d5403.js"><link rel="prefetch" href="/assets/js/85.75a34ef2.js"><link rel="prefetch" href="/assets/js/86.6b4e2beb.js"><link rel="prefetch" href="/assets/js/87.b15ce75c.js"><link rel="prefetch" href="/assets/js/88.507b99bb.js"><link rel="prefetch" href="/assets/js/89.b5d5b184.js"><link rel="prefetch" href="/assets/js/9.a4890a44.js"><link rel="prefetch" href="/assets/js/90.40064807.js"><link rel="prefetch" href="/assets/js/91.5cab932b.js"><link rel="prefetch" href="/assets/js/92.8682710e.js"><link rel="prefetch" href="/assets/js/93.78582e33.js"><link rel="prefetch" href="/assets/js/94.48896994.js"><link rel="prefetch" href="/assets/js/95.b637124b.js"><link rel="prefetch" href="/assets/js/96.07d46f7c.js"><link rel="prefetch" href="/assets/js/97.c24e0b91.js"><link rel="prefetch" href="/assets/js/98.d6a95e55.js"><link rel="prefetch" href="/assets/js/99.9330a585.js">
    <link rel="stylesheet" href="/assets/css/0.styles.ac0ba637.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-7dd95ae2><div data-v-7dd95ae2><div class="password-shadow password-wrapper-out" style="display:none;" data-v-59e6cb88 data-v-7dd95ae2 data-v-7dd95ae2><h3 class="title" data-v-59e6cb88>CCNAIVE</h3> <p class="description" data-v-59e6cb88>å°ç¿çš„å­¦ä¹ æ—¥è®°</p> <label id="box" class="inputBox" data-v-59e6cb88><input type="password" value="" data-v-59e6cb88> <span data-v-59e6cb88>Konck! Knock!</span> <button data-v-59e6cb88>OK</button></label> <div class="footer" data-v-59e6cb88><span data-v-59e6cb88><i class="iconfont reco-theme" data-v-59e6cb88></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-59e6cb88>vuePress-theme-reco</a></span> <span data-v-59e6cb88><i class="iconfont reco-copyright" data-v-59e6cb88></i> <a data-v-59e6cb88><!---->
        Â Â 
        <!---->
        2025
      </a></span></div></div> <div class="hide" data-v-7dd95ae2><header class="navbar" data-v-7dd95ae2><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">CCNAIVE</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link"><i class="undefined"></i>
  é¦–é¡µ
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      å°ç¿çš„å­¦ä¹ æ—¥è®°
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/lichengcan" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://gitee.com/lichengcan0228/lichengcan0228" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  Gitee
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-7dd95ae2></div> <aside class="sidebar" data-v-7dd95ae2><div class="personal-info-wrapper" data-v-1fad0c41 data-v-7dd95ae2><!----> <!----> <div class="num" data-v-1fad0c41><div data-v-1fad0c41><h3 data-v-1fad0c41>160</h3> <h6 data-v-1fad0c41>æ–‡ç« </h6></div> <div data-v-1fad0c41><h3 data-v-1fad0c41>6</h3> <h6 data-v-1fad0c41>æ ‡ç­¾</h6></div></div> <ul class="social-links" data-v-1fad0c41></ul> <hr data-v-1fad0c41></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link"><i class="undefined"></i>
  é¦–é¡µ
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      å°ç¿çš„å­¦ä¹ æ—¥è®°
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/lichengcan" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://gitee.com/lichengcan0228/lichengcan0228" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  Gitee
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav> <ul class="sidebar-links"><li><a href="/" aria-current="page" class="sidebar-link">CCNAIVE</a></li><li><section class="sidebar-group collapsable depth-0"><a href="/Java/é¢å‘å¯¹è±¡/å¤šæ€" class="sidebar-heading clickable"><span>Java ä»å…¥é—¨åˆ°æ”¾å¼ƒ</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/æ•°æ®ç»“æ„ä¸ç®—æ³•/æ’åº/æ’åº" class="sidebar-heading clickable"><span>æ•°æ®ç»“æ„ä¸ç®—æ³•</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/ç½‘ç»œ/åŸºç¡€ç¯‡/TCP-IP" class="sidebar-heading clickable"><span>ç½‘ç»œ</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/Spring/Spring/Spring" class="sidebar-heading clickable"><span>Spring å…¨å®¶æ¡¶</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/æ•°æ®åº“/MySQL/CommonUseSQL" class="sidebar-heading clickable"><span>æ•°æ®åº“</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/æŠ€æœ¯æ¡†æ¶/rabbitmq/rabbitmq" class="sidebar-heading clickable"><span>æŠ€æœ¯æ¡†æ¶</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/Linux/LinuxCommand" class="sidebar-heading clickable"><span>Linux æœåŠ¡å™¨ç›¸å…³</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/æ‚/ä¸€äº›ç½‘ç«™/website" class="sidebar-heading clickable"><span>æ‚</span> <span class="arrow right"></span></a> <!----></section></li></ul> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-59e6cb88 data-v-7dd95ae2><h3 class="title" data-v-59e6cb88></h3> <!----> <label id="box" class="inputBox" data-v-59e6cb88><input type="password" value="" data-v-59e6cb88> <span data-v-59e6cb88>Konck! Knock!</span> <button data-v-59e6cb88>OK</button></label> <div class="footer" data-v-59e6cb88><span data-v-59e6cb88><i class="iconfont reco-theme" data-v-59e6cb88></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-59e6cb88>vuePress-theme-reco</a></span> <span data-v-59e6cb88><i class="iconfont reco-copyright" data-v-59e6cb88></i> <a data-v-59e6cb88><!---->
        Â Â 
        <!---->
        2025
      </a></span></div></div> <div data-v-7dd95ae2><div data-v-7dd95ae2><main class="page"><section style="display:;"><div class="page-title"><h1 class="title"></h1> <div data-v-8a445198><i class="iconfont reco-account" data-v-8a445198><span data-v-8a445198>æ‰¿ç¿</span></i> <i class="iconfont reco-date" data-v-8a445198><span data-v-8a445198>2023/12/14</span></i> <!----> <!----></div></div> <div class="theme-reco-content content__default"><blockquote><p>è½¬è½½ï¼š<a href="https://www.iocoder.cn/Spring-Boot/ActiveMQ/?self" target="_blank" rel="noopener noreferrer">https://www.iocoder.cn/Spring-Boot/ActiveMQ/?self<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <h1 id="_1-æ¦‚è¿°"><a href="#_1-æ¦‚è¿°" class="header-anchor">#</a> 1. æ¦‚è¿°</h1> <p>å¦‚æœèƒ–å‹è¿˜æ²¡äº†è§£è¿‡åˆ†å¸ƒå¼æ¶ˆæ¯é˜Ÿåˆ— <a href="https://activemq.apache.org/" target="_blank" rel="noopener noreferrer">ActiveMQ<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ï¼Œå»ºè®®å…ˆé˜…è¯»ä¸‹è‰¿è‰¿å†™çš„ <a href="http://www.iocoder.cn/ActiveMQ/install/?self" target="_blank" rel="noopener noreferrer">ã€ŠèŠ‹é“ ActiveMQ æç®€å…¥é—¨ã€‹<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> æ–‡ç« ã€‚è™½ç„¶è¿™ç¯‡æ–‡ç« æ ‡é¢˜æ˜¯å®‰è£…éƒ¨ç½²ï¼Œå®é™…å¯ä»¥ç†è§£æˆã€Šä¸€æ–‡å¸¦ä½ å¿«é€Ÿå…¥é—¨ ActiveMQã€‹ï¼Œå“ˆå“ˆå“ˆã€‚</p> <p>è€ƒè™‘è¿™æ˜¯ ActiveMQ å¦‚ä½•åœ¨ Spring Boot æ•´åˆä¸ä½¿ç”¨çš„æ–‡ç« ï¼Œæ‰€ä»¥è¿˜æ˜¯ç®€å•ä»‹ç»ä¸‹ ActiveMQ æ˜¯ä»€ä¹ˆï¼Ÿ</p> <blockquote><p>FROM <a href="https://www.oschina.net/p/activemq" target="_blank" rel="noopener noreferrer">ã€ŠJMS æ¶ˆæ¯æœåŠ¡å™¨ ActiveMQã€‹<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>ActiveMQ æ˜¯ Apache å‡ºå“ï¼Œæœ€æµè¡Œçš„ï¼Œèƒ½åŠ›å¼ºåŠ²çš„å¼€æºæ¶ˆæ¯æ€»çº¿ã€‚</p> <p>ActiveMQ æ˜¯ä¸€ä¸ªå®Œå…¨æ”¯æŒ JMS1.1 å’Œ J2EE1.4 è§„èŒƒçš„ JMS Provider å®ç°ï¼Œå°½ç®¡ JMS è§„èŒƒå‡ºå°å·²ç»æ˜¯å¾ˆä¹…çš„äº‹æƒ…äº†,ä½†æ˜¯ JMS åœ¨å½“ä»Šçš„ J2EE åº”ç”¨ä¸­é—´ä»ç„¶æ‰®æ¼”ç€ç‰¹æ®Šçš„åœ°ä½ã€‚</p> <p>ä¸»è¦ç‰¹ç‚¹ï¼š</p> <ol><li>å¤šç§è¯­è¨€å’Œåè®®ç¼–å†™å®¢æˆ·ç«¯ã€‚è¯­è¨€: Java, C, C++, C#, Ruby, Perl, Python, PHPã€‚åº”ç”¨åè®®: OpenWire,Stomp REST,WS Notification,XMPP,AMQP</li> <li>å®Œå…¨æ”¯æŒJMS1.1 å’Œ J2EE1.4 è§„èŒƒ (æŒä¹…åŒ–,XAæ¶ˆæ¯,äº‹åŠ¡)</li> <li>å¯¹ Spring çš„æ”¯æŒ,ActiveMQ å¯ä»¥å¾ˆå®¹æ˜“å†…åµŒåˆ°ä½¿ç”¨ Spring çš„ç³»ç»Ÿé‡Œé¢å»,è€Œä¸”ä¹Ÿæ”¯æŒ Spring2.0 çš„ç‰¹æ€§</li> <li>é€šè¿‡äº†å¸¸è§ J2EE æœåŠ¡å™¨(å¦‚ Geronimo,JBoss 4, GlassFish,WebLogic)çš„æµ‹è¯•,å…¶ä¸­é€šè¿‡ JCA 1.5 resource adaptors çš„é…ç½®,å¯ä»¥è®©ActiveMQå¯ä»¥è‡ªåŠ¨çš„éƒ¨ç½²åˆ°ä»»ä½•å…¼å®¹J2EE 1.4 å•†ä¸šæœåŠ¡å™¨ä¸Š</li> <li>æ”¯æŒå¤šç§ä¼ é€åè®®:in-VM,TCP,SSL,NIO,UDP,JGroups,JXTA</li> <li>æ”¯æŒé€šè¿‡ JDBC å’Œ journal æä¾›é«˜é€Ÿçš„æ¶ˆæ¯æŒä¹…åŒ–</li> <li>ä»è®¾è®¡ä¸Šä¿è¯äº†é«˜æ€§èƒ½çš„é›†ç¾¤,å®¢æˆ·ç«¯-æœåŠ¡å™¨,ç‚¹å¯¹ç‚¹</li> <li>æ”¯æŒ Ajax</li> <li>æ”¯æŒä¸ Axis çš„æ•´åˆ</li> <li>å¯ä»¥å¾ˆå®¹æ˜“å¾—è°ƒç”¨å†…åµŒ JMS provider,è¿›è¡Œæµ‹è¯•</li></ol></blockquote> <p>åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬ä¼šæ¯” <a href="http://www.iocoder.cn/ActiveMQ/install/?self" target="_blank" rel="noopener noreferrer">ã€ŠèŠ‹é“ ActiveMQ æç®€å…¥é—¨ã€‹<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> æä¾›æ›´å¤šçš„ç”Ÿäº§è€… Producer å’Œæ¶ˆè´¹è€… Consumer çš„ä½¿ç”¨ç¤ºä¾‹ã€‚ä¾‹å¦‚è¯´ï¼š</p> <ul><li>Producer åŒæ­¥ä¸å¼‚æ­¥å‘é€æ¶ˆæ¯çš„æ–¹å¼ã€‚</li> <li>Producer å‘é€<strong>é¡ºåº</strong>æ¶ˆæ¯ï¼ŒConsumer <strong>é¡ºåº</strong>æ¶ˆè´¹æ¶ˆæ¯ã€‚</li> <li>Producer å‘é€<strong>å®šæ—¶</strong>æ¶ˆæ¯ã€‚</li> <li>Producer å‘é€<strong>äº‹åŠ¡</strong>æ¶ˆæ¯ã€‚TODO</li> <li>Consumer <strong>å¹¿æ’­</strong>å’Œ<strong>é›†ç¾¤</strong>æ¶ˆè´¹æ¶ˆæ¯ã€‚</li></ul> <h1 id="_2-spring-jms"><a href="#_2-spring-jms" class="header-anchor">#</a> 2. Spring-JMS</h1> <p>åœ¨ Spring ä½“ç³»ä¸­ï¼Œæä¾›äº† <a href="https://github.com/spring-projects/spring-framework/tree/master/spring-jms" target="_blank" rel="noopener noreferrer">Spring-JMS<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ç»„ä»¶ï¼Œå®ç°å¯¹ <a href="https://mvnrepository.com/artifact/javax.jms/javax.jms-api" target="_blank" rel="noopener noreferrer">JMS<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> è§„èŒƒçš„é›†æˆã€‚æˆ‘ä»¬æ¥çœ‹çœ‹ Spring æ–‡æ¡£å¯¹ Spring JMS çš„æè¿°ï¼š</p> <blockquote><p>FROM <a href="https://docs.spring.io/spring-framework/docs/current/spring-framework-reference/integration.html#jms" target="_blank" rel="noopener noreferrer">ã€ŠSpring æ–‡æ¡£ â€”â€” JMS (Java Message Service)ã€‹<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>Spring provides a JMS integration framework that simplifies the use of the JMS API in much the same way as Springâ€™s integration does for the JDBC API.
Spring æä¾›äº†ä¸€ä¸ª JMS çš„é›†æˆæ¡†æ¶ï¼Œç®€åŒ–äº† JMS API çš„ä½¿ç”¨ï¼Œå°±åƒ Spring å¯¹ JDBC API çš„é›†æˆä¸€æ ·ã€‚</p> <p>JMS can be roughly divided into two areas of functionality, namely the production and consumption of messages.</p> <ul><li>The <a href="https://github.com/spring-projects/spring-framework/blob/master/spring-jms/src/main/java/org/springframework/jms/core/JmsTemplate.java" target="_blank" rel="noopener noreferrer">JmsTemplate<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> class is used for message production and synchronous message reception.</li> <li>For asynchronous reception similar to Java EEâ€™s message-driven bean style, Spring provides a number of message-listener containers that you can use to create Message-Driven POJOs (MDPs). Spring also provides a declarative way to create message listeners.</li></ul> <p>JMS å¯ä»¥å¤§è‡´åˆ†ä¸ºä¸¤å—åŠŸèƒ½ï¼Œå³æ¶ˆæ¯çš„å‘é€å’Œæ¶ˆè´¹ã€‚</p> <ul><li>JmsTemplate ç±»ï¼Œç”¨äºæ¶ˆæ¯çš„å‘é€å’Œæ¶ˆæ¯çš„åŒæ­¥æ¥æ”¶ã€‚</li> <li>å¯¹äºç±»ä¼¼ Java EE çš„æ¶ˆæ¯é©±åŠ¨ Bean å½¢å¼çš„å¼‚æ­¥æ¥æ”¶ï¼ŒSpring æä¾›äº†å¤§é‡ç”¨äºåˆ›å»ºæ¶ˆæ¯é©±åŠ¨ POJOsï¼ˆMDPsï¼‰çš„æ¶ˆæ¯ç›‘å¬å™¨ã€‚Spring è¿˜æä¾›äº†ä¸€ç§åˆ›å»ºæ¶ˆæ¯ä¾¦å¬å™¨çš„<strong>å£°æ˜å¼</strong>æ–¹æ³•ã€‚</li></ul></blockquote> <ul><li>è‹±æ–‡è·Ÿè‰¿è‰¿ä¸€æ ·ä¸å¥½çš„èƒ–å‹ï¼Œå¯ä»¥çœ‹çœ‹<a href="https://my.oschina.net/landas/blog/858784" target="_blank" rel="noopener noreferrer">ã€Šã€è¯‘ã€‘Spring Framework Reference â€”â€” JMS éƒ¨åˆ†ã€‹<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ã€‚</li> <li>å› ä¸º ActiveMQ æä¾›äº†å¯¹ JMS è§„èŒƒçš„æ”¯æŒï¼Œè‡ªç„¶ Spring-JMS å¯ä»¥è®¿é—® ActiveMQ æ¶ˆæ¯é˜Ÿåˆ—ï¼Œæ›´åŠ æ–¹ä¾¿çš„å®ç°æ¶ˆæ¯çš„å‘é€ä¸æ¶ˆè´¹ã€‚</li></ul> <p>åœ¨ <a href="https://spring.io/projects/spring-boot" target="_blank" rel="noopener noreferrer">Spring-Boot<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> é¡¹ç›®ä¸­ï¼Œæä¾›äº† ActiveMQ çš„è‡ªåŠ¨åŒ–é…ç½®ï¼Œæ‰€ä»¥æˆ‘ä»¬ä»…éœ€å¼•å…¥ <a href="https://mvnrepository.com/artifact/org.springframework.boot/spring-boot-starter-activemq" target="_blank" rel="noopener noreferrer"><code>spring-boot-starter-activemq</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ä¾èµ–ï¼Œå³å¯æ„‰å¿«çš„ä½¿ç”¨ã€‚</p> <h1 id="_3-å¿«é€Ÿå…¥é—¨"><a href="#_3-å¿«é€Ÿå…¥é—¨" class="header-anchor">#</a> 3. å¿«é€Ÿå…¥é—¨</h1> <blockquote><p>ç¤ºä¾‹ä»£ç å¯¹åº”ä»“åº“ï¼š<a href="https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo" target="_blank" rel="noopener noreferrer">lab-32-activemq-demo<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ã€‚</p></blockquote> <p>æœ¬å°èŠ‚ï¼Œæˆ‘ä»¬å…ˆæ¥å¯¹ Spring-JMS åšä¸€ä¸ªå¿«é€Ÿå…¥é—¨ï¼Œå®ç° Producer åŒæ­¥ä¸å¼‚æ­¥å‘é€æ¶ˆæ¯åˆ° Queue ä¸­ï¼ŒåŒæ—¶åˆ›å»ºä¸€ä¸ª Consumer æ¶ˆè´¹æ¶ˆæ¯ã€‚</p> <p>è€ƒè™‘åˆ°ä¸€ä¸ªåº”ç”¨æ—¢å¯ä»¥ä½¿ç”¨ç”Ÿäº§è€… Producer ï¼Œåˆå¯ä»¥ä½¿ç”¨æ¶ˆè´¹è€… Consumer ï¼Œæ‰€ä»¥ç¤ºä¾‹å°±åšæˆä¸€ä¸ª <a href="https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo" target="_blank" rel="noopener noreferrer">lab-32-activemq-demo<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> é¡¹ç›®ã€‚</p> <h2 id="_3-1-å¼•å…¥ä¾èµ–"><a href="#_3-1-å¼•å…¥ä¾èµ–" class="header-anchor">#</a> 3.1 å¼•å…¥ä¾èµ–</h2> <p>åœ¨ <a href="https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo/pom.xml" target="_blank" rel="noopener noreferrer"><code>pom.xml</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> æ–‡ä»¶ä¸­ï¼Œå¼•å…¥ç›¸å…³ä¾èµ–ã€‚</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot;
         xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;
    &lt;parent&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;
        &lt;version&gt;2.2.1.RELEASE&lt;/version&gt;
        &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;
    &lt;/parent&gt;
    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;

    &lt;artifactId&gt;lab-32-activemq-demo&lt;/artifactId&gt;

    &lt;dependencies&gt;
        &lt;!-- å®ç°å¯¹ ActiveMQ çš„è‡ªåŠ¨åŒ–é…ç½® --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-activemq&lt;/artifactId&gt;
        &lt;/dependency&gt;

        &lt;!-- æ–¹ä¾¿ç­‰ä¼šå†™å•å…ƒæµ‹è¯• --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;
            &lt;scope&gt;test&lt;/scope&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;

&lt;/project&gt;
</code></pre></div><ul><li>å…·ä½“æ¯ä¸ªä¾èµ–çš„ä½œç”¨ï¼Œèƒ–å‹è‡ªå·±è®¤çœŸçœ‹ä¸‹è‰¿è‰¿æ·»åŠ çš„æ‰€æœ‰æ³¨é‡Šå™¢ã€‚</li></ul> <h2 id="_3-2-åº”ç”¨é…ç½®æ–‡ä»¶"><a href="#_3-2-åº”ç”¨é…ç½®æ–‡ä»¶" class="header-anchor">#</a> 3.2 åº”ç”¨é…ç½®æ–‡ä»¶</h2> <p>åœ¨ <a href="https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo/src/main/resources" target="_blank" rel="noopener noreferrer"><code>resources</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ç›®å½•ä¸‹ï¼Œåˆ›å»º <a href="https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo/src/main/resources/application.yaml" target="_blank" rel="noopener noreferrer"><code>application.yaml</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> é…ç½®æ–‡ä»¶ã€‚é…ç½®å¦‚ä¸‹ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>spring:
  # ActiveMQ é…ç½®é¡¹ï¼Œå¯¹åº” ActiveMQProperties é…ç½®ç±»
  activemq:
    broker-url: tcp://127.0.0.1:61616 # Activemq Broker çš„åœ°å€
    user: admin # è´¦å·
    password: admin # å¯†ç 
    packages:
      trust-all: true # å¯ä¿¡ä»»çš„ååºåˆ—åŒ–åŒ…
</code></pre></div><ul><li>åœ¨ <code>spring.activemq</code> é…ç½®é¡¹ï¼Œè®¾ç½® Kafka çš„é…ç½®ï¼Œå¯¹åº” <a href="https://github.com/spring-projects/spring-boot/blob/master/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/jms/activemq/ActiveMQProperties.java" target="_blank" rel="noopener noreferrer">ActiveMQProperties<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> é…ç½®ç±»ã€‚</li> <li>Spring Boot æä¾›çš„ <a href="https://github.com/spring-projects/spring-boot/blob/master/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/jms/activemq/ActiveMQAutoConfiguration.java" target="_blank" rel="noopener noreferrer">ActiveMQAutoConfiguration<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> è‡ªåŠ¨åŒ–é…ç½®ç±»ï¼Œå®ç° ActiveMQ çš„è‡ªåŠ¨é…ç½®ï¼Œåˆ›å»ºç›¸åº”çš„ Producer å’Œ Consumer ã€‚</li> <li><code>spring.activemq.packages.trust-all</code> é…ç½®é¡¹ï¼Œé…ç½®å¯ä¿¡èµ–æ‰€æœ‰çš„ <code>package</code> åŒ…ã€‚å› ä¸º ActiveMQ åœ¨ååºåˆ—åŒ– POJO çš„æ¶ˆæ¯æ—¶ï¼Œè€ƒè™‘åˆ°å®‰å…¨æ€§ï¼Œå¦‚æœéå¯ä¿¡èµ–çš„ Java ç±»ï¼Œä¼šæŠ›å‡º <code>&quot;This class is not trusted to be serialized&quot;</code> çš„å¼‚å¸¸ã€‚ğŸ˜ˆ æƒ³è¦å°è¯•ä¸‹æ•ˆæœçš„èƒ–å‹ï¼Œå¯ä»¥é€‰æ‹©å»æ‰è¿™ä¸ªé…ç½®ï¼Œå¾ˆé…¸çˆ½ã€‚</li></ul> <h2 id="_3-3-application"><a href="#_3-3-application" class="header-anchor">#</a> 3.3 Application</h2> <p>åˆ›å»º <a href="https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/Application.java" target="_blank" rel="noopener noreferrer"><code>Application.java</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ç±»ï¼Œé…ç½® <code>@SpringBootApplication</code> æ³¨è§£å³å¯ã€‚ä»£ç å¦‚ä¸‹ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>// Application.java

@SpringBootApplication
@EnableAsync // å¼€å¯å¼‚æ­¥
public class Application {

    public static void main(String[] args) {
        SpringApplication.run(Application.class, args);
    }

}
</code></pre></div><ul><li>æˆ‘ä»¬é¢å¤–æ·»åŠ äº† <code>@EnableAsync</code> æ³¨è§£ï¼Œå› ä¸ºæˆ‘ä»¬ç¨åè¦ä½¿ç”¨ Spring æä¾›çš„å¼‚æ­¥è°ƒç”¨çš„åŠŸèƒ½ã€‚ä¸äº†è§£è¿™å—çš„èƒ–å‹ï¼Œå¯ä»¥çœ‹çœ‹è‰¿è‰¿å†™çš„ <a href="http://www.iocoder.cn/Spring-Boot/Async-Job/?self" target="_blank" rel="noopener noreferrer">ã€ŠèŠ‹é“ Spring Boot å¼‚æ­¥ä»»åŠ¡å…¥é—¨ã€‹<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> æ–‡ç« ã€‚</li></ul> <h2 id="_3-4-demo01message"><a href="#_3-4-demo01message" class="header-anchor">#</a> 3.4 Demo01Message</h2> <p>åœ¨ <a href="https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/message" target="_blank" rel="noopener noreferrer"><code>cn.iocoder.springboot.lab32.activemqdemo.message</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> åŒ…ä¸‹ï¼Œåˆ›å»º <a href="https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/message/Demo01Message.java" target="_blank" rel="noopener noreferrer">Demo01Message<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> æ¶ˆæ¯ç±»ï¼Œæä¾›ç»™å½“å‰ç¤ºä¾‹ä½¿ç”¨ã€‚ä»£ç å¦‚ä¸‹ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>// Demo01Message.java

public class Demo01Message implements Serializable {

    public static final String QUEUE = &quot;QUEUE_DEMO_01&quot;;

    /**
     * ç¼–å·
     */
    private Integer id;

    // ... çœç•¥ set/get/toString æ–¹æ³•

}
</code></pre></div><ul><li>æ³¨æ„ï¼Œè¦å®ç° Java Serializable åºåˆ—åŒ–æ¥å£ã€‚å› ä¸º JMS è§„èŒƒè¦æ±‚ POJO æ¶ˆæ¯ç±»ï¼Œéœ€è¦å®ç° Serializable æ¥å£ã€‚</li> <li>åœ¨æ¶ˆæ¯ç±»é‡Œï¼Œæˆ‘ä»¬æšä¸¾äº† Queue çš„åå­—ã€‚</li></ul> <p>æˆ‘ä»¬æ— éœ€ä¸­å» ActiveMQ æˆ–è€… Spring-JMS <strong>ä¸»åŠ¨</strong>å£°æ˜è¿™ä¸ª ActiveMQ Queue ã€‚å› ä¸º Consumer è®¢é˜…è¯¥ Queue æ—¶ï¼Œä¼š<strong>è‡ªåŠ¨</strong>è¿›è¡Œåˆ›å»ºã€‚åˆæˆ–è€… Producer åœ¨å‘é€æ¶ˆæ¯åˆ° Queue ä¸­æ—¶ï¼Œä¹Ÿä¼š<strong>è‡ªåŠ¨</strong>è¿›è¡Œåˆ›å»ºã€‚</p> <h2 id="_3-5-demo01producer"><a href="#_3-5-demo01producer" class="header-anchor">#</a> 3.5 Demo01Producer</h2> <p>åœ¨ <a href="https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/producer" target="_blank" rel="noopener noreferrer"><code>cn.iocoder.springboot.lab32.activemqdemo.producer</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> åŒ…ä¸‹ï¼Œåˆ›å»º <a href="https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/producer/Demo01Producer.java" target="_blank" rel="noopener noreferrer">Demo01Producer<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ç±»ï¼Œå®ƒä¼šä½¿ç”¨ Spring-JMS å°è£…æä¾›çš„ JmsMessagingTemplate ï¼Œå®ç°å‘é€æ¶ˆæ¯ã€‚ä»£ç å¦‚ä¸‹ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>// Demo01Producer.java

@Component
public class Demo01Producer {

    @Autowired
    private JmsMessagingTemplate jmsTemplate;

    public void syncSend(Integer id) {
        // åˆ›å»º Demo01Message æ¶ˆæ¯
        Demo01Message message = new Demo01Message();
        message.setId(id);
        // åŒæ­¥å‘é€æ¶ˆæ¯
        jmsTemplate.convertAndSend(Demo01Message.QUEUE, message);
    }

    @Async
    public ListenableFuture&lt;Void&gt; asyncSend(Integer id) {
        try {
            // å‘é€æ¶ˆæ¯
            this.syncSend(id);
            // è¿”å›æˆåŠŸçš„ Future
            return AsyncResult.forValue(null);
        } catch (Throwable ex) {
            // è¿”å›å¼‚å¸¸çš„ Future
            return AsyncResult.forExecutionException(ex);
        }
    }

}
</code></pre></div><ul><li><div class="language- extra-class"><pre class="language-text"><code>jmsTemplate
</code></pre></div><p>å±æ€§ï¼Œæ˜¯</p> <p>JmsMessagingTemplate</p> <p>å¯¹è±¡ï¼Œè€Œä¸æ˜¯</p> <p>JmsTemplate</p> <p>ã€‚</p> <ul><li>JmsTemplate æ˜¯ JMS API çš„å°è£…ï¼Œç®€åŒ–æ¶ˆæ¯çš„å‘é€ä¸æ¥æ”¶ã€‚</li> <li>JmsMessagingTemplate æ˜¯å°† JmsTemplate é›†æˆåˆ° <a href="https://github.com/spring-projects/spring-framework/tree/master/spring-messaging/src/main/java/org/springframework/messaging" target="_blank" rel="noopener noreferrer">Spring-Messaging<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ä½“ç³»ä¸­ï¼Œå…¶å†…éƒ¨è°ƒç”¨çš„è¿˜æ˜¯ JmsTemplate çš„æ–¹æ³•ã€‚</li></ul></li> <li><p><code>#syncSend(Integer id)</code> æ–¹æ³•ï¼Œè°ƒç”¨ JmsMessagingTemplate çš„åŒæ­¥å‘é€æ¶ˆæ¯æ–¹æ³•ã€‚</p></li> <li><p><code>#asyncSend(Integer id)</code> æ–¹æ³•ï¼Œé€šè¿‡ <code>@Async</code> æ³¨è§£ï¼Œå£°æ˜å¼‚æ­¥è°ƒç”¨è¯¥æ–¹æ³•ï¼Œä»è€Œå®ç°å¼‚æ­¥æ¶ˆæ¯åˆ° ActiveMQ ä¸­ã€‚å› ä¸º JmsMessagingTemplate å¹¶æœªåƒ <a href="https://github.com/spring-projects/spring-kafka/blob/master/spring-kafka/src/main/java/org/springframework/kafka/core/KafkaTemplate.java" target="_blank" rel="noopener noreferrer">KafkaTemplate<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> æˆ– <a href="https://github.com/apache/rocketmq-spring/blob/master/rocketmq-spring-boot/src/main/java/org/apache/rocketmq/spring/core/RocketMQTemplate.java" target="_blank" rel="noopener noreferrer">RocketMQTemplate<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ç›´æ¥æä¾›äº†å¼‚æ­¥å‘é€æ¶ˆæ¯çš„æ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ç»“åˆ Spring å¼‚æ­¥è°ƒç”¨æ¥å®ç°ã€‚</p></li></ul> <h2 id="_3-6-demo01consumer"><a href="#_3-6-demo01consumer" class="header-anchor">#</a> 3.6 Demo01Consumer</h2> <p>åœ¨ <a href="https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/consumer" target="_blank" rel="noopener noreferrer"><code>cn.iocoder.springboot.lab32.activemqdemo.consumer</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> åŒ…ä¸‹ï¼Œåˆ›å»º <a href="https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/consumer/Demo01Consumer.java" target="_blank" rel="noopener noreferrer">Demo01Consumer<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ç±»ï¼Œæ¶ˆè´¹æ¶ˆæ¯ã€‚ä»£ç å¦‚ä¸‹ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>// Demo01Consumer.java

@Component
public class Demo01Consumer {

    private Logger logger = LoggerFactory.getLogger(getClass());

    @JmsListener(destination = Demo01Message.QUEUE)
    public void onMessage(Demo01Message message) {
        logger.info(&quot;[onMessage][çº¿ç¨‹ç¼–å·:{} æ¶ˆæ¯å†…å®¹ï¼š{}]&quot;, Thread.currentThread().getId(), message);
    }

//    @JmsListener(destination = Demo01Message.QUEUE)
//    public void onMessage(javax.jms.Message message) {
//        logger.info(&quot;[onMessage][çº¿ç¨‹ç¼–å·:{} æ¶ˆæ¯å†…å®¹ï¼š{}]&quot;, Thread.currentThread().getId(), message);
//    }

}
</code></pre></div><ul><li>åœ¨ç±»ä¸Šï¼Œæ·»åŠ äº† <code>@Component</code> æ³¨è§£ï¼Œä¿è¯å…¶èƒ½è¢« Spring ä½œä¸ºä¸€ä¸ª Bean æ‰«æåˆ°ã€‚</li> <li>åœ¨æ–¹æ³•ä¸Šï¼Œæ·»åŠ äº† <a href="https://github.com/spring-projects/spring-framework/blob/master/spring-jms/src/main/java/org/springframework/jms/annotation/JmsListener.java" target="_blank" rel="noopener noreferrer"><code>@JmsListener</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> æ³¨è§£ï¼Œç”³æ˜äº†å¤„ç†æ¶ˆæ¯çš„æ–¹æ³•ã€‚åŒæ—¶ï¼Œæ–¹æ³•å…¥å‚ä¸ºæ¶ˆæ¯çš„ç±»å‹ã€‚è¿™é‡Œï¼Œæˆ‘ä»¬è®¾ç½®äº†<a href="https://www.iocoder.cn/Spring-Boot/ActiveMQ/?self#" target="_blank" rel="noopener noreferrer">ã€Œ3.4 Demo01Messageã€<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ã€‚</li> <li>å¦‚æœæˆ‘ä»¬æƒ³è¦è·å¾—æ¶ˆè´¹æ¶ˆæ¯çš„æ›´å¤šä¿¡æ¯ï¼Œä¾‹å¦‚è¯´ï¼Œæ¶ˆæ¯ç¼–å·ã€åˆ›å»ºæ—¶é—´ç­‰ç­‰ä¿¡æ¯ï¼Œåˆ™å¯ä»¥è€ƒè™‘ä½¿ç”¨è‰¿è‰¿<strong>æ³¨é‡Šæ‰çš„é‚£æ®µä»£ç </strong>ï¼Œé€šè¿‡æ–¹æ³•å…¥å‚ä¸º <a href="https://github.com/javaee/javax.jms/blob/master/src/main/java/javax/jms/Message.java" target="_blank" rel="noopener noreferrer"><code>javax.jms.Messagee</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ç±»å‹ã€‚ä¸è¿‡ç»å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¹¶ä¸éœ€è¦è¿™ä¹ˆåšã€‚</li></ul> <h2 id="_3-7-ç®€å•æµ‹è¯•"><a href="#_3-7-ç®€å•æµ‹è¯•" class="header-anchor">#</a> 3.7 ç®€å•æµ‹è¯•</h2> <p>åˆ›å»º <a href="https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo/src/test/java/cn/iocoder/springboot/lab32/activemqdemo/producer/Demo01ProducerTest.java" target="_blank" rel="noopener noreferrer">Demo01ProducerTest<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> æµ‹è¯•ç±»ï¼Œç¼–å†™å•å…ƒæµ‹è¯•æ–¹æ³•ï¼Œè°ƒç”¨ Demo01Producer ä¸¤ä¸ªå‘é€æ¶ˆæ¯çš„æ–¹å¼ã€‚ä»£ç å¦‚ä¸‹ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>// Demo01ProducerTest.java

@RunWith(SpringRunner.class)
@SpringBootTest(classes = Application.class)
public class Demo01ProducerTest {

    private Logger logger = LoggerFactory.getLogger(getClass());

    @Autowired
    private Demo01Producer producer;

    @Test
    public void testSyncSend() throws InterruptedException {
        // å‘é€æ¶ˆæ¯
        int id = (int) (System.currentTimeMillis() / 1000);
        producer.syncSend(id);
        logger.info(&quot;[testSyncSend][å‘é€ç¼–å·ï¼š[{}] å‘é€æˆåŠŸ]&quot;, id);

        // é˜»å¡ç­‰å¾…ï¼Œä¿è¯æ¶ˆè´¹
        new CountDownLatch(1).await();
    }

    @Test
    public void testAsyncSend() throws InterruptedException {
        int id = (int) (System.currentTimeMillis() / 1000);
        producer.asyncSend(id).addCallback(new ListenableFutureCallback&lt;Void&gt;() {

            @Override
            public void onFailure(Throwable e) {
                logger.info(&quot;[testASyncSend][å‘é€ç¼–å·ï¼š[{}] å‘é€å¼‚å¸¸]]&quot;, id, e);
            }

            @Override
            public void onSuccess(Void aVoid) {
                logger.info(&quot;[testASyncSend][å‘é€ç¼–å·ï¼š[{}] å‘é€æˆåŠŸï¼Œå‘é€æˆåŠŸ]&quot;, id);
            }

        });
        logger.info(&quot;[testASyncSend][å‘é€ç¼–å·ï¼š[{}] è°ƒç”¨å®Œæˆ]&quot;, id);

        // é˜»å¡ç­‰å¾…ï¼Œä¿è¯æ¶ˆè´¹
        new CountDownLatch(1).await();
    }

}
</code></pre></div><ul><li>æ¯”è¾ƒç®€å•ï¼Œèƒ–å‹è‡ªå·±çœ‹ä¸‹ä¸¤ä¸ªå•å…ƒæµ‹è¯•æ–¹æ³•ã€‚</li></ul> <p>æˆ‘ä»¬æ¥æ‰§è¡Œ <code>#testSyncSend()</code> æ–¹æ³•ï¼Œæµ‹è¯•åŒæ­¥å‘é€æ¶ˆæ¯ã€‚æ§åˆ¶å°è¾“å‡ºå¦‚ä¸‹ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code># Producer åŒæ­¥å‘é€æ¶ˆæ¯æˆåŠŸã€‚
2019-12-15 00:19:18.736  INFO 87164 --- [           main] c.i.s.l.r.producer.Demo01ProducerTest    : [testSyncSend][å‘é€ç¼–å·ï¼š[1575908358] å‘é€æˆåŠŸ]

# Demo01Consumer æˆåŠŸæ¶ˆè´¹äº†è¯¥æ¶ˆæ¯
2019-12-15 00:19:18.751  INFO 87164 --- [ntContainer#0-1] c.i.s.l.r.consumer.Demo01Consumer        : [onMessage][çº¿ç¨‹ç¼–å·:17 æ¶ˆæ¯å†…å®¹ï¼šDemo01Message{id=1575908358}]
</code></pre></div><ul><li>åŒæ­¥å‘é€çš„æ¶ˆæ¯ï¼ŒæˆåŠŸè¢«æ¶ˆè´¹ã€‚</li></ul> <p>æˆ‘ä»¬å†æ¥æ‰§è¡Œ <code>#tesSyncSendDefault()</code> æ–¹æ³•ï¼Œæµ‹è¯•å¦ä¸€ä¸ªåŒæ­¥å‘é€æ¶ˆæ¯ã€‚æ§åˆ¶å°è¾“å‡ºå¦‚ä¸‹ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code># Producer åŒæ­¥å‘é€æ¶ˆæ¯æˆåŠŸã€‚
2019-12-15 11:50:38.857  INFO 74430 --- [           main] c.i.s.l.a.producer.Demo01ProducerTest    : [testSyncSend][å‘é€ç¼–å·ï¼š[1576381838] å‘é€æˆåŠŸ]

# Demo01Consumer æˆåŠŸæ¶ˆè´¹äº†è¯¥æ¶ˆæ¯
2019-12-15 11:50:38.860  INFO 74430 --- [enerContainer-1] c.i.s.l.a.consumer.Demo01Consumer        : [onMessage][çº¿ç¨‹ç¼–å·:18 æ¶ˆæ¯å†…å®¹ï¼šDemo01Message{id=1576381838}]
</code></pre></div><ul><li>åŒæ­¥å‘é€çš„æ¶ˆæ¯ï¼ŒæˆåŠŸä¹Ÿè¢«æ¶ˆè´¹ã€‚</li></ul> <p>æˆ‘ä»¬æœ€åæ¥æ‰§è¡Œ <code>#testAsyncSend()</code> æ–¹æ³•ï¼Œæµ‹è¯•å¼‚æ­¥å‘é€æ¶ˆæ¯ã€‚æ§åˆ¶å°è¾“å‡ºå¦‚ä¸‹ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code># Producer å¼‚æ­¥å‘é€æ¶ˆæ¯çš„è°ƒç”¨å®Œæˆã€‚
2019-12-15 11:52:43.156  INFO 74582 --- [           main] c.i.s.l.a.producer.Demo01ProducerTest    : [testASyncSend][å‘é€ç¼–å·ï¼š[1576381963] è°ƒç”¨å®Œæˆ]

# Producer å¼‚æ­¥å‘é€æ¶ˆæ¯æˆåŠŸã€‚ã€å›è°ƒã€‘
2019-12-15 11:52:43.214  INFO 74582 --- [         task-1] c.i.s.l.a.producer.Demo01ProducerTest    : [testASyncSend][å‘é€ç¼–å·ï¼š[1576381963] å‘é€æˆåŠŸï¼Œå‘é€æˆåŠŸ]

# Demo01Consumer æˆåŠŸæ¶ˆè´¹äº†è¯¥æ¶ˆæ¯
2019-12-15 11:52:43.218  INFO 74582 --- [enerContainer-1] c.i.s.l.a.consumer.Demo01Consumer        : [onMessage][çº¿ç¨‹ç¼–å·:18 æ¶ˆæ¯å†…å®¹ï¼šDemo01Message{id=1576381963}]
</code></pre></div><ul><li>å¼‚æ­¥å‘é€çš„æ¶ˆæ¯ï¼ŒæˆåŠŸä¹Ÿè¢«æ¶ˆè´¹ã€‚</li></ul> <h1 id="_4-æ¶ˆæ¯æ¨¡å¼"><a href="#_4-æ¶ˆæ¯æ¨¡å¼" class="header-anchor">#</a> 4. æ¶ˆæ¯æ¨¡å¼</h1> <blockquote><p>ç¤ºä¾‹ä»£ç å¯¹åº”ä»“åº“ï¼š<a href="https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo-message-model" target="_blank" rel="noopener noreferrer">lab-32-activemq-demo-message-model<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <p>åœ¨ JMS è§„èŒƒä¸­ï¼Œå®šä¹‰äº†ä¸¤ç§æ¶ˆæ¯æ¨¡å¼ï¼š</p> <ul><li>ç‚¹å¯¹ç‚¹ï¼ˆpoint to pointï¼‰ï¼šåŸºäº Queue é˜Ÿåˆ—çš„æ–¹å¼ã€‚</li> <li>å‘å¸ƒ/è®¢é˜…ï¼ˆpublish/subscribeï¼‰ï¼šåŸºäº Topic ä¸»é¢˜çš„æ–¹å¼ã€‚</li></ul> <p>å…·ä½“çš„æ¦‚å¿µï¼Œè‰¿è‰¿å°±å…ˆä¸è§£é‡Šï¼Œèƒ–å‹å¯ä»¥çœ‹çœ‹<a href="http://www.iocoder.cn/Fight/There-are-two-modes-of-message-queuing-point-to-point-and-publish-subscription/?self" target="_blank" rel="noopener noreferrer">ã€Šæ¶ˆæ¯é˜Ÿåˆ—ä¸¤ç§æ¨¡å¼ï¼šç‚¹å¯¹ç‚¹ä¸å‘å¸ƒè®¢é˜…ã€‹<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>æ–‡ç« ã€‚ğŸ™‚ å®é™…ä¸Šï¼Œæˆ‘ä»¬åœ¨<a href="https://www.iocoder.cn/Spring-Boot/ActiveMQ/?self#" target="_blank" rel="noopener noreferrer">ã€Œ3. å¿«é€Ÿå…¥é—¨ã€<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ä¸­ï¼Œå°±é‡‡ç”¨çš„æ˜¯ç‚¹å¯¹ç‚¹çš„æ¶ˆæ¯æ¨¡å¼ã€‚</p> <p>å¦‚æœèƒ–å‹æœ‰ä½¿ç”¨è¿‡ RocketMQ æˆ–è€… Kafka æ¶ˆæ¯é˜Ÿåˆ—ï¼Œå¯èƒ½æ¯”è¾ƒä¹ æƒ¯çš„å«æ³•æ˜¯ï¼š</p> <blockquote><p><strong>é›†ç¾¤æ¶ˆè´¹ï¼ˆClusteringï¼‰</strong>ï¼šå¯¹åº”ã€Œç‚¹å¯¹ç‚¹ã€ é›†ç¾¤æ¶ˆè´¹æ¨¡å¼ä¸‹ï¼Œç›¸åŒ Consumer Group çš„æ¯ä¸ª Consumer å®ä¾‹å¹³å‡åˆ†æ‘Šæ¶ˆæ¯ã€‚</p> <p><strong>å¹¿æ’­æ¶ˆè´¹ï¼ˆBroadcastingï¼‰</strong>ï¼šå¯¹åº”ã€Œå‘å¸ƒè®¢é˜…ã€ å¹¿æ’­æ¶ˆè´¹æ¨¡å¼ä¸‹ï¼Œç›¸åŒ Consumer Group çš„æ¯ä¸ª Consumer å®ä¾‹éƒ½æ¥æ”¶å…¨é‡çš„æ¶ˆæ¯ã€‚</p></blockquote> <p>ğŸ˜ˆ è€ƒè™‘åˆ°è‰¿è‰¿è‡ªå·±çš„ä¹ æƒ¯ï¼Œä¸‹æ–‡æˆ‘ä»¬ç»Ÿä¸€é‡‡ç”¨é›†ç¾¤æ¶ˆè´¹å’Œå¹¿æ’­æ¶ˆè´¹å«æ³•ã€‚</p> <p>ä¸‹é¢ï¼Œæˆ‘ä»¬åˆ†åˆ«åœ¨<a href="https://www.iocoder.cn/Spring-Boot/ActiveMQ/?self#" target="_blank" rel="noopener noreferrer">ã€Œ4.1 é›†ç¾¤æ¶ˆè´¹ã€<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>å’Œ<a href="https://www.iocoder.cn/Spring-Boot/ActiveMQ/?self#" target="_blank" rel="noopener noreferrer">ã€Œ4.2 å¹¿æ’­æ¶ˆè´¹ã€<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>çš„ç¤ºä¾‹ä»£ç ã€‚ä¸¤ä¸ªç¤ºä¾‹ï¼Œæˆ‘ä»¬éƒ½ä¼šæ”¾åœ¨ä¸€ä¸ª <a href="https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo-message-model" target="_blank" rel="noopener noreferrer">lab-32-activemq-demo-message-model<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> é¡¹ç›®ã€‚</p> <h2 id="_4-1-é›†ç¾¤æ¶ˆè´¹"><a href="#_4-1-é›†ç¾¤æ¶ˆè´¹" class="header-anchor">#</a> 4.1 é›†ç¾¤æ¶ˆè´¹</h2> <p>åœ¨ ActiveMQ ä¸­ï¼Œå¦‚æœå¤šä¸ª Consumer è®¢é˜…ç›¸åŒçš„ Queue ï¼Œé‚£ä¹ˆæ¯ä¸€æ¡æ¶ˆæ¯æœ‰ä¸”ä»…ä¼šè¢«ä¸€ä¸ª Consumer æ‰€æ¶ˆè´¹ã€‚è¿™ä¸ªç‰¹æ€§ï¼Œå°±ä¸ºæˆ‘ä»¬å®ç°é›†ç¾¤æ¶ˆè´¹æä¾›äº†åŸºç¡€ã€‚</p> <p>åœ¨æœ¬ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬ä¼šæŠŠä¸€ä¸ª Queue ä½œä¸ºä¸€ä¸ª Consumer Group ï¼ŒåŒæ—¶åˆ›å»ºæ¶ˆè´¹è¯¥ Queue çš„ Consumer ã€‚è¿™æ ·ï¼Œåœ¨æˆ‘ä»¬å¯åŠ¨å¤šä¸ª JVM è¿›ç¨‹æ—¶ï¼Œå°±ä¼šæœ‰å¤šä¸ª Consumer æ¶ˆè´¹è¯¥ Queue ï¼Œä»è€Œå®ç°é›†ç¾¤æ¶ˆè´¹çš„æ•ˆæœã€‚</p> <p>ä¸‹é¢ï¼Œè®©æˆ‘ä»¬å¼€å§‹é›†ç¾¤æ¶ˆè´¹çš„ç¤ºä¾‹ã€‚</p> <h3 id="_4-1-1-å¼•å…¥ä¾èµ–"><a href="#_4-1-1-å¼•å…¥ä¾èµ–" class="header-anchor">#</a> 4.1.1 å¼•å…¥ä¾èµ–</h3> <p>å’Œ <a href="https://www.iocoder.cn/Spring-Boot/ActiveMQ/?self#" target="_blank" rel="noopener noreferrer">ã€Œ3.1 å¼•å…¥ä¾èµ–ã€<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ä¸€è‡´ï¼Œè§ <a href="https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo-message-model/pom.xml" target="_blank" rel="noopener noreferrer"><code>pom.xml</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> æ–‡ä»¶ã€‚</p> <h3 id="_4-1-2-åº”ç”¨é…ç½®æ–‡ä»¶"><a href="#_4-1-2-åº”ç”¨é…ç½®æ–‡ä»¶" class="header-anchor">#</a> 4.1.2 åº”ç”¨é…ç½®æ–‡ä»¶</h3> <p>å’Œ <a href="https://www.iocoder.cn/Spring-Boot/ActiveMQ/?self#" target="_blank" rel="noopener noreferrer">ã€Œ3.2 åº”ç”¨é…ç½®æ–‡ä»¶ã€<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ä¸€è‡´ï¼Œè§ <a href="https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo-message-model/src/main/resources/application.yaml" target="_blank" rel="noopener noreferrer"><code>application.yaml</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> æ–‡ä»¶ã€‚</p> <h3 id="_4-1-3-clusteringmessage"><a href="#_4-1-3-clusteringmessage" class="header-anchor">#</a> 4.1.3 ClusteringMessage</h3> <p>åœ¨ <a href="https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo-message-model/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/message/" target="_blank" rel="noopener noreferrer"><code>cn.iocoder.springboot.lab32.activemqdemo.message</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> åŒ…ä¸‹ï¼Œåˆ›å»º <a href="https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo-message-model/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/message/ClusteringMessage.java" target="_blank" rel="noopener noreferrer">ClusteringMessage<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> æ¶ˆæ¯ç±»ï¼Œæä¾›ç»™å½“å‰ç¤ºä¾‹ä½¿ç”¨ã€‚ä»£ç å¦‚ä¸‹ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>// ClusteringMessage.java

public class ClusteringMessage implements Serializable {

    public static final String QUEUE = &quot;QUEUE_CLUSTERING&quot;;

    /**
     * ç¼–å·
     */
    private Integer id;

    // ... çœç•¥ set/get/toString æ–¹æ³•

}
</code></pre></div><ul><li>åœ¨æ¶ˆæ¯ç±»é‡Œï¼Œæˆ‘ä»¬æšä¸¾äº† Queue çš„åå­—ã€‚</li></ul> <h3 id="_4-1-4-activemqconfig"><a href="#_4-1-4-activemqconfig" class="header-anchor">#</a> 4.1.4 ActiveMQConfig</h3> <p>åœ¨ <a href="https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo-message-model/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/config" target="_blank" rel="noopener noreferrer"><code>cn.iocoder.springboot.lab32.activemqdemo.config</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> åŒ…ä¸‹ï¼Œåˆ›å»º <a href="https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo-message-model/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/config/ActiveMQConfig.java" target="_blank" rel="noopener noreferrer">ActiveMQConfig<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> é…ç½®ç±»ï¼Œæ·»åŠ é›†ç¾¤æ¶ˆè´¹éœ€è¦çš„é…ç½®ã€‚ä»£ç å¦‚ä¸‹ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>// ActiveMQConfig.java

public static final String CLUSTERING_JMS_LISTENER_CONTAINER_FACTORY_BEAN_NAME = &quot;clusteringJmsListenerContainerFactory&quot;;

public static final String CLUSTERING_JMS_TEMPLATE_BEAN_NAME = &quot;clusteringJmsTemplate&quot;;

@Bean(CLUSTERING_JMS_LISTENER_CONTAINER_FACTORY_BEAN_NAME)
public DefaultJmsListenerContainerFactory clusteringJmsListenerContainerFactory(
        DefaultJmsListenerContainerFactoryConfigurer configurer, ConnectionFactory connectionFactory) {
    DefaultJmsListenerContainerFactory factory = new DefaultJmsListenerContainerFactory();
    configurer.configure(factory, connectionFactory);
    factory.setPubSubDomain(false);
    return factory;
}

@Bean(CLUSTERING_JMS_TEMPLATE_BEAN_NAME)
public JmsMessagingTemplate clusteringJmsTemplate(ConnectionFactory connectionFactory) {
    // åˆ›å»º JmsTemplate å¯¹è±¡
    JmsTemplate template = new JmsTemplate(connectionFactory);
    template.setPubSubDomain(false);
    // åˆ›å»º JmsMessageTemplate
    return new JmsMessagingTemplate(template);
}
</code></pre></div><ul><li><p>é€šè¿‡</p> <div class="language- extra-class"><pre class="language-text"><code>spring.jms.pub-sub-domain
</code></pre></div><p>é…ç½®é¡¹ï¼Œæ§åˆ¶åˆ›å»ºçš„ JmsTemplate å’Œ DefaultJmsListenerContainerFactory Bean æ˜¯é’ˆå¯¹</p> <div class="language- extra-class"><pre class="language-text"><code>true
</code></pre></div><p>å¹¿æ’­æ¶ˆè´¹ï¼Œè¿˜æ˜¯</p> <div class="language- extra-class"><pre class="language-text"><code>false
</code></pre></div><p>é›†ç¾¤æ¶ˆè´¹ã€‚</p> <ul><li>å› ä¸ºåœ¨æœ¬å°èŠ‚çš„ç¤ºä¾‹é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬æ—¢è¦æ”¯æŒé›†ç¾¤æ¶ˆè´¹ï¼Œåˆè¦æ”¯æŒå¹¿æ’­æ¶ˆè´¹ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦<strong>æ‰‹åŠ¨</strong>åˆ›å»ºä¸¤å¥— JmsTemplate å’Œ DefaultJmsListenerContainerFactory Bean ï¼Œåˆ†åˆ«ç»™<a href="https://www.iocoder.cn/Spring-Boot/ActiveMQ/?self#" target="_blank" rel="noopener noreferrer">ã€Œ4.1 é›†ç¾¤æ¶ˆè´¹ã€<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>å’Œ<a href="https://www.iocoder.cn/Spring-Boot/ActiveMQ/?self#" target="_blank" rel="noopener noreferrer">ã€Œ4.2 å¹¿æ’­æ¶ˆè´¹ã€<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ä½¿ç”¨ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å…ˆç»™é›†ç¾¤æ¶ˆè´¹åˆ›å»ºäº†ä¸€å¥— JmsTemplate å’Œ DefaultJmsListenerContainerFactory ã€‚</li> <li>å¦‚æœèƒ–å‹çš„é¡¹ç›®ä¸­ï¼Œåªéœ€è¦æŒé›†ç¾¤æ¶ˆè´¹æˆ–å¹¿æ’­æ¶ˆè´¹çš„å…¶ä¸­ä¸€ç§ï¼Œä»…ä»…éœ€è¦ <code>spring.jms.pub-sub-domain</code> é…ç½®é¡¹å³å¯ï¼Œæ— éœ€<strong>æ‰‹åŠ¨</strong>ä¸€å¥— JmsTemplate å’Œ DefaultJmsListenerContainerFactory Bean ã€‚</li></ul></li> <li><p>å¦å¤–ï¼Œå› ä¸ºæˆ‘ä»¬åœ¨ Producer ä¸­ï¼Œä½¿ç”¨çš„æ˜¯ JmsMessagingTemplate æ¥å‘é€æ¶ˆæ¯ï¼Œæ‰€ä»¥è¿™é‡Œæœ€ç»ˆåˆ›å»ºçš„æ˜¯ JmsMessagingTemplate Bean ã€‚</p></li></ul> <h3 id="_4-1-5-clusteringproducer"><a href="#_4-1-5-clusteringproducer" class="header-anchor">#</a> 4.1.5 ClusteringProducer</h3> <p>åœ¨ <a href="https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo-message-model/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/producer" target="_blank" rel="noopener noreferrer"><code>cn.iocoder.springboot.lab32.activemqdemo.producer</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> åŒ…ä¸‹ï¼Œåˆ›å»º <a href="https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo-message-model/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/producer/ClusteringProducer.java" target="_blank" rel="noopener noreferrer">ClusteringProducer<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ç±»ï¼Œå®ƒä¼šä½¿ç”¨ Spring-JMS å°è£…æä¾›çš„ JmsMessagingTemplate ï¼Œå®ç°å‘é€æ¶ˆæ¯ã€‚ä»£ç å¦‚ä¸‹ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>// ClusteringProducer.java

@Component
public class ClusteringProducer {

    @Resource(name = ActiveMQConfig.CLUSTERING_JMS_TEMPLATE_BEAN_NAME)
    private JmsMessagingTemplate jmsTemplate;

    public void syncSend(Integer id) {
        // åˆ›å»º ClusteringMessage æ¶ˆæ¯
        ClusteringMessage message = new ClusteringMessage();
        message.setId(id);
        // åŒæ­¥å‘é€æ¶ˆæ¯
        jmsTemplate.convertAndSend(ClusteringMessage.QUEUE, message);
    }

}
</code></pre></div><ul><li>æ³¨æ„ï¼Œè¦æ³¨å…¥å¯¹åº”çš„ Bean åå­—ä¸º <code>ActiveMQConfig.CLUSTERING_JMS_TEMPLATE_BEAN_NAME</code> çš„ JmsMessagingTemplate å¯¹è±¡ã€‚</li></ul> <h3 id="_4-1-6-clusteringconsumer"><a href="#_4-1-6-clusteringconsumer" class="header-anchor">#</a> 4.1.6 ClusteringConsumer</h3> <p>åœ¨ <a href="https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo-message-model/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/consumer" target="_blank" rel="noopener noreferrer"><code>cn.iocoder.springboot.lab32.activemqdemo.consumer</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> åŒ…ä¸‹ï¼Œåˆ›å»º <a href="https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo-message-model/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/consumer/ClusteringConsumer.java" target="_blank" rel="noopener noreferrer">ClusteringConsumer<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ç±»ï¼Œ<strong>é›†ç¾¤</strong>æ¶ˆè´¹æ¶ˆæ¯ã€‚ä»£ç å¦‚ä¸‹ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>// ClusteringConsumer.java

@Component
public class ClusteringConsumer {

    private Logger logger = LoggerFactory.getLogger(getClass());

    @JmsListener(destination = ClusteringMessage.QUEUE,
            containerFactory = ActiveMQConfig.CLUSTERING_JMS_LISTENER_CONTAINER_FACTORY_BEAN_NAME)
    public void onMessage(ClusteringMessage message) {
        logger.info(&quot;[onMessage][çº¿ç¨‹ç¼–å·:{} æ¶ˆæ¯å†…å®¹ï¼š{}]&quot;, Thread.currentThread().getId(), message);
    }

}
</code></pre></div><ul><li>åœ¨ <code>@JmsListener</code> æ³¨è§£çš„ <code>containerFactory</code> å±æ€§ï¼Œè®¾ç½® Bean åå­—ä¸º <code>ActiveMQConfig.CLUSTERING_JMS_TEMPLATE_BEAN_NAME</code> çš„ DefaultJmsListenerContainerFactory å¯¹è±¡ã€‚</li></ul> <h3 id="_4-1-7-ç®€å•æµ‹è¯•"><a href="#_4-1-7-ç®€å•æµ‹è¯•" class="header-anchor">#</a> 4.1.7 ç®€å•æµ‹è¯•</h3> <p>åˆ›å»º <a href="https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo-message-model/src/test/java/cn/iocoder/springboot/lab32/activemqdemo/producer/ClusteringProducerTest.java" target="_blank" rel="noopener noreferrer">ClusteringProducerTest<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> æµ‹è¯•ç±»ï¼Œç”¨äºæµ‹è¯•é›†ç¾¤æ¶ˆè´¹ã€‚ä»£ç å¦‚ä¸‹ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>// ClusteringProducerTest.java

@RunWith(SpringRunner.class)
@SpringBootTest(classes = Application.class)
public class ClusteringProducerTest {

    private Logger logger = LoggerFactory.getLogger(getClass());

    @Autowired
    private ClusteringProducer producer;

    @Test
    public void mock() throws InterruptedException {
        // é˜»å¡ç­‰å¾…ï¼Œä¿è¯æ¶ˆè´¹
        new CountDownLatch(1).await();
    }

    @Test
    public void testSyncSend() throws InterruptedException {
        // å‘é€ 3 æ¡æ¶ˆæ¯
        for (int i = 0; i &lt; 3; i++) {
            int id = (int) (System.currentTimeMillis() / 1000);
            producer.syncSend(id);
            logger.info(&quot;[testSyncSend][å‘é€ç¼–å·ï¼š[{}] å‘é€æˆåŠŸ]&quot;, id);
        }

        // é˜»å¡ç­‰å¾…ï¼Œä¿è¯æ¶ˆè´¹
        new CountDownLatch(1).await();
    }

}
</code></pre></div><p>é¦–å…ˆï¼Œæ‰§è¡Œ <code>#mock()</code> æµ‹è¯•æ–¹æ³•ï¼Œå…ˆå¯åŠ¨ä¸€ä¸ªæ¶ˆè´¹ <code>&quot;QUEUE_CLUSTERING&quot;</code> è¿™ä¸ª Queue çš„ Consumer èŠ‚ç‚¹ã€‚</p> <p>ç„¶åï¼Œæ‰§è¡Œ <code>#testSyncSend()</code> æµ‹è¯•æ–¹æ³•ï¼Œå†å¯åŠ¨ä¸€ä¸ªæ¶ˆè´¹ <code>&quot;QUEUE_CLUSTERING&quot;</code> è¿™ä¸ª Queue çš„ Consumer èŠ‚ç‚¹ã€‚åŒæ—¶ï¼Œè¯¥æµ‹è¯•æ–¹æ³•ï¼Œè°ƒç”¨ <code>ClusteringProducer#syncSend(id)</code> æ–¹æ³•ï¼ŒåŒæ­¥å‘é€äº† 3 æ¡æ¶ˆæ¯ã€‚æ§åˆ¶å°è¾“å‡ºå¦‚ä¸‹ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>// #### testSyncSend æ–¹æ³•å¯¹åº”çš„æ§åˆ¶å° ####

# Producer åŒæ­¥å‘é€æ¶ˆæ¯æˆåŠŸ
2019-12-15 13:43:07.010  INFO 79244 --- [           main] c.i.s.l.a.p.ClusteringProducerTest       : [testSyncSend][å‘é€ç¼–å·ï¼š[1576388586] å‘é€æˆåŠŸ]
2019-12-15 13:43:07.015  INFO 79244 --- [           main] c.i.s.l.a.p.ClusteringProducerTest       : [testSyncSend][å‘é€ç¼–å·ï¼š[1576388587] å‘é€æˆåŠŸ]
2019-12-15 13:43:07.017  INFO 79244 --- [           main] c.i.s.l.a.p.ClusteringProducerTest       : [testSyncSend][å‘é€ç¼–å·ï¼š[1576388587] å‘é€æˆåŠŸ]

# ClusteringConsumer æ¶ˆè´¹äº† 1 æ¡æ¶ˆæ¯
2019-12-15 13:43:07.021  INFO 79244 --- [enerContainer-1] c.i.s.l.a.consumer.ClusteringConsumer    : [onMessage][çº¿ç¨‹ç¼–å·:18 æ¶ˆæ¯å†…å®¹ï¼šClusteringtMessage{id=1576388587}]

// ### mock æ–¹æ³•å¯¹åº”çš„æ§åˆ¶å° ####

# ClusteringConsumer æ¶ˆè´¹äº† 2 æ¡æ¶ˆæ¯
2019-12-15 13:43:07.029  INFO 79234 --- [enerContainer-1] c.i.s.l.a.consumer.ClusteringConsumer    : [onMessage][çº¿ç¨‹ç¼–å·:18 æ¶ˆæ¯å†…å®¹ï¼šClusteringtMessage{id=1576388586}]
2019-12-15 13:43:07.034  INFO 79234 --- [enerContainer-1] c.i.s.l.a.consumer.ClusteringConsumer    : [onMessage][çº¿ç¨‹ç¼–å·:18 æ¶ˆæ¯å†…å®¹ï¼šClusteringtMessage{id=1576388587}
</code></pre></div><ul><li>3 æ¡æ¶ˆæ¯ï¼Œéƒ½ä»…è¢« <strong>ä¸¤ä¸ª</strong> Consumer èŠ‚ç‚¹çš„<strong>ä¸€ä¸ª</strong>è¿›è¡Œæ¶ˆè´¹ã€‚ç¬¦åˆé›†ç¾¤æ¶ˆè´¹çš„é¢„æœŸ~</li></ul> <h3 id="_4-1-8-å¤šé›†ç¾¤ä¸‹çš„é›†ç¾¤æ¶ˆè´¹"><a href="#_4-1-8-å¤šé›†ç¾¤ä¸‹çš„é›†ç¾¤æ¶ˆè´¹" class="header-anchor">#</a> 4.1.8 å¤šé›†ç¾¤ä¸‹çš„é›†ç¾¤æ¶ˆè´¹</h3> <p>åœ¨<a href="https://www.iocoder.cn/Spring-Boot/ActiveMQ/?self#" target="_blank" rel="noopener noreferrer">ã€Œ4.1 é›†ç¾¤æ¶ˆè´¹ã€<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬åªæä¾›äº†<strong>å•é›†ç¾¤</strong>ä¸‹çš„é›†ç¾¤æ¶ˆè´¹ã€‚å®é™…ä¸šåŠ¡åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šå­˜åœ¨<strong>å¤šé›†ç¾¤</strong>çš„é›†ç¾¤æ¶ˆè´¹ã€‚ä¸äº†è§£çš„èƒ–å‹ï¼Œå¯ä»¥çœ‹çœ‹<a href="https://www.cnblogs.com/Peter2014/p/9389600.html" target="_blank" rel="noopener noreferrer">ã€ŠActiveMQ ä¹‹ VirtualTopic æ˜¯ä»€ä¹ˆï¼Ÿã€‹<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ã€‚</p> <p>æ­£å¦‚è¯¥æ–‡ç« çš„æ ‡é¢˜ï¼Œéœ€è¦é€šè¿‡ ActiveMQ <strong>è‡ªå®šä¹‰</strong>çš„ VirtualTopic è™šæ‹Ÿä¸»é¢˜ï¼Œè€Œé JMS æ‰€æä¾›çš„ã€‚å…·ä½“çš„ç¤ºä¾‹ï¼Œèƒ–å‹å¯ä»¥å…ˆçœ‹å¦‚ä¸‹ä¸¤ç¯‡æ–‡ç« ï¼š</p> <ul><li><a href="http://blog.sina.com.cn/s/blog_7d1968e20102wyq0.html" target="_blank" rel="noopener noreferrer">ã€Šspringboot-29-activemq è™šæ‹Ÿä¸»é¢˜å®ç°æ¶ˆè´¹è€…åˆ†ç»„å’Œç®€å•è·¯ç”±ã€‹<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://blog.csdn.net/kimmking/article/details/9773085" target="_blank" rel="noopener noreferrer">ã€ŠActiveMQ é«˜çº§ç‰¹æ€§ï¼šè™šæ‹Ÿ Destinations å®ç°æ¶ˆè´¹è€…åˆ†ç»„ä¸ç®€å•è·¯ç”±ã€‹<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h2 id="_4-2-å¹¿æ’­æ¶ˆè´¹"><a href="#_4-2-å¹¿æ’­æ¶ˆè´¹" class="header-anchor">#</a> 4.2 å¹¿æ’­æ¶ˆè´¹</h2> <p>åœ¨ ActiveMQ ä¸­ï¼Œå¦‚æœå¤šä¸ª Consumer è®¢é˜…ç›¸åŒçš„ Topic ï¼Œé‚£ä¹ˆæ¯ä¸€æ¡æ¶ˆæ¯<strong>éƒ½</strong>ä¼šè¢«ä¸€ä¸ª Consumer æ‰€æ¶ˆè´¹ã€‚è¿™ä¸ªç‰¹æ€§ï¼Œå°±ä¸ºæˆ‘ä»¬å®ç°å¹¿æ’­æ¶ˆè´¹æä¾›äº†åŸºç¡€ã€‚</p> <p>ä¸‹é¢ï¼Œè®©æˆ‘ä»¬å¼€å§‹é›†ç¾¤æ¶ˆè´¹çš„ç¤ºä¾‹ã€‚</p> <h3 id="_4-2-1-broadcastmessage"><a href="#_4-2-1-broadcastmessage" class="header-anchor">#</a> 4.2.1 BroadcastMessage</h3> <p>åœ¨ <a href="https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo-message-model/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/message/" target="_blank" rel="noopener noreferrer"><code>cn.iocoder.springboot.lab32.activemqdemo.message</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> åŒ…ä¸‹ï¼Œåˆ›å»º <a href="https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo-message-model/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/message/BroadcastMessage.java" target="_blank" rel="noopener noreferrer">BroadcastMessage<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> æ¶ˆæ¯ç±»ï¼Œæä¾›ç»™å½“å‰ç¤ºä¾‹ä½¿ç”¨ã€‚ä»£ç å¦‚ä¸‹ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>// ClusteringMessage.java

public class BroadcastMessage implements Serializable {

    public static final String TOPIC = &quot;TOPIC_BROADCASTING&quot;;

    /**
     * ç¼–å·
     */
    private Integer id;

    // ... çœç•¥ set/get/toString æ–¹æ³•

}
</code></pre></div><ul><li>åœ¨æ¶ˆæ¯ç±»é‡Œï¼Œæˆ‘ä»¬æšä¸¾äº† Topic çš„åå­—ã€‚</li></ul> <h3 id="_4-2-2-activemqconfig"><a href="#_4-2-2-activemqconfig" class="header-anchor">#</a> 4.2.2 ActiveMQConfig</h3> <p>ä¿®æ”¹ <a href="https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo-message-model/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/config/ActiveMQConfig.java" target="_blank" rel="noopener noreferrer">ActiveMQConfig<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> é…ç½®ç±»ï¼Œæ·»åŠ å¹¿æ’­æ¶ˆè´¹éœ€è¦çš„é…ç½®ã€‚ä»£ç å¦‚ä¸‹ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>// ActiveMQConfig.java

public static final String BROADCAST_JMS_LISTENER_CONTAINER_FACTORY_BEAN_NAME = &quot;broadcastJmsListenerContainerFactory&quot;;

public static final String BROADCAST_JMS_TEMPLATE_BEAN_NAME = &quot;broadcastJmsTemplate&quot;;

    @Bean(BROADCAST_JMS_LISTENER_CONTAINER_FACTORY_BEAN_NAME)
public DefaultJmsListenerContainerFactory broadcastJmsListenerContainerFactory(
        DefaultJmsListenerContainerFactoryConfigurer configurer, ConnectionFactory connectionFactory) {
    DefaultJmsListenerContainerFactory factory = new DefaultJmsListenerContainerFactory();
    configurer.configure(factory, connectionFactory);
    factory.setPubSubDomain(true);
    return factory;
}

@Bean(BROADCAST_JMS_TEMPLATE_BEAN_NAME)
public JmsMessagingTemplate broadcastJmsTemplate(ConnectionFactory connectionFactory) {
    // åˆ›å»º JmsTemplate å¯¹è±¡
    JmsTemplate template = new JmsTemplate(connectionFactory);
    template.setPubSubDomain(true);
    // åˆ›å»º JmsMessageTemplate
    return new JmsMessagingTemplate(template);
}
</code></pre></div><ul><li>åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ç»™é›†ç¾¤æ¶ˆè´¹åˆ›å»ºäº†ä¸€å¥— JmsTemplate å’Œ DefaultJmsListenerContainerFactory ã€‚</li></ul> <h3 id="_4-2-3-broadcastproducer"><a href="#_4-2-3-broadcastproducer" class="header-anchor">#</a> 4.2.3 BroadcastProducer</h3> <p>åœ¨ <a href="https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo-message-model/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/producer" target="_blank" rel="noopener noreferrer"><code>cn.iocoder.springboot.lab32.activemqdemo.producer</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> åŒ…ä¸‹ï¼Œåˆ›å»º <a href="https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo-message-model/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/producer/BroadcastProducer.java" target="_blank" rel="noopener noreferrer">BroadcastProducer<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ç±»ï¼Œå®ƒä¼šä½¿ç”¨ Spring-JMS å°è£…æä¾›çš„ JmsMessagingTemplate ï¼Œå®ç°å‘é€æ¶ˆæ¯ã€‚ä»£ç å¦‚ä¸‹ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>// BroadcastProducer.java

@Component
public class BroadcastProducer {

    @Resource(name = ActiveMQConfig.BROADCAST_JMS_TEMPLATE_BEAN_NAME)
    private JmsMessagingTemplate jmsMessagingTemplate;

    public void syncSend(Integer id) {
        // åˆ›å»º BroadcastMessage æ¶ˆæ¯
        BroadcastMessage message = new BroadcastMessage();
        message.setId(id);
        // åŒæ­¥å‘é€æ¶ˆæ¯
        jmsMessagingTemplate.convertAndSend(BroadcastMessage.TOPIC, message);
    }

}
</code></pre></div><ul><li>å’Œ<a href="https://www.iocoder.cn/Spring-Boot/ActiveMQ/?self#" target="_blank" rel="noopener noreferrer">ã€Œ4.1.5 ClusteringProducerã€<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>æ˜¯ä¸€è‡´ï¼Œåªæ˜¯ä½¿ç”¨äº†ä¸åŒçš„ Topic å’Œæ¶ˆæ¯ã€‚</li> <li>æ³¨æ„ï¼Œè¦æ³¨å…¥å¯¹åº”çš„ Bean åå­—ä¸º <code>ActiveMQConfig.BROADCAST_JMS_TEMPLATE_BEAN_NAME</code> çš„ JmsMessagingTemplate å¯¹è±¡ã€‚</li></ul> <h3 id="_4-2-4-broadcastconsumer"><a href="#_4-2-4-broadcastconsumer" class="header-anchor">#</a> 4.2.4 BroadcastConsumer</h3> <p>åœ¨ <a href="https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo-message-model/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/consumer" target="_blank" rel="noopener noreferrer"><code>cn.iocoder.springboot.lab32.activemqdemo.consumer</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> åŒ…ä¸‹ï¼Œåˆ›å»º <a href="https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo-message-model/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/consumer/BroadcastConsumer.java" target="_blank" rel="noopener noreferrer">BroadcastConsumer<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ç±»ï¼Œ<strong>å¹¿æ’­</strong>æ¶ˆè´¹æ¶ˆæ¯ã€‚ä»£ç å¦‚ä¸‹ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>// BroadcastConsumer.java

@Component
public class BroadcastConsumer {

    private Logger logger = LoggerFactory.getLogger(getClass());

    @JmsListener(destination = BroadcastMessage.TOPIC,
            containerFactory = ActiveMQConfig.BROADCAST_JMS_LISTENER_CONTAINER_FACTORY_BEAN_NAME)
    public void onMessage(BroadcastMessage message) {
        logger.info(&quot;[onMessage][çº¿ç¨‹ç¼–å·:{} æ¶ˆæ¯å†…å®¹ï¼š{}]&quot;, Thread.currentThread().getId(), message);
    }

}
</code></pre></div><ul><li>æ€»ä½“å’Œ<a href="https://www.iocoder.cn/Spring-Boot/ActiveMQ/?self#" target="_blank" rel="noopener noreferrer">ã€Œ4.1.6 ClusteringConsumerã€<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>æ˜¯ä¸€è‡´çš„ã€‚</li> <li>åœ¨ <code>@JmsListener</code> æ³¨è§£çš„ <code>containerFactory</code> å±æ€§ï¼Œè®¾ç½® Bean åå­—ä¸º <code>ActiveMQConfig.BROADCAST_JMS_LISTENER_CONTAINER_FACTORY_BEAN_NAME</code> çš„ DefaultJmsListenerContainerFactory å¯¹è±¡ã€‚</li></ul> <h3 id="_4-2-5-ç®€å•æµ‹è¯•"><a href="#_4-2-5-ç®€å•æµ‹è¯•" class="header-anchor">#</a> 4.2.5 ç®€å•æµ‹è¯•</h3> <p>åˆ›å»º <a href="https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo-message-model/src/test/java/cn/iocoder/springboot/lab32/activemqdemo/producer/BroadcastProducerTest.java" target="_blank" rel="noopener noreferrer">BroadcastProducerTest<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> æµ‹è¯•ç±»ï¼Œç”¨äºæµ‹è¯•å¹¿æ’­æ¶ˆè´¹ã€‚ä»£ç å¦‚ä¸‹ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>// BroadcastProducerTest.java

@RunWith(SpringRunner.class)
@SpringBootTest(classes = Application.class)
public class BroadcastProducerTest {

    private Logger logger = LoggerFactory.getLogger(getClass());

    @Autowired
    private BroadcastProducer producer;

    @Test
    public void mock() throws InterruptedException {
        // é˜»å¡ç­‰å¾…ï¼Œä¿è¯æ¶ˆè´¹
        new CountDownLatch(1).await();
    }

    @Test
    public void testSyncSend() throws InterruptedException {
        for (int i = 0; i &lt; 3; i++) {
            int id = (int) (System.currentTimeMillis() / 1000);
            producer.syncSend(id);
            logger.info(&quot;[testSyncSend][å‘é€ç¼–å·ï¼š[{}] å‘é€æˆåŠŸ]&quot;, id);
        }

        // é˜»å¡ç­‰å¾…ï¼Œä¿è¯æ¶ˆè´¹
        new CountDownLatch(1).await();
    }

}
</code></pre></div><p>é¦–å…ˆï¼Œæ‰§è¡Œ <code>#mock()</code> æµ‹è¯•æ–¹æ³•ï¼Œå…ˆå¯åŠ¨ä¸€ä¸ªæ¶ˆè´¹ <code>&quot;TOPIC_BROADCASTING&quot;</code> è¿™ä¸ª Topic çš„ Consumer èŠ‚ç‚¹ã€‚</p> <p>ç„¶åï¼Œæ‰§è¡Œ <code>#testSyncSend()</code> æµ‹è¯•æ–¹æ³•ï¼Œå†å¯åŠ¨ä¸€ä¸ªæ¶ˆè´¹ <code>&quot;TOPIC_BROADCASTING&quot;</code> è¿™ä¸ª Topic çš„ Consumer èŠ‚ç‚¹ã€‚åŒæ—¶ï¼Œè¯¥æµ‹è¯•æ–¹æ³•ï¼Œè°ƒç”¨ <code>BroadcastProducer#syncSend(id)</code> æ–¹æ³•ï¼ŒåŒæ­¥å‘é€äº† 3 æ¡æ¶ˆæ¯ã€‚æ§åˆ¶å°è¾“å‡ºå¦‚ä¸‹ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>// #### testSyncSend æ–¹æ³•å¯¹åº”çš„æ§åˆ¶å° ####

# Producer åŒæ­¥å‘é€æ¶ˆæ¯æˆåŠŸ
2019-12-15 14:11:41.256  INFO 80487 --- [           main] c.i.s.l.a.p.BroadcastProducerTest        : [testSyncSend][å‘é€ç¼–å·ï¼š[1576390301] å‘é€æˆåŠŸ]
2019-12-15 14:11:41.258  INFO 80487 --- [           main] c.i.s.l.a.p.BroadcastProducerTest        : [testSyncSend][å‘é€ç¼–å·ï¼š[1576390301] å‘é€æˆåŠŸ]
2019-12-15 14:11:41.259  INFO 80487 --- [           main] c.i.s.l.a.p.BroadcastProducerTest        : [testSyncSend][å‘é€ç¼–å·ï¼š[1576390301] å‘é€æˆåŠŸ]

# BroadcastConsumer æ¶ˆè´¹äº† 3 æ¡æ¶ˆæ¯
2019-12-15 14:11:41.259  INFO 80487 --- [enerContainer-1] c.i.s.l.a.consumer.BroadcastConsumer     : [onMessage][çº¿ç¨‹ç¼–å·:19 æ¶ˆæ¯å†…å®¹ï¼šBroadcastMessage{id=1576390301}]
2019-12-15 14:11:41.261  INFO 80487 --- [enerContainer-1] c.i.s.l.a.consumer.BroadcastConsumer     : [onMessage][çº¿ç¨‹ç¼–å·:19 æ¶ˆæ¯å†…å®¹ï¼šBroadcastMessage{id=1576390301}]
2019-12-15 14:11:41.263  INFO 80487 --- [enerContainer-1] c.i.s.l.a.consumer.BroadcastConsumer     : [onMessage][çº¿ç¨‹ç¼–å·:19 æ¶ˆæ¯å†…å®¹ï¼šBroadcastMessage{id=1576390301}]

// ### mock æ–¹æ³•å¯¹åº”çš„æ§åˆ¶å° ####

# BroadcastConsumer ä¹Ÿæ¶ˆè´¹äº† 3 æ¡æ¶ˆ
2019-12-15 14:11:41.275  INFO 80478 --- [enerContainer-1] c.i.s.l.a.consumer.BroadcastConsumer     : [onMessage][çº¿ç¨‹ç¼–å·:19 æ¶ˆæ¯å†…å®¹ï¼šBroadcastMessage{id=1576390301}]
2019-12-15 14:11:41.278  INFO 80478 --- [enerContainer-1] c.i.s.l.a.consumer.BroadcastConsumer     : [onMessage][çº¿ç¨‹ç¼–å·:19 æ¶ˆæ¯å†…å®¹ï¼šBroadcastMessage{id=1576390301}]
2019-12-15 14:11:41.279  INFO 80478 --- [enerContainer-1] c.i.s.l.a.consumer.BroadcastConsumer     : [onMessage][çº¿ç¨‹ç¼–å·:19 æ¶ˆæ¯å†…å®¹ï¼šBroadcastMessage{id=1576390301}]
</code></pre></div><ul><li><strong>ä¸¤ä¸ª</strong> Consumer èŠ‚ç‚¹ï¼Œéƒ½æ¶ˆè´¹äº†è¿™æ¡å‘é€çš„æ¶ˆæ¯ã€‚ç¬¦åˆå¹¿æ’­æ¶ˆè´¹çš„é¢„æœŸ~</li></ul> <h1 id="_5-å®šæ—¶æ¶ˆæ¯"><a href="#_5-å®šæ—¶æ¶ˆæ¯" class="header-anchor">#</a> 5. å®šæ—¶æ¶ˆæ¯</h1> <blockquote><p>ç¤ºä¾‹ä»£ç å¯¹åº”ä»“åº“ï¼š<a href="https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo-delay" target="_blank" rel="noopener noreferrer">lab-32-activemq-demo-delay<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <p>ActiveMQ å†…ç½®äº†å¯¹å®šæ—¶æ¶ˆæ¯çš„æ”¯æŒï¼Œä¸äº†è§£çš„èƒ–å‹ï¼Œå¯ä»¥çœ‹çœ‹å¦‚ä¸‹æ–‡æ¡£ï¼š</p> <ul><li><a href="http://activemq.apache.org/delay-and-schedule-message-delivery.html" target="_blank" rel="noopener noreferrer">ã€ŠActiveMQ å®˜æ–¹æ–‡æ¡£ â€”â€” Delay and Schedule Message Deliveryã€‹<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://blog.csdn.net/KimmKing/article/details/8443872" target="_blank" rel="noopener noreferrer">ã€ŠActiveMQ æ¶ˆæ¯ç‰¹æ€§ï¼šå»¶è¿Ÿå’Œå®šæ—¶æ¶ˆæ¯æŠ•é€’ï¼ˆDelay and Schedule Message Deliveryï¼‰ã€‹<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒActiveMQ é»˜è®¤æœªå¼€å¯å®šæ—¶æ¶ˆæ¯çš„åŠŸèƒ½ï¼Œéœ€è¦æˆ‘ä»¬<strong>æ‰‹åŠ¨</strong>å»é…ç½®å¼€å¯ã€‚é€šè¿‡ç¼–è¾‘ <code>conf/activemq.xml</code> é…ç½®æ–‡ä»¶ï¼Œæ·»åŠ  <code>schedulerSupport=&quot;true&quot;</code> æ¥å¼€å¯ã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;!--
    The &lt;broker&gt; element is used to configure the ActiveMQ broker.
--&gt;
&lt;broker xmlns=&quot;http://activemq.apache.org/schema/core&quot; brokerName=&quot;localhost&quot; dataDirectory=&quot;${activemq.data}&quot; schedulerSupport=&quot;true&quot;&gt;
</code></pre></div><p>é…ç½®å®Œæˆï¼Œé€šè¿‡ <code>bin/macosx/activemq restart</code> å°† ActiveMQ é‡å¯å³å¯ç”Ÿæ•ˆã€‚</p> <p>ä¸‹é¢ï¼Œæˆ‘ä»¬æ¥å®ç°ä¸€ä¸ªå®šæ—¶æ¶ˆæ¯çš„ç¤ºä¾‹ã€‚è€ƒè™‘åˆ°ä¸æ±¡æŸ“ä¸Šè¿°çš„ç¤ºä¾‹ï¼Œæˆ‘ä»¬æ–°å»ºä¸€ä¸ª <a href="https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo-delay" target="_blank" rel="noopener noreferrer">lab-32-activemq-demo-delay<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> é¡¹ç›®ã€‚</p> <h2 id="_5-1-å¼•å…¥ä¾èµ–"><a href="#_5-1-å¼•å…¥ä¾èµ–" class="header-anchor">#</a> 5.1 å¼•å…¥ä¾èµ–</h2> <p>å’Œ <a href="https://www.iocoder.cn/Spring-Boot/ActiveMQ/?self#" target="_blank" rel="noopener noreferrer">ã€Œ3.1 å¼•å…¥ä¾èµ–ã€<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ä¸€è‡´ï¼Œè§ <a href="https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo-delay/pom.xml" target="_blank" rel="noopener noreferrer"><code>pom.xml</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> æ–‡ä»¶ã€‚</p> <h2 id="_5-2-åº”ç”¨é…ç½®æ–‡ä»¶"><a href="#_5-2-åº”ç”¨é…ç½®æ–‡ä»¶" class="header-anchor">#</a> 5.2 åº”ç”¨é…ç½®æ–‡ä»¶</h2> <p>å’Œ <a href="https://www.iocoder.cn/Spring-Boot/ActiveMQ/?self#" target="_blank" rel="noopener noreferrer">ã€Œ3.2 åº”ç”¨é…ç½®æ–‡ä»¶ã€<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ä¸€è‡´ï¼Œè§ <a href="https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo-delay/src/main/resources/application.yaml" target="_blank" rel="noopener noreferrer"><code>application.yaml</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> æ–‡ä»¶ã€‚</p> <h2 id="_5-3-demo02message"><a href="#_5-3-demo02message" class="header-anchor">#</a> 5.3 Demo02Message</h2> <p>åœ¨ <a href="https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo-delay/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/message" target="_blank" rel="noopener noreferrer"><code>cn.iocoder.springboot.lab32.activemqdemo.message</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> åŒ…ä¸‹ï¼Œåˆ›å»º <a href="https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo-delay/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/message/Demo02Message.java" target="_blank" rel="noopener noreferrer">Demo02Message<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> æ¶ˆæ¯ç±»ï¼Œæä¾›ç»™å½“å‰ç¤ºä¾‹ä½¿ç”¨ã€‚</p> <p>å’Œ<a href="https://www.iocoder.cn/Spring-Boot/ActiveMQ/?self#" target="_blank" rel="noopener noreferrer">ã€Œ3.4 Demo01Messageã€<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ä¸€è‡´ï¼Œåªæ˜¯ Queue åå­—ä¸åŒã€‚</p> <h2 id="_5-4-demo02producer"><a href="#_5-4-demo02producer" class="header-anchor">#</a> 5.4 Demo02Producer</h2> <p>åœ¨ <a href="https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo-delay/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/producer" target="_blank" rel="noopener noreferrer"><code>cn.iocoder.springboot.lab32.activemqdemo.producer</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> åŒ…ä¸‹ï¼Œåˆ›å»º <a href="https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo-delay/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/producer/Demo02Producer.java" target="_blank" rel="noopener noreferrer">Demo02Producer<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ç±»ï¼Œå®ƒä¼šä½¿ç”¨ Spring-JMS å°è£…æä¾›çš„ JmsMessagingTemplate ï¼Œå®ç°å‘é€<strong>å®šæ—¶</strong>æ¶ˆæ¯ã€‚ä»£ç å¦‚ä¸‹ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>// Demo02Producer.java

@Component
public class Demo02Producer {

    @Autowired
    private JmsMessagingTemplate jmsTemplate;

    public void syncSend(Integer id, Integer delay) {
        // åˆ›å»º Demo02Message æ¶ˆæ¯
        Demo02Message message = new Demo02Message();
        message.setId(id);
        // åˆ›å»º Header
        Map&lt;String, Object&gt; headers = null;
        if (delay != null &amp;&amp; delay &gt; 0) {
            headers = new HashMap&lt;&gt;();
            headers.put(ScheduledMessage.AMQ_SCHEDULED_DELAY, delay);
        }
        // åŒæ­¥å‘é€æ¶ˆæ¯
        jmsTemplate.convertAndSend(Demo02Message.QUEUE, message, headers);
    }

}
</code></pre></div><ul><li>è°ƒç”¨ <code>#syncSend(Integer id, Integer delay)</code> æ–¹æ³•æ¥å‘é€æ¶ˆæ¯æ—¶ï¼Œå¦‚æœä¼ é€’äº†æ–¹æ³•å‚æ•° <code>delay</code> ï¼Œåˆ™æˆ‘ä»¬ä¼šè®¾ç½®åˆ°æ¶ˆæ¯çš„ Header çš„ <code>AMQ_SCHEDULED_DELAY</code> ä¸­ï¼Œå®ç°å»¶è¿Ÿ <code>delay</code> æ¯«ç§’çš„å®šæ—¶æ¶ˆæ¯ã€‚</li></ul> <h2 id="_5-5-demo02consumer"><a href="#_5-5-demo02consumer" class="header-anchor">#</a> 5.5 Demo02Consumer</h2> <p>åœ¨ <a href="https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo-delay/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/consumer" target="_blank" rel="noopener noreferrer"><code>cn.iocoder.springboot.lab32.activemqdemo.consumer</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> åŒ…ä¸‹ï¼Œåˆ›å»º <a href="https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo-delay/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/consumer/Demo02Consumer.java" target="_blank" rel="noopener noreferrer">Demo02Consumer<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ç±»ï¼Œæ¶ˆè´¹æ¶ˆæ¯ã€‚</p> <p>å’Œ<a href="https://www.iocoder.cn/Spring-Boot/ActiveMQ/?self#" target="_blank" rel="noopener noreferrer">ã€Œ3.6 Demo01Consumerã€<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>åŸºæœ¬ä¸€è‡´ï¼Œå·®åˆ«åœ¨äºæ¶ˆè´¹çš„é˜Ÿåˆ—æ˜¯ <code>&quot;QUEUE_DEMO_02&quot;</code> ã€‚</p> <h2 id="_5-6-ç®€å•æµ‹è¯•"><a href="#_5-6-ç®€å•æµ‹è¯•" class="header-anchor">#</a> 5.6 ç®€å•æµ‹è¯•</h2> <p>åˆ›å»º <a href="https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo-delay/src/test/java/cn/iocoder/springboot/lab32/activemqdemo/producer/Demo02ProducerTest.java" target="_blank" rel="noopener noreferrer">Demo02ProducerTest<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> æµ‹è¯•ç±»ï¼Œç¼–å†™å•å…ƒæµ‹è¯•æ–¹æ³•ï¼Œæµ‹è¯•<strong>å®šæ—¶æ¶ˆæ¯</strong>çš„æ•ˆæœã€‚ä»£ç å¦‚ä¸‹ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>// Demo02ProducerTest.java

@RunWith(SpringRunner.class)
@SpringBootTest(classes = Application.class)
public class Demo02ProducerTest {

    private Logger logger = LoggerFactory.getLogger(getClass());

    @Autowired
    private Demo02Producer producer;

    @Test
    public void testSyncSend01() throws InterruptedException {
        // ä¸è®¾ç½®æ¶ˆæ¯çš„è¿‡æœŸæ—¶é—´
        this.testSyncSendDelay(null);
    }

    @Test
    public void testSyncSend02() throws InterruptedException {
        // è®¾ç½®å‘é€æ¶ˆæ¯çš„è¿‡æœŸæ—¶é—´ä¸º 5000 æ¯«ç§’
        this.testSyncSendDelay(5000);
    }

    private void testSyncSendDelay(Integer delay) throws InterruptedException {
        int id = (int) (System.currentTimeMillis() / 1000);
        producer.syncSend(id, delay);
        logger.info(&quot;[testSyncSendDelay][å‘é€ç¼–å·ï¼š[{}] å‘é€æˆåŠŸ]&quot;, id);

        // é˜»å¡ç­‰å¾…ï¼Œä¿è¯æ¶ˆè´¹
        new CountDownLatch(1).await();
    }

}
</code></pre></div><ul><li><code>#testSyncSend01()</code> æ–¹æ³•ï¼Œä¸è®¾ç½®æ¶ˆæ¯çš„è¿‡æœŸæ—¶é—´ã€‚</li> <li><code>#testSyncSend02()</code> æ–¹æ³•ï¼Œå‘é€æ¶ˆæ¯çš„<strong>è¿‡æœŸæ—¶é—´ä¸º 5000 æ¯«ç§’</strong>ã€‚</li></ul> <p>æˆ‘ä»¬å…ˆæ¥æ‰§è¡Œ <code>#testSyncSend01()</code> æ–¹æ³•ï¼Œä¸è®¾ç½®æ¶ˆæ¯çš„è¿‡æœŸæ—¶é—´ã€‚æ§åˆ¶å°è¾“å‡ºå¦‚ä¸‹ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code># Producer åŒæ­¥å‘é€æ¶ˆæ¯æˆåŠŸã€‚
2019-12-15 17:40:07.597  INFO 84240 --- [           main] c.i.s.l.a.producer.Demo02ProducerTest    : [testSyncSendDelay][å‘é€ç¼–å·ï¼š[1576402807] å‘é€æˆåŠŸ]

# Consumer ç«‹å³æ¶ˆè´¹åˆ°è¯¥æ¶ˆæ¯
2019-12-15 17:40:07.599  INFO 84240 --- [enerContainer-1] c.i.s.l.a.consumer.Demo02Consumer        : [onMessage][çº¿ç¨‹ç¼–å·:18 æ¶ˆæ¯å†…å®¹ï¼šDemo01Message{id=1576402807}]
</code></pre></div><ul><li>ç¬¦åˆé¢„æœŸï¼Œæ¶ˆæ¯è¢« Consumer ç«‹å³æ¶ˆè´¹ã€‚</li></ul> <p>æˆ‘ä»¬å†æ¥æ‰§è¡Œ <code>#testSyncSend02()</code> æ–¹æ³•ï¼Œå‘é€æ¶ˆæ¯çš„<strong>è¿‡æœŸæ—¶é—´ä¸º 5000 æ¯«ç§’</strong>ã€‚æ§åˆ¶å°è¾“å‡ºå¦‚ä¸‹ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code># Producer åŒæ­¥å‘é€æ¶ˆæ¯æˆåŠŸã€‚
2019-12-15 17:42:34.560  INFO 84344 --- [           main] c.i.s.l.a.producer.Demo02ProducerTest    : [testSyncSendDelay][å‘é€ç¼–å·ï¼š[1576402954] å‘é€æˆåŠŸ]

# Consumer 5 ç§’åï¼Œæ¶ˆè´¹åˆ°è¯¥æ¶ˆæ¯
2019-12-15 17:42:40.010  INFO 84344 --- [enerContainer-1] c.i.s.l.a.consumer.Demo02Consumer        : [onMessage][çº¿ç¨‹ç¼–å·:18 æ¶ˆæ¯å†…å®¹ï¼šDemo02Message{id=1576402954}]
</code></pre></div><ul><li>ç¬¦åˆé¢„æœŸï¼Œæ¶ˆæ¯ 5 ç§’åè¢« Consumer ç«‹å³æ¶ˆè´¹ã€‚</li></ul> <h1 id="_6-å¹¶å‘æ¶ˆè´¹"><a href="#_6-å¹¶å‘æ¶ˆè´¹" class="header-anchor">#</a> 6. å¹¶å‘æ¶ˆè´¹</h1> <blockquote><p>ç¤ºä¾‹ä»£ç å¯¹åº”ä»“åº“ï¼š<a href="https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo-concurrency" target="_blank" rel="noopener noreferrer">lab-32-activemq-demo-concurrency<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <p>åœ¨ä¸Šè¿°çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬é…ç½®çš„æ¯ä¸€ä¸ª Spring-JMS <code>@JmsListener</code> ï¼Œéƒ½æ˜¯<strong>ä¸²è¡Œ</strong>æ¶ˆè´¹çš„ã€‚æ˜¾ç„¶ï¼Œè¿™åœ¨ç›‘å¬çš„ Queue æ¯ç§’æ¶ˆæ¯é‡æ¯”è¾ƒå¤§çš„æ—¶å€™ï¼Œä¼šå¯¼è‡´æ¶ˆè´¹ä¸åŠæ—¶ï¼Œå¯¼è‡´æ¶ˆæ¯ç§¯å‹çš„é—®é¢˜ã€‚</p> <p>è™½ç„¶è¯´ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å¯åŠ¨å¤šä¸ª JVM è¿›ç¨‹ï¼Œå®ç°<strong>å¤šè¿›ç¨‹çš„å¹¶å‘æ¶ˆè´¹</strong>ï¼Œä»è€ŒåŠ é€Ÿæ¶ˆè´¹çš„é€Ÿåº¦ã€‚ä½†æ˜¯é—®é¢˜æ˜¯ï¼Œå¦èƒ½å¤Ÿå®ç°<strong>å¤šçº¿ç¨‹</strong>çš„å¹¶å‘æ¶ˆè´¹å‘¢ï¼Ÿç­”æ¡ˆæ˜¯<strong>æœ‰</strong>ã€‚</p> <p>åœ¨ <code>@JmsListener</code> æ³¨è§£ä¸­ï¼Œæœ‰ <code>concurrency</code> å±æ€§ï¼Œå®ƒå¯ä»¥æŒ‡å®šå¹¶å‘æ¶ˆè´¹çš„çº¿ç¨‹æ•°ã€‚ä¾‹å¦‚è¯´ï¼Œå¦‚æœè®¾ç½® <code>concurrency=4</code> æ—¶ï¼ŒSpring-AMQP å°±ä¼šä¸º<strong>è¯¥</strong> <code>@JmsListener</code> åˆ›å»º<strong>è‡³å¤š</strong> 4 ä¸ªçº¿ç¨‹ï¼Œè¿›è¡Œå¹¶å‘æ¶ˆè´¹ã€‚</p> <p>è€ƒè™‘åˆ°è®©èƒ–å‹èƒ½å¤Ÿæ›´å¥½çš„ç†è§£ <code>concurrency</code> å±æ€§ï¼Œæˆ‘ä»¬æ¥ç®€å•è¯´è¯´ Spring-JMS åœ¨è¿™å—çš„å®ç°æ–¹å¼ã€‚æˆ‘ä»¬æ¥ä¸¾ä¸ªä¾‹å­ï¼š</p> <ul><li>é¦–å…ˆï¼Œæˆ‘ä»¬æ¥åˆ›å»ºä¸€ä¸ª Queue ä¸º <code>&quot;DEMO_03&quot;</code> ã€‚</li> <li>ç„¶åï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ª Demo03Consumer ç±»ï¼Œå¹¶åœ¨å…¶æ¶ˆè´¹æ–¹æ³•ä¸Šï¼Œæ·»åŠ  <code>@JmsListener(concurrency=2)</code> æ³¨è§£ã€‚</li> <li>å†ç„¶åï¼Œæˆ‘ä»¬å¯åŠ¨é¡¹ç›®ã€‚Spring-AMQP ä¼šæ ¹æ® <code>@JmsListener(concurrency=2)</code> æ³¨è§£ï¼Œåˆ›å»º <strong>2</strong> ä¸ª ActiveMQ Consumer ã€‚æ³¨æ„å™¢ï¼Œæ˜¯ <strong>2</strong> ä¸ª ActiveMQ Consumer å‘¢ï¼ï¼ï¼åç»­ï¼Œæ¯ä¸ª ActiveMQ Consumer ä¼šè¢«<strong>å•ç‹¬</strong>åˆ†é…åˆ°ä¸€ä¸ªçº¿ç¨‹ä¸­ï¼Œè¿›è¡Œæ‹‰å–æ¶ˆæ¯ï¼Œæ¶ˆè´¹æ¶ˆæ¯ã€‚</li></ul> <p>é…±ç´«è®²è§£ä¸€ä¸‹ï¼Œèƒ–å‹å¯¹ Spring-JMS å®ç°<strong>å¤šçº¿ç¨‹</strong>çš„å¹¶å‘æ¶ˆè´¹çš„æœºåˆ¶ï¼Œæ˜¯å¦ç†è§£äº†ã€‚</p> <p>ä¸‹é¢ï¼Œæˆ‘ä»¬å¼€å§‹æœ¬å°èŠ‚çš„ç¤ºä¾‹ã€‚æœ¬ç¤ºä¾‹å°±æ˜¯ä¸Šè¿°ä¸¾ä¾‹çš„å…·ä½“å®ç°ã€‚è€ƒè™‘åˆ°ä¸æ±¡æŸ“ä¸Šè¿°çš„ç¤ºä¾‹ï¼Œæˆ‘ä»¬æ–°å»ºä¸€ä¸ª <a href="https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo-concurrency" target="_blank" rel="noopener noreferrer">lab-32-activemq-demo-concurrency<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> é¡¹ç›®ã€‚</p> <h2 id="_6-1-å¼•å…¥ä¾èµ–"><a href="#_6-1-å¼•å…¥ä¾èµ–" class="header-anchor">#</a> 6.1 å¼•å…¥ä¾èµ–</h2> <p>å’Œ <a href="https://www.iocoder.cn/Spring-Boot/ActiveMQ/?self#" target="_blank" rel="noopener noreferrer">ã€Œ3.1 å¼•å…¥ä¾èµ–ã€<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ä¸€è‡´ï¼Œè§ <a href="https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo-concurrency/pom.xml" target="_blank" rel="noopener noreferrer"><code>pom.xml</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> æ–‡ä»¶ã€‚</p> <h2 id="_6-2-åº”ç”¨é…ç½®æ–‡ä»¶"><a href="#_6-2-åº”ç”¨é…ç½®æ–‡ä»¶" class="header-anchor">#</a> 6.2 åº”ç”¨é…ç½®æ–‡ä»¶</h2> <p>å’Œ <a href="https://www.iocoder.cn/Spring-Boot/ActiveMQ/?self#" target="_blank" rel="noopener noreferrer">ã€Œ3.2 åº”ç”¨é…ç½®æ–‡ä»¶ã€<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ä¸€è‡´ï¼Œè§ <a href="https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo-concurrency/src/main/resources/application.yaml" target="_blank" rel="noopener noreferrer"><code>application.yaml</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> æ–‡ä»¶ã€‚</p> <h2 id="_6-3-demo03message"><a href="#_6-3-demo03message" class="header-anchor">#</a> 6.3 Demo03Message</h2> <p>åœ¨ <a href="https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo-concurrency/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/message" target="_blank" rel="noopener noreferrer"><code>cn.iocoder.springboot.lab32.activemqdemo.message</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> åŒ…ä¸‹ï¼Œåˆ›å»º <a href="https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo-concurrency/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/message/Demo03Message.java" target="_blank" rel="noopener noreferrer">Demo03Message<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> æ¶ˆæ¯ç±»ï¼Œæä¾›ç»™å½“å‰ç¤ºä¾‹ä½¿ç”¨ã€‚</p> <p>å’Œ<a href="https://www.iocoder.cn/Spring-Boot/ActiveMQ/?self#" target="_blank" rel="noopener noreferrer">ã€Œ3.4 Demo01Messageã€<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ä¸€è‡´ï¼Œåªæ˜¯ Queue åå­—ä¸åŒã€‚</p> <h2 id="_6-4-demo03producer"><a href="#_6-4-demo03producer" class="header-anchor">#</a> 6.4 Demo03Producer</h2> <p>åœ¨ <a href="https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo-concurrency/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/producer/" target="_blank" rel="noopener noreferrer"><code>cn.iocoder.springboot.lab32.activemqdemo.producer</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> åŒ…ä¸‹ï¼Œåˆ›å»º <a href="https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo-concurrency/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/producer/Demo03Producer.java" target="_blank" rel="noopener noreferrer">Demo03Producer<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ç±»ï¼Œå®ƒä¼šä½¿ç”¨ Spring-JMS å°è£…æä¾›çš„ JmsMessagingTemplate ï¼Œå®ç°å‘é€æ¶ˆæ¯ã€‚</p> <p>å’Œ<a href="https://www.iocoder.cn/Spring-Boot/ActiveMQ/?self#" target="_blank" rel="noopener noreferrer">ã€Œ3.5 Demo01Producerã€<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ä¸€è‡´ï¼Œåªæ˜¯ Queue åå­—ä¸åŒã€‚</p> <h2 id="_6-5-demo03consumer"><a href="#_6-5-demo03consumer" class="header-anchor">#</a> 6.5 Demo03Consumer</h2> <p>åœ¨ <a href="https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo-concurrency/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/consumer/" target="_blank" rel="noopener noreferrer"><code>cn.iocoder.springboot.lab32.activemqdemo.consumer</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> åŒ…ä¸‹ï¼Œåˆ›å»º <a href="https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo-concurrency/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/consumer/Demo03Consumer.java" target="_blank" rel="noopener noreferrer">Demo03Consumer<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ç±»ï¼Œ<strong>å¹¶å‘</strong>æ¶ˆè´¹æ¶ˆæ¯ã€‚ä»£ç å¦‚ä¸‹ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>// Demo03Consumer.java

@Component
public class Demo03Consumer {

    private Logger logger = LoggerFactory.getLogger(getClass());

    @JmsListener(destination = Demo03Message.QUEUE,
        concurrency = &quot;2&quot;)
    public void onMessage(Demo03Message message) {
        logger.info(&quot;[onMessage][çº¿ç¨‹ç¼–å·:{} æ¶ˆæ¯å†…å®¹ï¼š{}]&quot;, Thread.currentThread().getId(), message);
    }

}
</code></pre></div><ul><li>å’Œ<a href="https://www.iocoder.cn/Spring-Boot/ActiveMQ/?self#" target="_blank" rel="noopener noreferrer">ã€Œ3.6 Demo06Consumerã€<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ä¸€è‡´ï¼Œåªå·®åœ¨æ¶ˆè´¹ä¸åŒçš„é˜Ÿåˆ—ã€‚</li> <li>ã€é‡è¦ã€‘å¦å¤–ï¼Œå¯ä»¥é€šè¿‡ <code>@JmsListener</code> æ³¨è§£çš„ <code>concurrency</code> å±æ€§ï¼Œè®¾ç½®å¹¶å‘æ•°ä¸º <strong>2</strong>ã€‚</li></ul> <h2 id="_6-6-ç®€å•æµ‹è¯•"><a href="#_6-6-ç®€å•æµ‹è¯•" class="header-anchor">#</a> 6.6 ç®€å•æµ‹è¯•</h2> <p>åˆ›å»º <a href="https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo-concurrency/src/test/java/cn/iocoder/springboot/lab32/activemqdemo/producer/Demo03ProducerTest.java" target="_blank" rel="noopener noreferrer">Demo03ProducerTest<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> æµ‹è¯•ç±»ï¼Œç¼–å†™ä¸€ä¸ªå•å…ƒæµ‹è¯•æ–¹æ³•ï¼Œå‘é€ 10 æ¡æ¶ˆæ¯ï¼Œè§‚å¯Ÿå¹¶å‘æ¶ˆè´¹æƒ…å†µã€‚ä»£ç å¦‚ä¸‹ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>// Demo03ProducerTest.java

@RunWith(SpringRunner.class)
@SpringBootTest(classes = Application.class)
public class Demo03ProducerTest {

    private Logger logger = LoggerFactory.getLogger(getClass());

    @Autowired
    private Demo03Producer producer;

    @Test
    public void testSyncSend() throws InterruptedException {
        for (int i = 0; i &lt; 10; i++) {
            int id = (int) (System.currentTimeMillis() / 1000);
            producer.syncSend(id);
//            logger.info(&quot;[testSyncSend][å‘é€ç¼–å·ï¼š[{}] å‘é€æˆåŠŸ]&quot;, id);
        }

        // é˜»å¡ç­‰å¾…ï¼Œä¿è¯æ¶ˆè´¹
        new CountDownLatch(1).await();
    }

}
</code></pre></div><p>æ‰§è¡Œå•å…ƒæµ‹è¯•æ–¹æ³•ï¼Œæ§åˆ¶å°è¾“å‡ºå¦‚ä¸‹ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code># çº¿ç¨‹ç¼–å·ä¸º 18
2019-12-15 18:17:13.796  INFO 85887 --- [enerContainer-1] c.i.s.l.a.consumer.Demo03Consumer        : [onMessage][çº¿ç¨‹ç¼–å·:18 æ¶ˆæ¯å†…å®¹ï¼šDemo03Message{id=1576405033}]
2019-12-15 18:17:13.800  INFO 85887 --- [enerContainer-1] c.i.s.l.a.consumer.Demo03Consumer        : [onMessage][çº¿ç¨‹ç¼–å·:18 æ¶ˆæ¯å†…å®¹ï¼šDemo03Message{id=1576405033}]
2019-12-15 18:17:13.802  INFO 85887 --- [enerContainer-1] c.i.s.l.a.consumer.Demo03Consumer        : [onMessage][çº¿ç¨‹ç¼–å·:18 æ¶ˆæ¯å†…å®¹ï¼šDemo03Message{id=1576405033}]
2019-12-15 18:17:13.805  INFO 85887 --- [enerContainer-1] c.i.s.l.a.consumer.Demo03Consumer        : [onMessage][çº¿ç¨‹ç¼–å·:18 æ¶ˆæ¯å†…å®¹ï¼šDemo03Message{id=1576405033}]
2019-12-15 18:17:13.808  INFO 85887 --- [enerContainer-2] c.i.s.l.a.consumer.Demo03Consumer        : [onMessage][çº¿ç¨‹ç¼–å·:21 æ¶ˆæ¯å†…å®¹ï¼šDemo03Message{id=1576405033}]

# çº¿ç¨‹ç¼–å· 18
2019-12-15 18:17:13.796  INFO 85887 --- [enerContainer-2] c.i.s.l.a.consumer.Demo03Consumer        : [onMessage][çº¿ç¨‹ç¼–å·:21 æ¶ˆæ¯å†…å®¹ï¼šDemo03Message{id=1576405033}]
2019-12-15 18:17:13.800  INFO 85887 --- [enerContainer-2] c.i.s.l.a.consumer.Demo03Consumer        : [onMessage][çº¿ç¨‹ç¼–å·:21 æ¶ˆæ¯å†…å®¹ï¼šDemo03Message{id=1576405033}]
2019-12-15 18:17:13.804  INFO 85887 --- [enerContainer-2] c.i.s.l.a.consumer.Demo03Consumer        : [onMessage][çº¿ç¨‹ç¼–å·:21 æ¶ˆæ¯å†…å®¹ï¼šDemo03Message{id=1576405033}]
2019-12-15 18:17:13.807  INFO 85887 --- [enerContainer-1] c.i.s.l.a.consumer.Demo03Consumer        : [onMessage][çº¿ç¨‹ç¼–å·:18 æ¶ˆæ¯å†…å®¹ï¼šDemo03Message{id=1576405033}]
2019-12-15 18:17:13.811  INFO 85887 --- [enerContainer-1] c.i.s.l.a.consumer.Demo03Consumer        : [onMessage][çº¿ç¨‹ç¼–å·:18 æ¶ˆæ¯å†…å®¹ï¼šDemo03Message{id=1576405033}]
</code></pre></div><ul><li>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œä¸¤ä¸ªçº¿ç¨‹åœ¨æ¶ˆè´¹ <code>&quot;QUEUE_DEMO_09&quot;</code> ä¸‹çš„æ¶ˆæ¯ã€‚</li></ul> <p>æ­¤æ—¶ï¼Œå¦‚æœæˆ‘ä»¬ä½¿ç”¨ <a href="https://activemq.apache.org/web-console" target="_blank" rel="noopener noreferrer">ActiveMQ Web Console<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> æ¥æŸ¥çœ‹ <code>&quot;QUEUE_DEMO_03&quot;</code> çš„æ¶ˆè´¹è€…åˆ—è¡¨ï¼š</p> <p><img src="https://raw.githubusercontent.com/lichengcan/images/main/image-20231214143837954.png" alt=""></p> <h1 id="_7-é¡ºåºæ¶ˆæ¯"><a href="#_7-é¡ºåºæ¶ˆæ¯" class="header-anchor">#</a> 7. é¡ºåºæ¶ˆæ¯</h1> <blockquote><p>ç¤ºä¾‹ä»£ç å¯¹åº”ä»“åº“ï¼š<a href="https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo-orderly" target="_blank" rel="noopener noreferrer">lab-32-activemq-demo-orderly<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <p>æˆ‘ä»¬å…ˆæ¥ä¸€èµ·äº†è§£ä¸‹é¡ºåºæ¶ˆæ¯çš„<strong>é¡ºåºæ¶ˆæ¯</strong>çš„å®šä¹‰ï¼š</p> <ul><li>æ™®é€šé¡ºåºæ¶ˆæ¯ ï¼šProducer å°†ç›¸å…³è”çš„æ¶ˆæ¯å‘é€åˆ°ç›¸åŒçš„æ¶ˆæ¯é˜Ÿåˆ—ã€‚</li> <li>å®Œå…¨ä¸¥æ ¼é¡ºåº ï¼šåœ¨ã€æ™®é€šé¡ºåºæ¶ˆæ¯ã€‘çš„åŸºç¡€ä¸Šï¼ŒConsumer ä¸¥æ ¼é¡ºåºæ¶ˆè´¹ã€‚</li></ul> <p>é‚£ä¹ˆï¼Œè®©æˆ‘ä»¬æ¥æ€è€ƒä¸‹ï¼Œå¦‚æœæˆ‘ä»¬å¸Œæœ›åœ¨ ActiveMQ ä¸Šï¼Œå®ç°é¡ºåºæ¶ˆæ¯éœ€è¦åšä¸¤ä¸ªäº‹æƒ…ã€‚</p> <p>â‘  <strong>äº‹æƒ…ä¸€</strong>ï¼Œæˆ‘ä»¬éœ€è¦ä¿è¯ ActiveMQ Producer å‘é€ç›¸å…³è”çš„æ¶ˆæ¯å‘é€åˆ°ç›¸åŒçš„ Queue ä¸­ã€‚ä¾‹å¦‚è¯´ï¼Œæˆ‘ä»¬è¦å‘é€ç”¨æˆ·ä¿¡æ¯å‘ç”Ÿå˜æ›´çš„ Message ï¼Œé‚£ä¹ˆå¦‚æœæˆ‘ä»¬å¸Œæœ›ä½¿ç”¨é¡ºåºæ¶ˆæ¯çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥å°†<strong>ç”¨æˆ·ç¼–å·</strong>ç›¸åŒçš„æ¶ˆæ¯å‘é€åˆ°ç›¸åŒçš„ Queue ä¸­ã€‚</p> <p>â‘¡ <strong>äº‹æƒ…äºŒ</strong>ï¼Œæˆ‘ä»¬åœ¨æœ‰<strong>ä¸”ä»…å¯åŠ¨ä¸€ä¸ª</strong> Consumer æ¶ˆè´¹è¯¥é˜Ÿåˆ—ï¼Œä¿è¯ Consumer ä¸¥æ ¼é¡ºåºæ¶ˆè´¹ã€‚</p> <p>ä¸è¿‡å¦‚æœè¿™æ ·åšï¼Œä¼šå­˜åœ¨ä¸¤ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬é€ä¸ªæ¥çœ‹çœ‹ã€‚</p> <p>â‘  <strong>é—®é¢˜ä¸€</strong>ï¼Œæ­£å¦‚æˆ‘ä»¬åœ¨<a href="https://www.iocoder.cn/Spring-Boot/ActiveMQ/?self#" target="_blank" rel="noopener noreferrer">ã€Œ6. å¹¶å‘æ¶ˆè´¹ã€<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ä¸­æåˆ°ï¼Œå¦‚æœæˆ‘ä»¬å°†æ¶ˆæ¯ä»…ä»…æŠ•é€’åˆ°ä¸€ä¸ª Queue ä¸­ï¼Œå¹¶ä¸”é‡‡ç”¨å•ä¸ª Consumer <strong>ä¸²è¡Œ</strong>æ¶ˆè´¹ï¼Œåœ¨ç›‘å¬çš„ Queue æ¯ç§’æ¶ˆæ¯é‡æ¯”è¾ƒå¤§çš„æ—¶å€™ï¼Œä¼šå¯¼è‡´æ¶ˆè´¹ä¸åŠæ—¶ï¼Œå¯¼è‡´æ¶ˆæ¯ç§¯å‹çš„é—®é¢˜ã€‚</p> <p>æ­¤æ—¶ï¼Œæˆ‘ä»¬æœ‰ä¸¤ç§æ–¹æ¡ˆæ¥è§£å†³ï¼š</p> <ul><li>æ–¹æ¡ˆä¸€ï¼Œåœ¨ Producer ç«¯ï¼Œå°† Queue æ‹†æˆå¤šä¸ª<strong>å­</strong> Queue ã€‚å‡è®¾åŸå…ˆ Queue æ˜¯ <code>QUEUE_USER</code> ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±åˆ†æ‹†æˆ <code>QUEUE_USER_00</code> è‡³ <code>QUEUE_USER_..${N-1}</code> è¿™æ · N ä¸ªé˜Ÿåˆ—ï¼Œç„¶ååŸºäºæ¶ˆæ¯çš„ç”¨æˆ·ç¼–å·å–ä½™ï¼Œè·¯ç”±åˆ°å¯¹åº”çš„<strong>å­</strong> Queue ä¸­ã€‚</li> <li>æ–¹æ¡ˆäºŒï¼Œåœ¨ Consumer ç«¯ï¼Œå°† Queue æ‹‰å–åˆ°çš„æ¶ˆæ¯ï¼Œå°†ç›¸å…³è”çš„æ¶ˆæ¯å‘é€åˆ°<strong>ç›¸åŒçš„çº¿ç¨‹</strong>ä¸­æ¥æ¶ˆè´¹ã€‚ä¾‹å¦‚è¯´ï¼Œè¿˜æ˜¯ Queue æ˜¯ <code>QUEUE_USER</code> çš„ä¾‹å­ï¼Œæˆ‘ä»¬åˆ›å»º N ä¸ªçº¿ç¨‹æ± å¤§å°ä¸º 1 çš„ <a href="https://github.com/JetBrains/jdk8u_jdk/blob/master/src/share/classes/java/util/concurrent/ExecutorService.java" target="_blank" rel="noopener noreferrer">ExecutorService<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> æ•°ç»„ï¼Œç„¶ååŸºäºæ¶ˆæ¯çš„ç”¨æˆ·ç¼–å·å–ä½™ï¼Œæäº¤åˆ°å¯¹åº”çš„ ExecutorService ä¸­çš„å•ä¸ªçº¿ç¨‹æ¥æ‰§è¡Œã€‚</li></ul> <p>ä¸¤ä¸ªæ–¹æ¡ˆï¼Œå¹¶ä¸å†²çªï¼Œå¯ä»¥ç»“åˆä½¿ç”¨ã€‚</p> <p>â‘¡ <strong>é—®é¢˜äºŒ</strong>ï¼Œå¦‚æœæˆ‘ä»¬å¯åŠ¨ç›¸åŒ Consumer çš„<strong>å¤šä¸ªè¿›ç¨‹</strong>ï¼Œä¼šå¯¼è‡´ç›¸åŒ Queue çš„æ¶ˆæ¯è¢«åˆ†é…åˆ°å¤šä¸ª Consumer è¿›è¡Œæ¶ˆè´¹ï¼Œç ´å Consumer ä¸¥æ ¼é¡ºåºæ¶ˆè´¹ã€‚</p> <p>æ­¤æ—¶ï¼Œæˆ‘ä»¬æœ‰ä¸¤ç§æ–¹æ¡ˆæ¥è§£å†³ï¼š</p> <ul><li>æ–¹æ¡ˆä¸€ï¼Œå¼•å…¥ Zookeeper æ¥åè°ƒï¼ŒåŠ¨æ€è®¾ç½®å¤šä¸ªè¿›ç¨‹ä¸­çš„<strong>ç›¸åŒçš„</strong> Consumer çš„å¼€å…³ï¼Œä¿è¯æœ‰ä¸”ä»…æœ‰ä¸€ä¸ª Consumer å¼€å¯å¯¹<strong>åŒä¸€ä¸ª</strong> Queue çš„æ¶ˆè´¹ã€‚</li> <li>æ–¹æ¡ˆäºŒï¼Œä»…é€‚ç”¨äºã€é—®é¢˜ä¸€ã€‘çš„ã€æ–¹æ¡ˆä¸€ã€‘ã€‚è¿˜æ˜¯å¼•å…¥ Zookeeper æ¥åè°ƒï¼ŒåŠ¨æ€è®¾ç½®å¤šä¸ªè¿›ç¨‹ä¸­çš„<strong>ç›¸åŒçš„</strong> Consumer æ¶ˆè´¹çš„ Queue çš„åˆ†é…ï¼Œä¿è¯æœ‰ä¸”ä»…æœ‰ä¸€ä¸ª Consumer å¼€å¯å¯¹<strong>åŒä¸€ä¸ª</strong> Queue çš„æ¶ˆè´¹ã€‚</li></ul> <p>ä¸‹é¢ï¼Œæˆ‘ä»¬å¼€å§‹æœ¬å°èŠ‚çš„ç¤ºä¾‹ã€‚æœ¬ç¤ºä¾‹å°±æ˜¯ä¸Šè¿°ä¸¾ä¾‹çš„å…·ä½“å®ç°ã€‚è€ƒè™‘åˆ°ä¸æ±¡æŸ“ä¸Šè¿°çš„ç¤ºä¾‹ï¼Œæˆ‘ä»¬æ–°å»ºä¸€ä¸ª <a href="https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo-orderly" target="_blank" rel="noopener noreferrer">lab-32-activemq-demo-orderly<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> é¡¹ç›®ã€‚</p> <ul><li>å¯¹äºé—®é¢˜ä¸€ï¼Œæˆ‘ä»¬é‡‡ç”¨æ–¹æ¡ˆä¸€ã€‚å› ä¸ºåœ¨ Spring-JMS ä¸­ï¼Œè‡ªå·±å®šä¹‰çº¿ç¨‹æ¥æ¶ˆè´¹æ¶ˆæ¯ï¼Œæ— æ³•å’Œç°æœ‰çš„ <a href="https://github.com/spring-projects/spring-framework/blob/master/spring-jms/src/main/java/org/springframework/jms/listener/DefaultMessageListenerContainer.java" target="_blank" rel="noopener noreferrer">DefaultMessageListenerContainer<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> çš„å®ç°æ‰€ç»“åˆï¼Œé™¤éè‡ªå®šä¹‰ä¸€ä¸ª MessageListenerContainer å®ç°ç±»ã€‚</li> <li>å¯¹äºé—®é¢˜äºŒï¼Œå› ä¸ºå®ç°èµ·æ¥æ¯”è¾ƒå¤æ‚ï¼Œæš‚æ—¶å…ˆä¸æä¾›ã€‚</li></ul> <h2 id="_7-1-å¼•å…¥ä¾èµ–"><a href="#_7-1-å¼•å…¥ä¾èµ–" class="header-anchor">#</a> 7.1 å¼•å…¥ä¾èµ–</h2> <p>å’Œ <a href="https://www.iocoder.cn/Spring-Boot/ActiveMQ/?self#" target="_blank" rel="noopener noreferrer">ã€Œ3.1 å¼•å…¥ä¾èµ–ã€<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ä¸€è‡´ï¼Œè§ <a href="https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo-orderly/pom.xml" target="_blank" rel="noopener noreferrer"><code>pom.xml</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> æ–‡ä»¶ã€‚</p> <h2 id="_7-2-åº”ç”¨é…ç½®æ–‡ä»¶"><a href="#_7-2-åº”ç”¨é…ç½®æ–‡ä»¶" class="header-anchor">#</a> 7.2 åº”ç”¨é…ç½®æ–‡ä»¶</h2> <p>å’Œ <a href="https://www.iocoder.cn/Spring-Boot/ActiveMQ/?self#" target="_blank" rel="noopener noreferrer">ã€Œ3.2 åº”ç”¨é…ç½®æ–‡ä»¶ã€<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ä¸€è‡´ï¼Œè§ <a href="https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo-orderly/src/main/resources/application.yaml" target="_blank" rel="noopener noreferrer"><code>application.yaml</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> æ–‡ä»¶ã€‚</p> <h2 id="_7-3-demo04message"><a href="#_7-3-demo04message" class="header-anchor">#</a> 7.3 Demo04Message</h2> <p>åœ¨ <a href="https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo-message-model/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/message/" target="_blank" rel="noopener noreferrer"><code>cn.iocoder.springboot.lab32.activemqdemo.message</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> åŒ…ä¸‹ï¼Œåˆ›å»º <a href="https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo-orderly/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/message/Demo04Message.java" target="_blank" rel="noopener noreferrer">Demo04Message<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> æ¶ˆæ¯ç±»ï¼Œæä¾›ç»™å½“å‰ç¤ºä¾‹ä½¿ç”¨ã€‚ä»£ç å¦‚ä¸‹ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>// Demo04Message.java

public class Demo04Message implements Serializable {

    public static final String QUEUE_BASE = &quot;QUEUE_DEMO_04-&quot;;
    public static final String QUEUE_0 = QUEUE_BASE + &quot;0&quot;;
    public static final String QUEUE_1 = QUEUE_BASE + &quot;1&quot;;
    public static final String QUEUE_2 = QUEUE_BASE + &quot;2&quot;;
    public static final String QUEUE_3 = QUEUE_BASE + &quot;3&quot;;

    public static final int QUEUE_COUNT = 4;

    /**
     * ç¼–å·
     */
    private Integer id;

    // ... çœç•¥ set/get/toString æ–¹æ³•

}
</code></pre></div><ul><li>å®šä¹‰äº† <code>QUEUE_DEMO_04-</code> çš„å››ä¸ª<strong>å­</strong> Queue ã€‚</li></ul> <h2 id="_7-4-demo04producer"><a href="#_7-4-demo04producer" class="header-anchor">#</a> 7.4 Demo04Producer</h2> <p>åœ¨ <a href="https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo-orderly/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/producer" target="_blank" rel="noopener noreferrer"><code>cn.iocoder.springboot.lab32.activemqdemo.producer</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> åŒ…ä¸‹ï¼Œåˆ›å»º <a href="https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo-orderly/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/producer/Demo04Producer.java" target="_blank" rel="noopener noreferrer">Demo04Producer<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ç±»ï¼Œå®ƒä¼šä½¿ç”¨ Spring-JMS å°è£…æä¾›çš„ JmsMessagingTemplate ï¼Œå®ç°å‘é€æ¶ˆæ¯åˆ°<strong>å­</strong> Queue ä¸­ã€‚ä»£ç å¦‚ä¸‹ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>// Demo04Producer.java

@Component
public class Demo04Producer {

    @Autowired
    private JmsMessagingTemplate jmsTemplate;

    public void syncSend(Integer id) {
        // åˆ›å»º Demo04Message æ¶ˆæ¯
        Demo04Message message = new Demo04Message();
        message.setId(id);
        // åŒæ­¥å‘é€æ¶ˆæ¯
        jmsTemplate.convertAndSend(this.getQueue(id), message);
    }

    private String getQueue(Integer id) {
        return Demo04Message.QUEUE_BASE + (id % Demo04Message.QUEUE_COUNT);
    }

}
</code></pre></div><ul><li>å‘é€æ¶ˆæ¯æ—¶ï¼Œæˆ‘ä»¬å¯¹ <code>Demo04Message.id % é˜Ÿåˆ—ç¼–å·</code> è¿›è¡Œå–ä½™ï¼Œè·å¾—<strong>é˜Ÿåˆ—ç¼–å·</strong>ä½œä¸º Queue åç¼€ï¼Œä»è€Œè·å¾—åˆ°å¯¹åº”çš„<strong>å­</strong> Queue ä¸­ã€‚</li></ul> <h2 id="_7-5-demo04consumer"><a href="#_7-5-demo04consumer" class="header-anchor">#</a> 7.5 Demo04Consumer</h2> <p>åœ¨ <a href="https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo-orderly/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/consumer" target="_blank" rel="noopener noreferrer"><code>cn.iocoder.springboot.lab32.activemqdemo.consumer</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> åŒ…ä¸‹ï¼Œåˆ›å»º <a href="https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo-orderly/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/consumer/Demo04Consumer.java" target="_blank" rel="noopener noreferrer">Demo04Consumer<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ç±»ï¼Œ<strong>ä¸¥æ ¼</strong>æ¶ˆè´¹<strong>é¡ºåº</strong>æ¶ˆæ¯ã€‚ä»£ç å¦‚ä¸‹ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>// Demo04Consumer.java

@Component
public class Demo04Consumer {

    private Logger logger = LoggerFactory.getLogger(getClass());

    @JmsListener(destination = Demo04Message.QUEUE_0)
    @JmsListener(destination = Demo04Message.QUEUE_1)
    @JmsListener(destination = Demo04Message.QUEUE_2)
    @JmsListener(destination = Demo04Message.QUEUE_3)
    public void onMessage(Demo04Message message) {
        logger.info(&quot;[onMessage][çº¿ç¨‹ç¼–å·:{} æ¶ˆæ¯å†…å®¹ï¼š{}]&quot;, Thread.currentThread().getId(), message);
    }

}
</code></pre></div><ul><li>ä¸ºäº†å®ç°æ¯ä¸ª<strong>å­</strong> Queue èƒ½å¤Ÿè¢«æ¯ä¸ª Consumer <strong>ä¸²è¡Œ</strong>æ¶ˆè´¹ï¼Œä»è€Œå®ç°åŸºäº<strong>å­</strong> Queue çš„<strong>å¹¶è¡Œ</strong>çš„<strong>ä¸¥æ ¼</strong>æ¶ˆè´¹<strong>é¡ºåº</strong>æ¶ˆæ¯ï¼Œæˆ‘ä»¬åªå¥½åœ¨ç±»ä¸Šæ·»äº†å››ä¸ª <code>@JmsListener</code> æ³¨è§£ï¼Œæ¯ä¸ªå¯¹åº”ä¸€ä¸ª<strong>å­</strong> Queue ã€‚</li> <li>å¦‚æœèƒ–å‹ä½¿ç”¨ä¸€ä¸ª <code>@JmsListener</code> æ³¨è§£ï¼Œå¹¶æ·»åŠ å››ä¸ª<strong>å­</strong> Queue ï¼Œç„¶åè®¾ç½® <code>concurrency = 4</code> æ—¶ï¼Œå®é™…æ˜¯å¹¶å‘å››ä¸ªçº¿ç¨‹ï¼Œæ¶ˆè´¹å››ä¸ª<strong>å­</strong> Queue çš„æ¶ˆæ¯ï¼Œæ— æ³•ä¿è¯<strong>ä¸¥æ ¼</strong>æ¶ˆè´¹<strong>é¡ºåº</strong>æ¶ˆæ¯ã€‚</li></ul> <h2 id="_7-6-ç®€å•æµ‹è¯•"><a href="#_7-6-ç®€å•æµ‹è¯•" class="header-anchor">#</a> 7.6 ç®€å•æµ‹è¯•</h2> <p>åˆ›å»º <a href="https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo-orderly/src/test/java/cn/iocoder/springboot/lab32/activemqdemo/producer/Demo04ProducerTest.java" target="_blank" rel="noopener noreferrer">Demo04ProducerTest<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> æµ‹è¯•ç±»ï¼Œç¼–å†™ä¸€ä¸ªå•å…ƒæµ‹è¯•æ–¹æ³•ï¼Œå‘é€ 8 æ¡æ¶ˆæ¯ï¼Œè§‚å¯Ÿé¡ºåºæ¶ˆè´¹æƒ…å†µã€‚ä»£ç å¦‚ä¸‹ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>// Demo04ProducerTest.java

@RunWith(SpringRunner.class)
@SpringBootTest(classes = Application.class)
public class Demo04ProducerTest {

    private Logger logger = LoggerFactory.getLogger(getClass());

    @Autowired
    private Demo04Producer producer;

    @Test
    public void testSyncSend() throws InterruptedException {
        for (int i = 0; i &lt; 2; i++) {
            for (int id = 0; id &lt; 4; id++) {
                producer.syncSend(id);
//                logger.info(&quot;[testSyncSend][å‘é€ç¼–å·ï¼š[{}] å‘é€æˆåŠŸ]&quot;, id);
            }
        }

        // é˜»å¡ç­‰å¾…ï¼Œä¿è¯æ¶ˆè´¹
        new CountDownLatch(1).await();
    }

}
</code></pre></div><ul><li>å‘é€ 2 è½®æ¶ˆæ¯ï¼Œæ¯ä¸€è½®æ¶ˆæ¯çš„ç¼–å·éƒ½æ˜¯ 0 è‡³ 3 ã€‚</li></ul> <p>æ‰§è¡Œå•å…ƒæµ‹è¯•æ–¹æ³•ï¼Œæ§åˆ¶å°è¾“å‡ºå¦‚ä¸‹ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code># çº¿ç¨‹ç¼–å·ä¸º 21
2019-12-15 21:44:05.582  INFO 90457 --- [enerContainer-1] c.i.s.l.a.consumer.Demo04Consumer        : [onMessage][çº¿ç¨‹ç¼–å·:21 æ¶ˆæ¯å†…å®¹ï¼šDemo04Message{id=0}]
2019-12-15 21:44:05.599  INFO 90457 --- [enerContainer-1] c.i.s.l.a.consumer.Demo04Consumer        : [onMessage][çº¿ç¨‹ç¼–å·:21 æ¶ˆæ¯å†…å®¹ï¼šDemo04Message{id=0}]

# çº¿ç¨‹ç¼–å·ä¸º 18
2019-12-15 21:44:05.591  INFO 90457 --- [enerContainer-1] c.i.s.l.a.consumer.Demo04Consumer        : [onMessage][çº¿ç¨‹ç¼–å·:18 æ¶ˆæ¯å†…å®¹ï¼šDemo04Message{id=2}]
2019-12-15 21:44:05.605  INFO 90457 --- [enerContainer-1] c.i.s.l.a.consumer.Demo04Consumer        : [onMessage][çº¿ç¨‹ç¼–å·:18 æ¶ˆæ¯å†…å®¹ï¼šDemo04Message{id=2}]

# çº¿ç¨‹ç¼–å·ä¸º 20
2019-12-15 21:44:05.597  INFO 90457 --- [enerContainer-1] c.i.s.l.a.consumer.Demo04Consumer        : [onMessage][çº¿ç¨‹ç¼–å·:20 æ¶ˆæ¯å†…å®¹ï¼šDemo04Message{id=3}
2019-12-15 21:44:05.606  INFO 90457 --- [enerContainer-1] c.i.s.l.a.consumer.Demo04Consumer        : [onMessage][çº¿ç¨‹ç¼–å·:20 æ¶ˆæ¯å†…å®¹ï¼šDemo04Message{id=3}]

# çº¿ç¨‹ç¼–å·ä¸º 19
2019-12-15 21:44:05.583  INFO 90457 --- [enerContainer-1] c.i.s.l.a.consumer.Demo04Consumer        : [onMessage][çº¿ç¨‹ç¼–å·:19 æ¶ˆæ¯å†…å®¹ï¼šDemo04Message{id=1}]
2019-12-15 21:44:05.602  INFO 90457 --- [enerContainer-1] c.i.s.l.a.consumer.Demo04Consumer        : [onMessage][çº¿ç¨‹ç¼–å·:19 æ¶ˆæ¯å†…å®¹ï¼šDemo04Message{id=1}]
</code></pre></div><ul><li>ç›¸åŒç¼–å·çš„æ¶ˆæ¯ï¼Œè¢«æŠ•é€’åˆ°ç›¸åŒçš„<strong>å­</strong> Queue ï¼Œè¢«ç›¸åŒçš„çº¿ç¨‹æ‰€æ¶ˆè´¹ã€‚ç¬¦åˆé¢„æœŸ~</li></ul> <h1 id="_8-æ¶ˆè´¹é‡è¯•"><a href="#_8-æ¶ˆè´¹é‡è¯•" class="header-anchor">#</a> 8. æ¶ˆè´¹é‡è¯•</h1> <blockquote><p>ç¤ºä¾‹ä»£ç å¯¹åº”ä»“åº“ï¼š<a href="https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo-consume-retry" target="_blank" rel="noopener noreferrer">lab-32-activemq-demo-consume-retry<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <p>åœ¨æ¶ˆæ¯<strong>æ¶ˆè´¹å¤±è´¥</strong>çš„æ—¶å€™ï¼ŒActiveMQ ä¼šé€šè¿‡<strong>è‡ªå¸¦çš„</strong> <a href="https://activemq.apache.org/message-redelivery-and-dlq-handling" target="_blank" rel="noopener noreferrer">ReDelivery(é‡æ–°æŠ•é€’)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> æœºåˆ¶ï¼Œé‡æ–°æŠ•é€’è¯¥æ¶ˆæ¯ç»™ Consumer ï¼Œè®© Consumer æœ‰æœºä¼šé‡æ–°æ¶ˆè´¹æ¶ˆæ¯ï¼Œå®ç°æ¶ˆè´¹æˆåŠŸã€‚</p> <p>å½“ç„¶ï¼ŒActiveMQ å¹¶ä¸ä¼šæ— é™é‡æ–°æŠ•é€’æ¶ˆæ¯ç»™ Consumer é‡æ–°æ¶ˆè´¹ï¼Œè€Œæ˜¯åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œè¾¾åˆ° N æ¬¡é‡è¯•æ¬¡æ•°æ—¶ï¼ŒConsumer è¿˜æ˜¯æ¶ˆè´¹å¤±è´¥æ—¶ï¼Œè¯¥æ¶ˆæ¯å°±ä¼šè¿›å…¥åˆ°<strong>æ­»ä¿¡é˜Ÿåˆ—</strong>(é»˜è®¤ä¸º <code>&quot;ActiveMQ.DLQ&quot;</code> é˜Ÿåˆ—)ã€‚åç»­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å¯¹æ­»ä¿¡é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯è¿›è¡Œé‡å‘ï¼Œæ¥ä½¿å¾—æ¶ˆè´¹è€…å®ä¾‹å†æ¬¡è¿›è¡Œæ¶ˆè´¹ã€‚</p> <p>å¦å¤–ï¼Œæ¯æ¡æ¶ˆæ¯çš„å¤±è´¥é‡è¯•ï¼Œæ˜¯å¯ä»¥é…ç½®ä¸€å®šçš„<strong>é—´éš”æ—¶é—´</strong>ã€‚å…·ä½“ï¼Œæˆ‘ä»¬åœ¨ç¤ºä¾‹çš„ä»£ç ä¸­ï¼Œæ¥è¿›è¡Œå…·ä½“çš„è§£é‡Šã€‚</p> <p>ä¸‹é¢ï¼Œæˆ‘ä»¬æ¥å®ç°ä¸€ä¸ª Consumer æ¶ˆè´¹é‡è¯•çš„ç¤ºä¾‹ã€‚è€ƒè™‘åˆ°ä¸æ±¡æŸ“ä¸Šè¿°çš„ç¤ºä¾‹ï¼Œæˆ‘ä»¬æ–°å»ºä¸€ä¸ª <a href="https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo-consume-retry" target="_blank" rel="noopener noreferrer">lab-32-activemq-demo-consume-retry<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> é¡¹ç›®ã€‚</p> <h2 id="_8-1-å¼•å…¥ä¾èµ–"><a href="#_8-1-å¼•å…¥ä¾èµ–" class="header-anchor">#</a> 8.1 å¼•å…¥ä¾èµ–</h2> <p>å’Œ <a href="https://www.iocoder.cn/Spring-Boot/ActiveMQ/?self#" target="_blank" rel="noopener noreferrer">ã€Œ3.1 å¼•å…¥ä¾èµ–ã€<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ä¸€è‡´ï¼Œè§ <a href="https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo-consume-retry/pom.xml" target="_blank" rel="noopener noreferrer"><code>pom.xml</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> æ–‡ä»¶ã€‚</p> <h2 id="_8-2-åº”ç”¨é…ç½®æ–‡ä»¶"><a href="#_8-2-åº”ç”¨é…ç½®æ–‡ä»¶" class="header-anchor">#</a> 8.2 åº”ç”¨é…ç½®æ–‡ä»¶</h2> <p>å’Œ <a href="https://www.iocoder.cn/Spring-Boot/ActiveMQ/?self#" target="_blank" rel="noopener noreferrer">ã€Œ3.1.2 åº”ç”¨é…ç½®æ–‡ä»¶ã€<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ä¸€è‡´ï¼Œè§ <a href="https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo-consume-retry/src/main/resources/application.yaml" target="_blank" rel="noopener noreferrer"><code>application.yaml</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> æ–‡ä»¶ã€‚</p> <h2 id="_8-3-activemqconfig"><a href="#_8-3-activemqconfig" class="header-anchor">#</a> 8.3 ActiveMQConfig</h2> <p>åœ¨ <a href="https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo-consume-retry/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/config" target="_blank" rel="noopener noreferrer"><code>cn.iocoder.springboot.lab32.activemqdemo.config</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> åŒ…ä¸‹ï¼Œåˆ›å»º <a href="https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo-consume-retry/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/config/ActiveMQConfig.java" target="_blank" rel="noopener noreferrer">ActiveMQConfig<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ç±»ï¼Œå®ç° <a href="https://github.com/spring-projects/spring-boot/blob/master/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/jms/activemq/ActiveMQConnectionFactoryCustomizer.java" target="_blank" rel="noopener noreferrer">ActiveMQConnectionFactoryCustomizer<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> æ¥å£ï¼Œå¯ä»¥å¯¹ Spring Boot è‡ªåŠ¨åˆ›å»ºçš„ <a href="https://github.com/apache/activemq/blob/master/activemq-client/src/main/java/org/apache/activemq/ActiveMQConnectionFactory.java" target="_blank" rel="noopener noreferrer">ActiveMQConnectionFactory<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> è¿›è¡Œ<strong>è‡ªå®šä¹‰é…ç½®</strong>ã€‚ä»£ç å¦‚ä¸‹ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>// ActiveMQConfig.java

@Configuration
public class ActiveMQConfig implements ActiveMQConnectionFactoryCustomizer {

    private Logger logger = LoggerFactory.getLogger(getClass());

    @Override
    public void customize(ActiveMQConnectionFactory factory) {
        logger.info(&quot;[customize][é»˜è®¤é‡è¯•ç­–ç•¥: {}]&quot;, factory.getRedeliveryPolicy());
    }

}
</code></pre></div><ul><li><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œå·²ç»å¼€å¯ ActiveMQ ReDelivery æœºåˆ¶ã€‚è¿™é‡Œï¼Œæˆ‘ä»¬å…ˆæ‰“å°ä¸‹é»˜è®¤çš„ <a href="https://github.com/apache/activemq/blob/master/activemq-client/src/main/java/org/apache/activemq/RedeliveryPolicy.java" target="_blank" rel="noopener noreferrer">RedeliveryPolicy<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> é‡æŠ•ç­–ç•¥ã€‚å¦‚ä¸‹ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>2019-12-15 23:01:41.406  INFO 93850 --- [           main] QConfig$$EnhancerBySpringCGLIB$$13367ef1 : [customize][é»˜è®¤é‡è¯•ç­–ç•¥: RedeliveryPolicy {destination = null, collisionAvoidanceFactor = 0.15, maximumRedeliveries = 6, maximumRedeliveryDelay = -1, initialRedeliveryDelay = 1000, useCollisionAvoidance = false, useExponentialBackOff = false, backOffMultiplier = 5.0, redeliveryDelay = 1000, preDispatchCheck = true}]
</code></pre></div><ul><li>é»˜è®¤é‡æŠ• 6 æ¬¡ï¼Œæ¯æ¬¡é—´éš” 1000 æ¯«ç§’ã€‚</li></ul></li> <li><p>å¦‚æœèƒ–å‹æƒ³è¦åˆ›å»º RedeliveryPolicy å¯¹è±¡ï¼Œè‡ªå®šä¹‰é‡æŠ•ç­–ç•¥ã€‚æ›´å¤šå¯ä»¥å‚è€ƒ <a href="https://activemq.apache.org/redelivery-policy" target="_blank" rel="noopener noreferrer">ã€ŠActiveMQ æ–‡æ¡£ â€”â€” Redelivery Policyã€‹<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ã€‚</p></li></ul> <h2 id="_8-4-demo05message"><a href="#_8-4-demo05message" class="header-anchor">#</a> 8.4 Demo05Message</h2> <p>åœ¨ <a href="https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo-consume-retry/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/message" target="_blank" rel="noopener noreferrer"><code>cn.iocoder.springboot.lab32.activemqdemo.message</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> åŒ…ä¸‹ï¼Œåˆ›å»º <a href="https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo-consume-retry/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/message/Demo05Message.java" target="_blank" rel="noopener noreferrer">Demo05Message<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> æ¶ˆæ¯ç±»ï¼Œæä¾›ç»™å½“å‰ç¤ºä¾‹ä½¿ç”¨ã€‚</p> <p>å’Œ<a href="https://www.iocoder.cn/Spring-Boot/ActiveMQ/?self#" target="_blank" rel="noopener noreferrer">ã€Œ3.4 Demo01Messageã€<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ä¸€è‡´ï¼Œåªæ˜¯ Queue åå­—ä¸åŒã€‚</p> <h2 id="_8-5-demo05producer"><a href="#_8-5-demo05producer" class="header-anchor">#</a> 8.5 Demo05Producer</h2> <p>åœ¨ <a href="https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo-consume-retry/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/producer" target="_blank" rel="noopener noreferrer"><code>cn.iocoder.springboot.lab32.activemqdemo.producer</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> åŒ…ä¸‹ï¼Œåˆ›å»º <a href="https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo-consume-retry/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/producer/Demo05Producer.java" target="_blank" rel="noopener noreferrer">Demo05Producer<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ç±»ï¼Œå®ƒä¼šä½¿ç”¨ Spring-JMS å°è£…æä¾›çš„ JmsMessagingTemplate ï¼Œå®ç°å‘é€æ¶ˆæ¯ã€‚</p> <p>å’Œ<a href="https://www.iocoder.cn/Spring-Boot/ActiveMQ/?self#" target="_blank" rel="noopener noreferrer">ã€Œ3.5 Demo01Producerã€<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ä¸€è‡´ï¼Œåªæ˜¯ Queue åå­—ä¸åŒã€‚</p> <h2 id="_8-6-demo05consumer"><a href="#_8-6-demo05consumer" class="header-anchor">#</a> 8.6 Demo05Consumer</h2> <p>åœ¨ <a href="https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo-consume-retry/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/consumer" target="_blank" rel="noopener noreferrer"><code>cn.iocoder.springboot.lab32.activemqdemo.consumer</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> åŒ…ä¸‹ï¼Œåˆ›å»º <a href="https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo-consume-retry/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/consumer/Demo05Consumer.java" target="_blank" rel="noopener noreferrer">Demo05Consumer<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ç±»ï¼Œæ¶ˆè´¹æ¶ˆæ¯ã€‚ä»£ç å¦‚ä¸‹ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>// Demo05Consumer.java

@Component
public class Demo05Consumer {

    private Logger logger = LoggerFactory.getLogger(getClass());

    @JmsListener(destination = Demo05Message.QUEUE)
    public void onMessage(Demo05Message message) {
        logger.info(&quot;[onMessage][çº¿ç¨‹ç¼–å·:{} æ¶ˆæ¯å†…å®¹ï¼š{}]&quot;, Thread.currentThread().getId(), message);
        // &lt;X&gt; æ³¨æ„ï¼Œæ­¤å¤„æŠ›å‡ºä¸€ä¸ª RuntimeException å¼‚å¸¸ï¼Œæ¨¡æ‹Ÿæ¶ˆè´¹å¤±è´¥
        throw new RuntimeException(&quot;æˆ‘å°±æ˜¯æ•…æ„æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸&quot;);
    }

}
</code></pre></div><ul><li>åœ¨ <code>&lt;X&gt;</code> å¤„ï¼Œæˆ‘ä»¬åœ¨æ¶ˆè´¹æ¶ˆæ¯æ—¶å€™ï¼ŒæŠ›å‡ºä¸€ä¸ª RuntimeException å¼‚å¸¸ï¼Œæ¨¡æ‹Ÿæ¶ˆè´¹å¤±è´¥ã€‚</li></ul> <h2 id="_8-7-ç®€å•æµ‹è¯•"><a href="#_8-7-ç®€å•æµ‹è¯•" class="header-anchor">#</a> 8.7 ç®€å•æµ‹è¯•</h2> <p>åˆ›å»º <a href="https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo-consume-retry/src/test/java/cn/iocoder/springboot/lab32/activemqdemo/producer/Demo05ProducerTest.java" target="_blank" rel="noopener noreferrer">Demo05ProducerTest<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> æµ‹è¯•ç±»ï¼Œç¼–å†™å•å…ƒæµ‹è¯•æ–¹æ³•ï¼Œæµ‹è¯•<strong>æ¶ˆè´¹é‡è¯•</strong>çš„æ•ˆæœã€‚ä»£ç å¦‚ä¸‹ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>// Demo05ProducerTest.java

@RunWith(SpringRunner.class)
@SpringBootTest(classes = Application.class)
public class Demo05ProducerTest {

    private Logger logger = LoggerFactory.getLogger(getClass());

    @Autowired
    private Demo05Producer producer;

    @Test
    public void testSyncSend() throws InterruptedException {
        // å‘é€æ¶ˆæ¯
        int id = (int) (System.currentTimeMillis() / 1000);
        producer.syncSend(id);
        logger.info(&quot;[testSyncSend][å‘é€ç¼–å·ï¼š[{}] å‘é€æˆåŠŸ]&quot;, id);

        // é˜»å¡ç­‰å¾…ï¼Œä¿è¯æ¶ˆè´¹
        new CountDownLatch(1).await();
    }

}
</code></pre></div><p>æˆ‘ä»¬æ¥æ‰§è¡Œ <code>#testSyncSend()</code> æ–¹æ³•ï¼Œæµ‹è¯• Consumer æ¶ˆè´¹é‡è¯•çš„æ•ˆæœã€‚æ§åˆ¶å°è¾“å‡ºå¦‚ä¸‹ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>// Producer åŒæ­¥å‘é€æ¶ˆæ¯æˆåŠŸã€‚
2019-12-15 23:04:26.865  INFO 94045 --- [           main] c.i.s.l.a.producer.Demo05ProducerTest    : [testSyncSend][å‘é€ç¼–å·ï¼š[1576422266] å‘é€æˆåŠŸ]

// Consumer ç¬¬ 1 æ¬¡æ¶ˆè´¹
2019-12-15 23:04:26.868  INFO 94045 --- [enerContainer-1] c.i.s.l.a.consumer.Demo05Consumer        : [onMessage][çº¿ç¨‹ç¼–å·:18 æ¶ˆæ¯å†…å®¹ï¼šDemo05Message{id=1576422266}]
2019-12-15 23:04:26.877  WARN 94045 --- [enerContainer-1] o.s.j.l.DefaultMessageListenerContainer  : Execution of JMS message listener failed, and no ErrorHandler has been set.

org.springframework.jms.listener.adapter.ListenerExecutionFailedException: Listener method 'public void cn.iocoder.springboot.lab32.activemqdemo.consumer.Demo05Consumer.onMessage(cn.iocoder.springboot.lab32.activemqdemo.message.Demo05Message)' threw exception; nested exception is java.lang.RuntimeException: æˆ‘å°±æ˜¯æ•…æ„æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸
    // ... çœç•¥å¼‚å¸¸å †æ ˆ

// 1 ç§’åï¼ŒConsumer ç¬¬ 1 æ¬¡é‡è¯•æ¶ˆè´¹
2019-12-15 23:04:27.875  INFO 94045 --- [enerContainer-1] c.i.s.l.a.consumer.Demo05Consumer        : [onMessage][çº¿ç¨‹ç¼–å·:18 æ¶ˆæ¯å†…å®¹ï¼šDemo05Message{id=1576422266}]
2019-12-15 23:04:27.877  WARN 94045 --- [enerContainer-1] o.s.j.l.DefaultMessageListenerContainer  : Execution of JMS message listener failed, and no ErrorHandler has been set.

org.springframework.jms.listener.adapter.ListenerExecutionFailedException: Listener method 'public void cn.iocoder.springboot.lab32.activemqdemo.consumer.Demo05Consumer.onMessage(cn.iocoder.springboot.lab32.activemqdemo.message.Demo05Message)' threw exception; nested exception is java.lang.RuntimeException: æˆ‘å°±æ˜¯æ•…æ„æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸
    // ... çœç•¥å¼‚å¸¸å †æ ˆ

// 1 ç§’åï¼ŒConsumer ç¬¬ 2 æ¬¡é‡è¯•æ¶ˆè´¹
2019-12-15 23:04:28.878  INFO 94045 --- [enerContainer-1] c.i.s.l.a.consumer.Demo05Consumer        : [onMessage][çº¿ç¨‹ç¼–å·:18 æ¶ˆæ¯å†…å®¹ï¼šDemo05Message{id=1576422266}]
2019-12-15 23:04:28.879  WARN 94045 --- [enerContainer-1] o.s.j.l.DefaultMessageListenerContainer  : Execution of JMS message listener failed, and no ErrorHandler has been set.

org.springframework.jms.listener.adapter.ListenerExecutionFailedException: Listener method 'public void cn.iocoder.springboot.lab32.activemqdemo.consumer.Demo05Consumer.onMessage(cn.iocoder.springboot.lab32.activemqdemo.message.Demo05Message)' threw exception; nested exception is java.lang.RuntimeException: æˆ‘å°±æ˜¯æ•…æ„æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸
    // ... çœç•¥å¼‚å¸¸å †æ ˆ

// 1 ç§’åï¼ŒConsumer ç¬¬ 3 æ¬¡é‡è¯•æ¶ˆè´¹
2019-12-15 23:04:29.884  INFO 94045 --- [enerContainer-1] c.i.s.l.a.consumer.Demo05Consumer        : [onMessage][çº¿ç¨‹ç¼–å·:18 æ¶ˆæ¯å†…å®¹ï¼šDemo05Message{id=1576422266}]
2019-12-15 23:04:29.887  WARN 94045 --- [enerContainer-1] o.s.j.l.DefaultMessageListenerContainer  : Execution of JMS message listener failed, and no ErrorHandler has been set.

org.springframework.jms.listener.adapter.ListenerExecutionFailedException: Listener method 'public void cn.iocoder.springboot.lab32.activemqdemo.consumer.Demo05Consumer.onMessage(cn.iocoder.springboot.lab32.activemqdemo.message.Demo05Message)' threw exception; nested exception is java.lang.RuntimeException: æˆ‘å°±æ˜¯æ•…æ„æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸
    // ... çœç•¥å¼‚å¸¸å †æ ˆ

// 1 ç§’åï¼ŒConsumer ç¬¬ 4 æ¬¡é‡è¯•æ¶ˆè´¹
2019-12-15 23:04:30.887  INFO 94045 --- [enerContainer-1] c.i.s.l.a.consumer.Demo05Consumer        : [onMessage][çº¿ç¨‹ç¼–å·:18 æ¶ˆæ¯å†…å®¹ï¼šDemo05Message{id=1576422266}]
2019-12-15 23:04:30.890  WARN 94045 --- [enerContainer-1] o.s.j.l.DefaultMessageListenerContainer  : Execution of JMS message listener failed, and no ErrorHandler has been set.

org.springframework.jms.listener.adapter.ListenerExecutionFailedException: Listener method 'public void cn.iocoder.springboot.lab32.activemqdemo.consumer.Demo05Consumer.onMessage(cn.iocoder.springboot.lab32.activemqdemo.message.Demo05Message)' threw exception; nested exception is java.lang.RuntimeException: æˆ‘å°±æ˜¯æ•…æ„æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸
    // ... çœç•¥å¼‚å¸¸å †æ ˆ

// 1 ç§’åï¼ŒConsumer ç¬¬ 5 æ¬¡é‡è¯•æ¶ˆè´¹
2019-12-15 23:04:31.893  INFO 94045 --- [enerContainer-1] c.i.s.l.a.consumer.Demo05Consumer        : [onMessage][çº¿ç¨‹ç¼–å·:18 æ¶ˆæ¯å†…å®¹ï¼šDemo05Message{id=1576422266}]
2019-12-15 23:04:31.895  WARN 94045 --- [enerContainer-1] o.s.j.l.DefaultMessageListenerContainer  : Execution of JMS message listener failed, and no ErrorHandler has been set.

org.springframework.jms.listener.adapter.ListenerExecutionFailedException: Listener method 'public void cn.iocoder.springboot.lab32.activemqdemo.consumer.Demo05Consumer.onMessage(cn.iocoder.springboot.lab32.activemqdemo.message.Demo05Message)' threw exception; nested exception is java.lang.RuntimeException: æˆ‘å°±æ˜¯æ•…æ„æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸
    // ... çœç•¥å¼‚å¸¸å †æ ˆ

// 1 ç§’åï¼ŒConsumer ç¬¬ 6 æ¬¡é‡è¯•æ¶ˆè´¹
2019-12-15 23:04:32.897  INFO 94045 --- [enerContainer-1] c.i.s.l.a.consumer.Demo05Consumer        : [onMessage][çº¿ç¨‹ç¼–å·:18 æ¶ˆæ¯å†…å®¹ï¼šDemo05Message{id=1576422266}]
2019-12-15 23:04:32.901  WARN 94045 --- [enerContainer-1] o.s.j.l.DefaultMessageListenerContainer  : Execution of JMS message listener failed, and no ErrorHandler has been set.

org.springframework.jms.listener.adapter.ListenerExecutionFailedException: Listener method 'public void cn.iocoder.springboot.lab32.activemqdemo.consumer.Demo05Consumer.onMessage(cn.iocoder.springboot.lab32.activemqdemo.message.Demo05Message)' threw exception; nested exception is java.lang.RuntimeException: æˆ‘å°±æ˜¯æ•…æ„æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸
    // ... çœç•¥å¼‚å¸¸å †æ ˆ
</code></pre></div><ul><li>Consumer é‡è¯•æ¶ˆè´¹æ¶ˆæ¯ 6 æ¬¡ï¼Œæ¯æ¬¡é—´éš” 1 ç§’ï¼Œå…¨éƒ¨éƒ½å¤±è´¥ï¼Œæœ€ç»ˆè¯¥æ¶ˆæ¯è½¬å‘åˆ°æ­»ä¿¡é˜Ÿåˆ—ä¸­ã€‚</li></ul> <p>æ­¤æ—¶ï¼Œå¦‚æœæˆ‘ä»¬ä½¿ç”¨ <a href="https://activemq.apache.org/web-console" target="_blank" rel="noopener noreferrer">ActiveMQ Web Console<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> æ¥æŸ¥çœ‹ <code>&quot;ActiveMQ.DLQ&quot;</code> çš„é˜Ÿåˆ—çš„æ¶ˆæ¯ï¼š</p> <p><img src="https://raw.githubusercontent.com/lichengcan/images/main/activemq02.png" alt=""></p> <ul><li><code>&quot;ActiveMQ.DLQ &quot;</code> é˜Ÿåˆ—ä¸­æœ‰ 1 æ¡æ¶ˆæ¯ï¼Œå°±æ˜¯æˆ‘ä»¬åˆšæ¶ˆè´¹å¤±è´¥åˆ°è¾¾ä¸Šé™çš„è¯¥æ¶ˆæ¯ã€‚</li></ul></div></section> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev"><a href="/æŠ€æœ¯æ¡†æ¶/activemq/activemq.html" class="prev">
          ActiveMQ å…¥é—¨
        </a></span> <span class="next"><a href="/æŠ€æœ¯æ¡†æ¶/kafka/kafka.html">
          Kafka å…¥é—¨
        </a></span></p></div> <div class="comments-wrapper"><!----></div></main></div> <!----></div> <ul class="sub-sidebar sub-sidebar-wrapper" style="width:12rem;" data-v-b57cc07c data-v-7dd95ae2><li class="level-2" data-v-b57cc07c><a href="/%E6%8A%80%E6%9C%AF%E6%A1%86%E6%9E%B6/activemq/activemq-spring.html#_3-1-å¼•å…¥ä¾èµ–" class="sidebar-link reco-side-_3-1-å¼•å…¥ä¾èµ–" data-v-b57cc07c>3.1 å¼•å…¥ä¾èµ–</a></li><li class="level-2" data-v-b57cc07c><a href="/%E6%8A%80%E6%9C%AF%E6%A1%86%E6%9E%B6/activemq/activemq-spring.html#_3-2-åº”ç”¨é…ç½®æ–‡ä»¶" class="sidebar-link reco-side-_3-2-åº”ç”¨é…ç½®æ–‡ä»¶" data-v-b57cc07c>3.2 åº”ç”¨é…ç½®æ–‡ä»¶</a></li><li class="level-2" data-v-b57cc07c><a href="/%E6%8A%80%E6%9C%AF%E6%A1%86%E6%9E%B6/activemq/activemq-spring.html#_3-3-application" class="sidebar-link reco-side-_3-3-application" data-v-b57cc07c>3.3 Application</a></li><li class="level-2" data-v-b57cc07c><a href="/%E6%8A%80%E6%9C%AF%E6%A1%86%E6%9E%B6/activemq/activemq-spring.html#_3-4-demo01message" class="sidebar-link reco-side-_3-4-demo01message" data-v-b57cc07c>3.4 Demo01Message</a></li><li class="level-2" data-v-b57cc07c><a href="/%E6%8A%80%E6%9C%AF%E6%A1%86%E6%9E%B6/activemq/activemq-spring.html#_3-5-demo01producer" class="sidebar-link reco-side-_3-5-demo01producer" data-v-b57cc07c>3.5 Demo01Producer</a></li><li class="level-2" data-v-b57cc07c><a href="/%E6%8A%80%E6%9C%AF%E6%A1%86%E6%9E%B6/activemq/activemq-spring.html#_3-6-demo01consumer" class="sidebar-link reco-side-_3-6-demo01consumer" data-v-b57cc07c>3.6 Demo01Consumer</a></li><li class="level-2" data-v-b57cc07c><a href="/%E6%8A%80%E6%9C%AF%E6%A1%86%E6%9E%B6/activemq/activemq-spring.html#_3-7-ç®€å•æµ‹è¯•" class="sidebar-link reco-side-_3-7-ç®€å•æµ‹è¯•" data-v-b57cc07c>3.7 ç®€å•æµ‹è¯•</a></li><li class="level-2" data-v-b57cc07c><a href="/%E6%8A%80%E6%9C%AF%E6%A1%86%E6%9E%B6/activemq/activemq-spring.html#_4-1-é›†ç¾¤æ¶ˆè´¹" class="sidebar-link reco-side-_4-1-é›†ç¾¤æ¶ˆè´¹" data-v-b57cc07c>4.1 é›†ç¾¤æ¶ˆè´¹</a></li><li class="level-3" data-v-b57cc07c><a href="/%E6%8A%80%E6%9C%AF%E6%A1%86%E6%9E%B6/activemq/activemq-spring.html#_4-1-1-å¼•å…¥ä¾èµ–" class="sidebar-link reco-side-_4-1-1-å¼•å…¥ä¾èµ–" data-v-b57cc07c>4.1.1 å¼•å…¥ä¾èµ–</a></li><li class="level-3" data-v-b57cc07c><a href="/%E6%8A%80%E6%9C%AF%E6%A1%86%E6%9E%B6/activemq/activemq-spring.html#_4-1-2-åº”ç”¨é…ç½®æ–‡ä»¶" class="sidebar-link reco-side-_4-1-2-åº”ç”¨é…ç½®æ–‡ä»¶" data-v-b57cc07c>4.1.2 åº”ç”¨é…ç½®æ–‡ä»¶</a></li><li class="level-3" data-v-b57cc07c><a href="/%E6%8A%80%E6%9C%AF%E6%A1%86%E6%9E%B6/activemq/activemq-spring.html#_4-1-3-clusteringmessage" class="sidebar-link reco-side-_4-1-3-clusteringmessage" data-v-b57cc07c>4.1.3 ClusteringMessage</a></li><li class="level-3" data-v-b57cc07c><a href="/%E6%8A%80%E6%9C%AF%E6%A1%86%E6%9E%B6/activemq/activemq-spring.html#_4-1-4-activemqconfig" class="sidebar-link reco-side-_4-1-4-activemqconfig" data-v-b57cc07c>4.1.4 ActiveMQConfig</a></li><li class="level-3" data-v-b57cc07c><a href="/%E6%8A%80%E6%9C%AF%E6%A1%86%E6%9E%B6/activemq/activemq-spring.html#_4-1-5-clusteringproducer" class="sidebar-link reco-side-_4-1-5-clusteringproducer" data-v-b57cc07c>4.1.5 ClusteringProducer</a></li><li class="level-3" data-v-b57cc07c><a href="/%E6%8A%80%E6%9C%AF%E6%A1%86%E6%9E%B6/activemq/activemq-spring.html#_4-1-6-clusteringconsumer" class="sidebar-link reco-side-_4-1-6-clusteringconsumer" data-v-b57cc07c>4.1.6 ClusteringConsumer</a></li><li class="level-3" data-v-b57cc07c><a href="/%E6%8A%80%E6%9C%AF%E6%A1%86%E6%9E%B6/activemq/activemq-spring.html#_4-1-7-ç®€å•æµ‹è¯•" class="sidebar-link reco-side-_4-1-7-ç®€å•æµ‹è¯•" data-v-b57cc07c>4.1.7 ç®€å•æµ‹è¯•</a></li><li class="level-3" data-v-b57cc07c><a href="/%E6%8A%80%E6%9C%AF%E6%A1%86%E6%9E%B6/activemq/activemq-spring.html#_4-1-8-å¤šé›†ç¾¤ä¸‹çš„é›†ç¾¤æ¶ˆè´¹" class="sidebar-link reco-side-_4-1-8-å¤šé›†ç¾¤ä¸‹çš„é›†ç¾¤æ¶ˆè´¹" data-v-b57cc07c>4.1.8 å¤šé›†ç¾¤ä¸‹çš„é›†ç¾¤æ¶ˆè´¹</a></li><li class="level-2" data-v-b57cc07c><a href="/%E6%8A%80%E6%9C%AF%E6%A1%86%E6%9E%B6/activemq/activemq-spring.html#_4-2-å¹¿æ’­æ¶ˆè´¹" class="sidebar-link reco-side-_4-2-å¹¿æ’­æ¶ˆè´¹" data-v-b57cc07c>4.2 å¹¿æ’­æ¶ˆè´¹</a></li><li class="level-3" data-v-b57cc07c><a href="/%E6%8A%80%E6%9C%AF%E6%A1%86%E6%9E%B6/activemq/activemq-spring.html#_4-2-1-broadcastmessage" class="sidebar-link reco-side-_4-2-1-broadcastmessage" data-v-b57cc07c>4.2.1 BroadcastMessage</a></li><li class="level-3" data-v-b57cc07c><a href="/%E6%8A%80%E6%9C%AF%E6%A1%86%E6%9E%B6/activemq/activemq-spring.html#_4-2-2-activemqconfig" class="sidebar-link reco-side-_4-2-2-activemqconfig" data-v-b57cc07c>4.2.2 ActiveMQConfig</a></li><li class="level-3" data-v-b57cc07c><a href="/%E6%8A%80%E6%9C%AF%E6%A1%86%E6%9E%B6/activemq/activemq-spring.html#_4-2-3-broadcastproducer" class="sidebar-link reco-side-_4-2-3-broadcastproducer" data-v-b57cc07c>4.2.3 BroadcastProducer</a></li><li class="level-3" data-v-b57cc07c><a href="/%E6%8A%80%E6%9C%AF%E6%A1%86%E6%9E%B6/activemq/activemq-spring.html#_4-2-4-broadcastconsumer" class="sidebar-link reco-side-_4-2-4-broadcastconsumer" data-v-b57cc07c>4.2.4 BroadcastConsumer</a></li><li class="level-3" data-v-b57cc07c><a href="/%E6%8A%80%E6%9C%AF%E6%A1%86%E6%9E%B6/activemq/activemq-spring.html#_4-2-5-ç®€å•æµ‹è¯•" class="sidebar-link reco-side-_4-2-5-ç®€å•æµ‹è¯•" data-v-b57cc07c>4.2.5 ç®€å•æµ‹è¯•</a></li><li class="level-2" data-v-b57cc07c><a href="/%E6%8A%80%E6%9C%AF%E6%A1%86%E6%9E%B6/activemq/activemq-spring.html#_5-1-å¼•å…¥ä¾èµ–" class="sidebar-link reco-side-_5-1-å¼•å…¥ä¾èµ–" data-v-b57cc07c>5.1 å¼•å…¥ä¾èµ–</a></li><li class="level-2" data-v-b57cc07c><a href="/%E6%8A%80%E6%9C%AF%E6%A1%86%E6%9E%B6/activemq/activemq-spring.html#_5-2-åº”ç”¨é…ç½®æ–‡ä»¶" class="sidebar-link reco-side-_5-2-åº”ç”¨é…ç½®æ–‡ä»¶" data-v-b57cc07c>5.2 åº”ç”¨é…ç½®æ–‡ä»¶</a></li><li class="level-2" data-v-b57cc07c><a href="/%E6%8A%80%E6%9C%AF%E6%A1%86%E6%9E%B6/activemq/activemq-spring.html#_5-3-demo02message" class="sidebar-link reco-side-_5-3-demo02message" data-v-b57cc07c>5.3 Demo02Message</a></li><li class="level-2" data-v-b57cc07c><a href="/%E6%8A%80%E6%9C%AF%E6%A1%86%E6%9E%B6/activemq/activemq-spring.html#_5-4-demo02producer" class="sidebar-link reco-side-_5-4-demo02producer" data-v-b57cc07c>5.4 Demo02Producer</a></li><li class="level-2" data-v-b57cc07c><a href="/%E6%8A%80%E6%9C%AF%E6%A1%86%E6%9E%B6/activemq/activemq-spring.html#_5-5-demo02consumer" class="sidebar-link reco-side-_5-5-demo02consumer" data-v-b57cc07c>5.5 Demo02Consumer</a></li><li class="level-2" data-v-b57cc07c><a href="/%E6%8A%80%E6%9C%AF%E6%A1%86%E6%9E%B6/activemq/activemq-spring.html#_5-6-ç®€å•æµ‹è¯•" class="sidebar-link reco-side-_5-6-ç®€å•æµ‹è¯•" data-v-b57cc07c>5.6 ç®€å•æµ‹è¯•</a></li><li class="level-2" data-v-b57cc07c><a href="/%E6%8A%80%E6%9C%AF%E6%A1%86%E6%9E%B6/activemq/activemq-spring.html#_6-1-å¼•å…¥ä¾èµ–" class="sidebar-link reco-side-_6-1-å¼•å…¥ä¾èµ–" data-v-b57cc07c>6.1 å¼•å…¥ä¾èµ–</a></li><li class="level-2" data-v-b57cc07c><a href="/%E6%8A%80%E6%9C%AF%E6%A1%86%E6%9E%B6/activemq/activemq-spring.html#_6-2-åº”ç”¨é…ç½®æ–‡ä»¶" class="sidebar-link reco-side-_6-2-åº”ç”¨é…ç½®æ–‡ä»¶" data-v-b57cc07c>6.2 åº”ç”¨é…ç½®æ–‡ä»¶</a></li><li class="level-2" data-v-b57cc07c><a href="/%E6%8A%80%E6%9C%AF%E6%A1%86%E6%9E%B6/activemq/activemq-spring.html#_6-3-demo03message" class="sidebar-link reco-side-_6-3-demo03message" data-v-b57cc07c>6.3 Demo03Message</a></li><li class="level-2" data-v-b57cc07c><a href="/%E6%8A%80%E6%9C%AF%E6%A1%86%E6%9E%B6/activemq/activemq-spring.html#_6-4-demo03producer" class="sidebar-link reco-side-_6-4-demo03producer" data-v-b57cc07c>6.4 Demo03Producer</a></li><li class="level-2" data-v-b57cc07c><a href="/%E6%8A%80%E6%9C%AF%E6%A1%86%E6%9E%B6/activemq/activemq-spring.html#_6-5-demo03consumer" class="sidebar-link reco-side-_6-5-demo03consumer" data-v-b57cc07c>6.5 Demo03Consumer</a></li><li class="level-2" data-v-b57cc07c><a href="/%E6%8A%80%E6%9C%AF%E6%A1%86%E6%9E%B6/activemq/activemq-spring.html#_6-6-ç®€å•æµ‹è¯•" class="sidebar-link reco-side-_6-6-ç®€å•æµ‹è¯•" data-v-b57cc07c>6.6 ç®€å•æµ‹è¯•</a></li><li class="level-2" data-v-b57cc07c><a href="/%E6%8A%80%E6%9C%AF%E6%A1%86%E6%9E%B6/activemq/activemq-spring.html#_7-1-å¼•å…¥ä¾èµ–" class="sidebar-link reco-side-_7-1-å¼•å…¥ä¾èµ–" data-v-b57cc07c>7.1 å¼•å…¥ä¾èµ–</a></li><li class="level-2" data-v-b57cc07c><a href="/%E6%8A%80%E6%9C%AF%E6%A1%86%E6%9E%B6/activemq/activemq-spring.html#_7-2-åº”ç”¨é…ç½®æ–‡ä»¶" class="sidebar-link reco-side-_7-2-åº”ç”¨é…ç½®æ–‡ä»¶" data-v-b57cc07c>7.2 åº”ç”¨é…ç½®æ–‡ä»¶</a></li><li class="level-2" data-v-b57cc07c><a href="/%E6%8A%80%E6%9C%AF%E6%A1%86%E6%9E%B6/activemq/activemq-spring.html#_7-3-demo04message" class="sidebar-link reco-side-_7-3-demo04message" data-v-b57cc07c>7.3 Demo04Message</a></li><li class="level-2" data-v-b57cc07c><a href="/%E6%8A%80%E6%9C%AF%E6%A1%86%E6%9E%B6/activemq/activemq-spring.html#_7-4-demo04producer" class="sidebar-link reco-side-_7-4-demo04producer" data-v-b57cc07c>7.4 Demo04Producer</a></li><li class="level-2" data-v-b57cc07c><a href="/%E6%8A%80%E6%9C%AF%E6%A1%86%E6%9E%B6/activemq/activemq-spring.html#_7-5-demo04consumer" class="sidebar-link reco-side-_7-5-demo04consumer" data-v-b57cc07c>7.5 Demo04Consumer</a></li><li class="level-2" data-v-b57cc07c><a href="/%E6%8A%80%E6%9C%AF%E6%A1%86%E6%9E%B6/activemq/activemq-spring.html#_7-6-ç®€å•æµ‹è¯•" class="sidebar-link reco-side-_7-6-ç®€å•æµ‹è¯•" data-v-b57cc07c>7.6 ç®€å•æµ‹è¯•</a></li><li class="level-2" data-v-b57cc07c><a href="/%E6%8A%80%E6%9C%AF%E6%A1%86%E6%9E%B6/activemq/activemq-spring.html#_8-1-å¼•å…¥ä¾èµ–" class="sidebar-link reco-side-_8-1-å¼•å…¥ä¾èµ–" data-v-b57cc07c>8.1 å¼•å…¥ä¾èµ–</a></li><li class="level-2" data-v-b57cc07c><a href="/%E6%8A%80%E6%9C%AF%E6%A1%86%E6%9E%B6/activemq/activemq-spring.html#_8-2-åº”ç”¨é…ç½®æ–‡ä»¶" class="sidebar-link reco-side-_8-2-åº”ç”¨é…ç½®æ–‡ä»¶" data-v-b57cc07c>8.2 åº”ç”¨é…ç½®æ–‡ä»¶</a></li><li class="level-2" data-v-b57cc07c><a href="/%E6%8A%80%E6%9C%AF%E6%A1%86%E6%9E%B6/activemq/activemq-spring.html#_8-3-activemqconfig" class="sidebar-link reco-side-_8-3-activemqconfig" data-v-b57cc07c>8.3 ActiveMQConfig</a></li><li class="level-2" data-v-b57cc07c><a href="/%E6%8A%80%E6%9C%AF%E6%A1%86%E6%9E%B6/activemq/activemq-spring.html#_8-4-demo05message" class="sidebar-link reco-side-_8-4-demo05message" data-v-b57cc07c>8.4 Demo05Message</a></li><li class="level-2" data-v-b57cc07c><a href="/%E6%8A%80%E6%9C%AF%E6%A1%86%E6%9E%B6/activemq/activemq-spring.html#_8-5-demo05producer" class="sidebar-link reco-side-_8-5-demo05producer" data-v-b57cc07c>8.5 Demo05Producer</a></li><li class="level-2" data-v-b57cc07c><a href="/%E6%8A%80%E6%9C%AF%E6%A1%86%E6%9E%B6/activemq/activemq-spring.html#_8-6-demo05consumer" class="sidebar-link reco-side-_8-6-demo05consumer" data-v-b57cc07c>8.6 Demo05Consumer</a></li><li class="level-2" data-v-b57cc07c><a href="/%E6%8A%80%E6%9C%AF%E6%A1%86%E6%9E%B6/activemq/activemq-spring.html#_8-7-ç®€å•æµ‹è¯•" class="sidebar-link reco-side-_8-7-ç®€å•æµ‹è¯•" data-v-b57cc07c>8.7 ç®€å•æµ‹è¯•</a></li></ul></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div></div></div>
    <script src="/assets/js/app.9ff2d364.js" defer></script><script src="/assets/js/3.531b82cf.js" defer></script><script src="/assets/js/1.66bfa7cb.js" defer></script><script src="/assets/js/122.a2372c82.js" defer></script>
  </body>
</html>
