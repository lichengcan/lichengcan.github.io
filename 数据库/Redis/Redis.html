<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Redis | CCNAIVE</title>
    <meta name="generator" content="VuePress 1.9.9">
    
    <meta name="description" content="小灿的学习日记">
    
    <link rel="preload" href="/assets/css/0.styles.ac0ba637.css" as="style"><link rel="preload" href="/assets/js/app.9ff2d364.js" as="script"><link rel="preload" href="/assets/js/3.531b82cf.js" as="script"><link rel="preload" href="/assets/js/1.66bfa7cb.js" as="script"><link rel="preload" href="/assets/js/143.b21df084.js" as="script"><link rel="prefetch" href="/assets/js/10.bbcc4f2b.js"><link rel="prefetch" href="/assets/js/100.7aa78320.js"><link rel="prefetch" href="/assets/js/101.be1a84ed.js"><link rel="prefetch" href="/assets/js/102.e54a66c3.js"><link rel="prefetch" href="/assets/js/103.96ea8db8.js"><link rel="prefetch" href="/assets/js/104.1843f7ee.js"><link rel="prefetch" href="/assets/js/105.5cb7f1d0.js"><link rel="prefetch" href="/assets/js/106.d0836c05.js"><link rel="prefetch" href="/assets/js/107.ac03de3a.js"><link rel="prefetch" href="/assets/js/108.050b9491.js"><link rel="prefetch" href="/assets/js/109.77d90976.js"><link rel="prefetch" href="/assets/js/11.7cbe3508.js"><link rel="prefetch" href="/assets/js/110.d8921d36.js"><link rel="prefetch" href="/assets/js/111.e834d261.js"><link rel="prefetch" href="/assets/js/112.fc17c22f.js"><link rel="prefetch" href="/assets/js/113.4a13e794.js"><link rel="prefetch" href="/assets/js/114.a0fc2dc4.js"><link rel="prefetch" href="/assets/js/115.c52d7495.js"><link rel="prefetch" href="/assets/js/116.18b15740.js"><link rel="prefetch" href="/assets/js/117.d5961bc5.js"><link rel="prefetch" href="/assets/js/118.ae8cd8e7.js"><link rel="prefetch" href="/assets/js/119.dbabe50a.js"><link rel="prefetch" href="/assets/js/12.03e80136.js"><link rel="prefetch" href="/assets/js/120.0a552300.js"><link rel="prefetch" href="/assets/js/121.0b55973d.js"><link rel="prefetch" href="/assets/js/122.a2372c82.js"><link rel="prefetch" href="/assets/js/123.9a1ed746.js"><link rel="prefetch" href="/assets/js/124.81c9bce0.js"><link rel="prefetch" href="/assets/js/125.9cc747cb.js"><link rel="prefetch" href="/assets/js/126.63641e51.js"><link rel="prefetch" href="/assets/js/127.afa36756.js"><link rel="prefetch" href="/assets/js/128.c3a0bafc.js"><link rel="prefetch" href="/assets/js/129.626bef76.js"><link rel="prefetch" href="/assets/js/13.98d91332.js"><link rel="prefetch" href="/assets/js/130.718e36e5.js"><link rel="prefetch" href="/assets/js/131.2f866590.js"><link rel="prefetch" href="/assets/js/132.eeae6af5.js"><link rel="prefetch" href="/assets/js/133.5f7161d3.js"><link rel="prefetch" href="/assets/js/134.d370c48c.js"><link rel="prefetch" href="/assets/js/135.cb4d88e1.js"><link rel="prefetch" href="/assets/js/136.49c2b181.js"><link rel="prefetch" href="/assets/js/137.4d5d406c.js"><link rel="prefetch" href="/assets/js/138.35297bdc.js"><link rel="prefetch" href="/assets/js/139.4cde83dd.js"><link rel="prefetch" href="/assets/js/14.5f24a2ff.js"><link rel="prefetch" href="/assets/js/140.1fba8365.js"><link rel="prefetch" href="/assets/js/141.cb4421c0.js"><link rel="prefetch" href="/assets/js/142.ea1fe29a.js"><link rel="prefetch" href="/assets/js/144.a5450651.js"><link rel="prefetch" href="/assets/js/145.4a9f1b6c.js"><link rel="prefetch" href="/assets/js/146.032cd6ee.js"><link rel="prefetch" href="/assets/js/147.0ee0cf1b.js"><link rel="prefetch" href="/assets/js/148.3954607b.js"><link rel="prefetch" href="/assets/js/149.550f7938.js"><link rel="prefetch" href="/assets/js/15.1dd4d056.js"><link rel="prefetch" href="/assets/js/150.6b5ff9f8.js"><link rel="prefetch" href="/assets/js/151.7435d46f.js"><link rel="prefetch" href="/assets/js/152.4bb838b9.js"><link rel="prefetch" href="/assets/js/153.13d7f61b.js"><link rel="prefetch" href="/assets/js/154.c2c89d66.js"><link rel="prefetch" href="/assets/js/155.28853989.js"><link rel="prefetch" href="/assets/js/156.d207ca7c.js"><link rel="prefetch" href="/assets/js/157.9f4a887f.js"><link rel="prefetch" href="/assets/js/158.56a32b96.js"><link rel="prefetch" href="/assets/js/159.ccff2e00.js"><link rel="prefetch" href="/assets/js/16.9df877bb.js"><link rel="prefetch" href="/assets/js/160.1ce908c3.js"><link rel="prefetch" href="/assets/js/161.db87a48e.js"><link rel="prefetch" href="/assets/js/162.da596968.js"><link rel="prefetch" href="/assets/js/163.4b1914f2.js"><link rel="prefetch" href="/assets/js/164.d1428de2.js"><link rel="prefetch" href="/assets/js/165.3555dd76.js"><link rel="prefetch" href="/assets/js/166.3ec9c434.js"><link rel="prefetch" href="/assets/js/167.e1c89e9e.js"><link rel="prefetch" href="/assets/js/168.0a520b94.js"><link rel="prefetch" href="/assets/js/169.4122d818.js"><link rel="prefetch" href="/assets/js/17.cd29530c.js"><link rel="prefetch" href="/assets/js/170.0ac3b66b.js"><link rel="prefetch" href="/assets/js/171.a3a64b2d.js"><link rel="prefetch" href="/assets/js/172.7ac6a10c.js"><link rel="prefetch" href="/assets/js/173.4be2f7b1.js"><link rel="prefetch" href="/assets/js/174.0dfc7fdb.js"><link rel="prefetch" href="/assets/js/175.32ead0bc.js"><link rel="prefetch" href="/assets/js/176.209b5dbb.js"><link rel="prefetch" href="/assets/js/177.11adbb39.js"><link rel="prefetch" href="/assets/js/178.037a7502.js"><link rel="prefetch" href="/assets/js/18.097816ce.js"><link rel="prefetch" href="/assets/js/19.187e5563.js"><link rel="prefetch" href="/assets/js/20.6deb3fe1.js"><link rel="prefetch" href="/assets/js/21.9d82a949.js"><link rel="prefetch" href="/assets/js/22.0edad57f.js"><link rel="prefetch" href="/assets/js/23.b9c5f664.js"><link rel="prefetch" href="/assets/js/24.897f1420.js"><link rel="prefetch" href="/assets/js/25.1311359f.js"><link rel="prefetch" href="/assets/js/26.17a94cd7.js"><link rel="prefetch" href="/assets/js/27.fa379248.js"><link rel="prefetch" href="/assets/js/28.f6aab20b.js"><link rel="prefetch" href="/assets/js/29.d9c56383.js"><link rel="prefetch" href="/assets/js/30.8dba19c8.js"><link rel="prefetch" href="/assets/js/31.10a83a0f.js"><link rel="prefetch" href="/assets/js/32.edae26a7.js"><link rel="prefetch" href="/assets/js/33.72f0a131.js"><link rel="prefetch" href="/assets/js/34.5a0fb7ca.js"><link rel="prefetch" href="/assets/js/35.9f28286e.js"><link rel="prefetch" href="/assets/js/36.ae243faa.js"><link rel="prefetch" href="/assets/js/37.381ff339.js"><link rel="prefetch" href="/assets/js/38.17ebee17.js"><link rel="prefetch" href="/assets/js/39.876319cd.js"><link rel="prefetch" href="/assets/js/4.979f9922.js"><link rel="prefetch" href="/assets/js/40.b2cec200.js"><link rel="prefetch" href="/assets/js/41.91b3553a.js"><link rel="prefetch" href="/assets/js/42.80320f96.js"><link rel="prefetch" href="/assets/js/43.783075f8.js"><link rel="prefetch" href="/assets/js/44.5b01350d.js"><link rel="prefetch" href="/assets/js/45.95d4d094.js"><link rel="prefetch" href="/assets/js/46.96cea9c3.js"><link rel="prefetch" href="/assets/js/47.23ced73b.js"><link rel="prefetch" href="/assets/js/48.04da13e7.js"><link rel="prefetch" href="/assets/js/49.2b134421.js"><link rel="prefetch" href="/assets/js/5.dda74e2f.js"><link rel="prefetch" href="/assets/js/50.cbbc36b3.js"><link rel="prefetch" href="/assets/js/51.c1a47ca0.js"><link rel="prefetch" href="/assets/js/52.36261b66.js"><link rel="prefetch" href="/assets/js/53.4d53e570.js"><link rel="prefetch" href="/assets/js/54.13e1603f.js"><link rel="prefetch" href="/assets/js/55.809c8ddc.js"><link rel="prefetch" href="/assets/js/56.5df2380e.js"><link rel="prefetch" href="/assets/js/57.2194d408.js"><link rel="prefetch" href="/assets/js/58.2c620696.js"><link rel="prefetch" href="/assets/js/59.34ee045d.js"><link rel="prefetch" href="/assets/js/6.5eed2fc3.js"><link rel="prefetch" href="/assets/js/60.3f617150.js"><link rel="prefetch" href="/assets/js/61.92698d83.js"><link rel="prefetch" href="/assets/js/62.0bfecc40.js"><link rel="prefetch" href="/assets/js/63.8da717e4.js"><link rel="prefetch" href="/assets/js/64.200fd49a.js"><link rel="prefetch" href="/assets/js/65.72a58cca.js"><link rel="prefetch" href="/assets/js/66.2985426d.js"><link rel="prefetch" href="/assets/js/67.8862ebfb.js"><link rel="prefetch" href="/assets/js/68.6f5b02a9.js"><link rel="prefetch" href="/assets/js/69.aa496fb1.js"><link rel="prefetch" href="/assets/js/7.8f40985b.js"><link rel="prefetch" href="/assets/js/70.b26013d6.js"><link rel="prefetch" href="/assets/js/71.1b1ae916.js"><link rel="prefetch" href="/assets/js/72.3035363e.js"><link rel="prefetch" href="/assets/js/73.eca6d0df.js"><link rel="prefetch" href="/assets/js/74.d4240c34.js"><link rel="prefetch" href="/assets/js/75.4dcd7ab1.js"><link rel="prefetch" href="/assets/js/76.e0675e49.js"><link rel="prefetch" href="/assets/js/77.edf24e37.js"><link rel="prefetch" href="/assets/js/78.552224f2.js"><link rel="prefetch" href="/assets/js/79.be7a41b6.js"><link rel="prefetch" href="/assets/js/8.e3dca3e1.js"><link rel="prefetch" href="/assets/js/80.147a04c7.js"><link rel="prefetch" href="/assets/js/81.3ecd3a95.js"><link rel="prefetch" href="/assets/js/82.b647894f.js"><link rel="prefetch" href="/assets/js/83.200bc3a6.js"><link rel="prefetch" href="/assets/js/84.a15d5403.js"><link rel="prefetch" href="/assets/js/85.75a34ef2.js"><link rel="prefetch" href="/assets/js/86.6b4e2beb.js"><link rel="prefetch" href="/assets/js/87.b15ce75c.js"><link rel="prefetch" href="/assets/js/88.507b99bb.js"><link rel="prefetch" href="/assets/js/89.b5d5b184.js"><link rel="prefetch" href="/assets/js/9.a4890a44.js"><link rel="prefetch" href="/assets/js/90.40064807.js"><link rel="prefetch" href="/assets/js/91.5cab932b.js"><link rel="prefetch" href="/assets/js/92.8682710e.js"><link rel="prefetch" href="/assets/js/93.78582e33.js"><link rel="prefetch" href="/assets/js/94.48896994.js"><link rel="prefetch" href="/assets/js/95.b637124b.js"><link rel="prefetch" href="/assets/js/96.07d46f7c.js"><link rel="prefetch" href="/assets/js/97.c24e0b91.js"><link rel="prefetch" href="/assets/js/98.d6a95e55.js"><link rel="prefetch" href="/assets/js/99.9330a585.js">
    <link rel="stylesheet" href="/assets/css/0.styles.ac0ba637.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-7dd95ae2><div data-v-7dd95ae2><div class="password-shadow password-wrapper-out" style="display:none;" data-v-59e6cb88 data-v-7dd95ae2 data-v-7dd95ae2><h3 class="title" data-v-59e6cb88>CCNAIVE</h3> <p class="description" data-v-59e6cb88>小灿的学习日记</p> <label id="box" class="inputBox" data-v-59e6cb88><input type="password" value="" data-v-59e6cb88> <span data-v-59e6cb88>Konck! Knock!</span> <button data-v-59e6cb88>OK</button></label> <div class="footer" data-v-59e6cb88><span data-v-59e6cb88><i class="iconfont reco-theme" data-v-59e6cb88></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-59e6cb88>vuePress-theme-reco</a></span> <span data-v-59e6cb88><i class="iconfont reco-copyright" data-v-59e6cb88></i> <a data-v-59e6cb88><!---->
          
        <!---->
        2025
      </a></span></div></div> <div class="hide" data-v-7dd95ae2><header class="navbar" data-v-7dd95ae2><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">CCNAIVE</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link"><i class="undefined"></i>
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      小灿的学习日记
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/lichengcan" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://gitee.com/lichengcan0228/lichengcan0228" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  Gitee
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-7dd95ae2></div> <aside class="sidebar" data-v-7dd95ae2><div class="personal-info-wrapper" data-v-1fad0c41 data-v-7dd95ae2><!----> <!----> <div class="num" data-v-1fad0c41><div data-v-1fad0c41><h3 data-v-1fad0c41>160</h3> <h6 data-v-1fad0c41>文章</h6></div> <div data-v-1fad0c41><h3 data-v-1fad0c41>6</h3> <h6 data-v-1fad0c41>标签</h6></div></div> <ul class="social-links" data-v-1fad0c41></ul> <hr data-v-1fad0c41></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link"><i class="undefined"></i>
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      小灿的学习日记
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/lichengcan" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://gitee.com/lichengcan0228/lichengcan0228" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  Gitee
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav> <ul class="sidebar-links"><li><a href="/" aria-current="page" class="sidebar-link">CCNAIVE</a></li><li><section class="sidebar-group collapsable depth-0"><a href="/Java/面向对象/多态" class="sidebar-heading clickable"><span>Java 从入门到放弃</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/数据结构与算法/排序/排序" class="sidebar-heading clickable"><span>数据结构与算法</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/网络/基础篇/TCP-IP" class="sidebar-heading clickable"><span>网络</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/Spring/Spring/Spring" class="sidebar-heading clickable"><span>Spring 全家桶</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/数据库/MySQL/CommonUseSQL" class="sidebar-heading clickable"><span>数据库</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/技术框架/rabbitmq/rabbitmq" class="sidebar-heading clickable"><span>技术框架</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/Linux/LinuxCommand" class="sidebar-heading clickable"><span>Linux 服务器相关</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/杂/一些网站/website" class="sidebar-heading clickable"><span>杂</span> <span class="arrow right"></span></a> <!----></section></li></ul> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-59e6cb88 data-v-7dd95ae2><h3 class="title" data-v-59e6cb88></h3> <!----> <label id="box" class="inputBox" data-v-59e6cb88><input type="password" value="" data-v-59e6cb88> <span data-v-59e6cb88>Konck! Knock!</span> <button data-v-59e6cb88>OK</button></label> <div class="footer" data-v-59e6cb88><span data-v-59e6cb88><i class="iconfont reco-theme" data-v-59e6cb88></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-59e6cb88>vuePress-theme-reco</a></span> <span data-v-59e6cb88><i class="iconfont reco-copyright" data-v-59e6cb88></i> <a data-v-59e6cb88><!---->
          
        <!---->
        2025
      </a></span></div></div> <div data-v-7dd95ae2><div data-v-7dd95ae2><main class="page"><section style="display:;"><div class="page-title"><h1 class="title">Redis</h1> <div data-v-8a445198><i class="iconfont reco-account" data-v-8a445198><span data-v-8a445198>承灿</span></i> <i class="iconfont reco-date" data-v-8a445198><span data-v-8a445198>2023/5/4</span></i> <!----> <!----></div></div> <div class="theme-reco-content content__default"><h1 id="redis"><a href="#redis" class="header-anchor">#</a> Redis</h1> <h2 id="一、引言"><a href="#一、引言" class="header-anchor">#</a> 一、引言</h2> <h3 id="_1-1-数据库压力过大"><a href="#_1-1-数据库压力过大" class="header-anchor">#</a> 1.1 数据库压力过大</h3> <blockquote><p>由于用户量增大，请求数量也随之增大，数据压力过大</p></blockquote> <h3 id="_1-2-数据不同步"><a href="#_1-2-数据不同步" class="header-anchor">#</a> 1.2 数据不同步</h3> <blockquote><p>多台服务器之间，数据不同步 ----- session 共享问题</p></blockquote> <h3 id="_1-3-传统锁失效"><a href="#_1-3-传统锁失效" class="header-anchor">#</a> 1.3 传统锁失效</h3> <blockquote><p>多台服务器之间的锁，已经不存在互斥性了。 ------ 分布式锁的问题</p></blockquote> <h2 id="二、redis介绍"><a href="#二、redis介绍" class="header-anchor">#</a> 二、Redis介绍</h2> <h3 id="_2-1-nosql介绍"><a href="#_2-1-nosql介绍" class="header-anchor">#</a> 2.1 NoSQL介绍</h3> <p>提示</p> <ul><li>Redis就是一款NoSQL。 not only sql</li> <li>NoSQL -&gt; 非关系型数据库 -&gt; Not Only SQL。</li> <li>Key-Value：Redis。。。</li> <li>文档型：ElasticSearch，Solr，Mongodb。。。</li> <li>面向列：Hbase。。。</li> <li>图形化：Neo4j。。。</li> <li>除了关系型数据库都是非关系型数据库。</li> <li>NoSQL只是一种概念，泛指非关系型数据库，和关系型数据库做一个区分。</li></ul> <h3 id="_2-2-redis介绍"><a href="#_2-2-redis介绍" class="header-anchor">#</a> 2.2 Redis介绍</h3> <p>提示</p> <p>有一位意大利人，在开发一款LLOOGG的统计页面，因为MySQL的性能不好，自己研发了一款非关系型数据库，并命名为Redis。Salvatore。
Redis（Remote Dictionary Server）即远程字典服务，Redis是由C语言去编写，Redis是一款基于Key-Value的NoSQL，而且Redis是基于内存存储数据的，Redis还提供了多种持久化机制，性能可以达到110000/s读取数据以及81000/s写入数据，Redis还提供了主从，哨兵以及集群的搭建方式，可以更方便的横向扩展以及垂直扩展。</p> <h2 id="三、redis安装"><a href="#三、redis安装" class="header-anchor">#</a> 三、Redis安装</h2> <h3 id="_3-1-安装redis"><a href="#_3-1-安装redis" class="header-anchor">#</a> 3.1 安装Redis</h3> <blockquote><p>Docker-Compose安装</p></blockquote> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">'3.1'</span>
<span class="token key atrule">services</span><span class="token punctuation">:</span>
  <span class="token key atrule">redis</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> daocloud.io/library/redis<span class="token punctuation">:</span>5.0.7
    <span class="token key atrule">restart</span><span class="token punctuation">:</span> always
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> redis
    <span class="token key atrule">environment</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> TZ=Asia/Shanghai
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> 6379<span class="token punctuation">:</span><span class="token number">6379</span>
</code></pre></div><p>注意： 这个镜像仓库 的 安装 默认 开启了 两种持久化方式rdb/aof，不同的安装方式，持久化开启情况不一样</p> <h3 id="_3-2-使用redis-cli连接redis"><a href="#_3-2-使用redis-cli连接redis" class="header-anchor">#</a> 3.2 使用redis-cli连接Redis</h3> <blockquote><p>进去Redis容器的内部</p> <p>docker exec -it 容器id bash</p> <p>在容器内部，使用redis-cli连接</p> <p>redis-cli 在这个/usr/local/bin路径下</p></blockquote> <p>进入容器内部后，可以使用容器自带的redis-cli 连接到redis的服务端</p> <p>redis-cli 是redis自带的一个客户端工具，可以帮助我们连接到redis服务端，操作redis</p> <h3 id="_3-3-使用图形化界面连接redis"><a href="#_3-3-使用图形化界面连接redis" class="header-anchor">#</a> 3.3 使用图形化界面连接Redis</h3> <blockquote><p>下载地址：https://github.com/lework/RedisDesktopManager-Windows/releases/download/2019.5/redis-desktop-manager-2019.5.zipopen in new window</p> <p>傻瓜式安装RedisDesktopManager</p> <p><img src="https://s2.loli.net/2023/12/18/YSuNgfIZEO1bHsJ.png" alt=""></p></blockquote> <h2 id="四、redis常用命令【重点】"><a href="#四、redis常用命令【重点】" class="header-anchor">#</a> 四、Redis常用命令【重点】</h2> <h3 id="_4-1-redis存储数据的结构"><a href="#_4-1-redis存储数据的结构" class="header-anchor">#</a> 4.1 Redis存储数据的结构</h3> <blockquote><p>常用的5种数据结构：</p> <ul><li>key-string：一个key对应一个值。</li> <li>key-hash：一个key对应一个Map。</li> <li>key-list：一个key对应一个列表。 有序的 可以重复的</li> <li>key-set：一个key对应一个集合。 无序的 不可以重复的</li> <li>key-zset：一个key对应一个有序的集合。 有序的 不可以重复的</li></ul> <p>另外三种数据结构：</p> <ul><li>HyperLogLog：计算近似值的。</li> <li>GEO：地理位置。</li> <li>BIT：一般存储的也是一个字符串，存储的是一个byte[]。</li></ul> <p>五种常用的存储数据结构图</p></blockquote> <blockquote><ul><li>key-string：最常用的，一般用于存储一个值。</li> <li>key-hash：存储一个对象数据的。</li> <li>key-list：使用list结构实现栈和队列结构。</li> <li>key-set：交集，差集和并集的操作。</li> <li>key-zset：排行榜，积分存储等操作。</li></ul></blockquote> <h3 id="_4-2-string常用命令"><a href="#_4-2-string常用命令" class="header-anchor">#</a> 4.2 string常用命令</h3> <blockquote><p>string常用操作命令</p></blockquote> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment">#1.  添加值</span>
<span class="token builtin class-name">set</span> key value
<span class="token builtin class-name">set</span> name zs 
<span class="token comment">#2. 取值</span>
get key
get name
<span class="token comment">#3. 批量操作</span>
mset key value <span class="token punctuation">[</span>key value<span class="token punctuation">..</span>.<span class="token punctuation">]</span>
mset k1 v1 k2 v2 k3 v3
mget key <span class="token punctuation">[</span>key<span class="token punctuation">..</span>.<span class="token punctuation">]</span>
mget k1 k2 k3
<span class="token comment">#4. 自增命令（自增1）</span>
incr key 
<span class="token builtin class-name">set</span> age <span class="token number">18</span>
incr age 
<span class="token comment">#5. 自减命令（自减1）</span>
decr key
decr age
<span class="token comment">#6. 自增或自减指定数量</span>
incrby key increment
incrby age <span class="token number">2</span>
decrby key increment
DECRBY age <span class="token number">2</span>

<span class="token comment">#7. 设置值的同时，指定生存时间（每次向Redis中添加数据时，尽量都设置上生存时间）</span>
setex key second value
setex address <span class="token number">30</span> zz      设置  address  zz 键值 存活30秒

ttl key    查看key 的 剩余存活时间
<span class="token comment">#8. 设置值，如果当前key不存在的话（如果这个key存在，什么事都不做，如果这个key不存在，和set命令一样）</span>
setnx key value
setnx lock <span class="token number">1</span>       
<span class="token comment"># 如果redis 内没有  lock 这个键  就执行成功   有的话就执行失败 </span>
<span class="token comment">#9. 在key对应的value后，追加内容</span>
append key value
append name zs      name 这个键对应的值后追加  zs

<span class="token comment">#10. 查看value字符串的长度</span>
strlen key
</code></pre></div><blockquote><p>设置key时同时指定过期时间</p> <p>语法： set key value ex 秒</p> <p>例子： set foo bar ex 20</p></blockquote> <h3 id="_4-3-hash常用命令"><a href="#_4-3-hash常用命令" class="header-anchor">#</a> 4.3 hash常用命令</h3> <blockquote><p>hash常用命令</p> <p>保存的value是一个对象 【属性和属性值】</p></blockquote> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment">#1. 存储数据</span>
hset key field value

<span class="token comment">#2. 获取数据</span>
hget key field

<span class="token comment">#3. 批量操作</span>
hmset key field value <span class="token punctuation">[</span>field value <span class="token punctuation">..</span>.<span class="token punctuation">]</span>
hmget key field <span class="token punctuation">[</span>field <span class="token punctuation">..</span>.<span class="token punctuation">]</span>

<span class="token comment">#4. 自增（指定自增的值）</span>
hincrby key field increment

<span class="token comment">#5. 设置值（如果key-field不存在，那么就正常添加，如果存在，什么事都不做）</span>
hsetnx key field value

<span class="token comment">#6. 检查field是否存在</span>
hexists key field 

<span class="token comment">#7. 删除key对应的field，可以删除多个</span>
hdel key field <span class="token punctuation">[</span>field <span class="token punctuation">..</span>.<span class="token punctuation">]</span>

<span class="token comment">#8. 获取当前hash结构中的全部field和value</span>
hgetall key

<span class="token comment">#9. 获取当前hash结构中的全部field</span>
hkeys key

<span class="token comment">#10. 获取当前hash结构中的全部value</span>
hvals key

<span class="token comment">#11. 获取当前hash结构中field的数量</span>
hlen key
</code></pre></div><p>hash应用场景</p> <p>对象缓存</p> <blockquote><p>模拟购物车</p> <p>用户id 为 key 商品id 为 field 商品数量 为 value</p> <p>添加商品 hset cart:1001 10086 1 【hset cart:用户ID 商品ID 数量】</p> <p>增加数量 HINCRBY cart:1001 10086 1 【HINCRBY cart:用户ID 商品ID 数量】</p> <p>商品总数 HLEN cart:1001 【HLEN cart:用户ID】</p> <p>删除商品 hdel cart:1001 10086 【 hdel cart:用户ID 商品ID】</p> <p>获取购物车所有商品： HGETALL cart:1001 【HGETALL cart:用户ID 】</p></blockquote> <h3 id="_4-4-list常用命令"><a href="#_4-4-list常用命令" class="header-anchor">#</a> 4.4 list常用命令</h3> <blockquote><p>list常用命令 有序的列表</p> <p>push 推，存数据</p> <p>pop 弹，取数据</p> <p>l left：左边</p> <p>r right: 右边</p></blockquote> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment">#1. 存储数据（从左侧插入数据，从右侧插入数据）</span>
lpush key value <span class="token punctuation">[</span>value <span class="token punctuation">..</span>.<span class="token punctuation">]</span>
rpush key value <span class="token punctuation">[</span>value <span class="token punctuation">..</span>.<span class="token punctuation">]</span>

<span class="token comment">#2. 存储数据(如果key不存在，就什么都不做，如果key存在，就正常添加)</span>
lpushx key value
rpushx key value

<span class="token comment">#3. 修改数据（在存储数据时，指定好你的索引位置,覆盖之前索引位置的数据，index超出整个列表的长度，也会失败）</span>
lset key index value

<span class="token comment">#4. 弹栈方式获取数据（左侧弹出数据，从右侧弹出数据）</span>
lpop key
rpop key

<span class="token comment">#5. 获取指定索引范围的数据（start从0开始，stop输入-1，代表最后一个，-2代表倒数第二个）</span>
lrange key start stop

<span class="token comment">#6. 获取指定索引位置的数据</span>
lindex key index

<span class="token comment">#7. 获取整个列表的长度</span>
llen key

<span class="token comment">#8. 删除列表中的数据（他是删除当前列表中的count个value值，count &gt; 0从左侧向右侧删除，count &lt; 0从右侧向左侧删除，count == 0删除列表中全部的value）</span>
lrem key count value

<span class="token comment">#9. 保留列表中的数据（保留你指定索引范围内的数据，超过整个索引范围被移除掉）</span>
ltrim key start stop

<span class="token comment">#10. 将一个列表中最后的一个数据，插入到另外一个列表的头部位置</span>
rpoplpush list1 list2
</code></pre></div><blockquote><p>list 模拟栈 statck = lpush + lpop</p> <p>模拟队列 queue = lpush + rpop</p> <p>小明关注了 多个a,b,c三个公众号 三个公众号依次发消息 小明的id 为1</p> <p>lpush msg:1 1001 a公众号发id 为1001 的 消息</p> <p>lpush msg:1 1002 b公众号发id 为1002 的 消息</p> <p>lpush msg:1 1003 c公众号发id 为1003 的 消息</p></blockquote> <h3 id="_4-5-set常用命令"><a href="#_4-5-set常用命令" class="header-anchor">#</a> 4.5 set常用命令</h3> <blockquote><p>set常用命令</p> <p>无序不可重复</p></blockquote> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment">#1. 存储数据</span>
sadd key member <span class="token punctuation">[</span>member <span class="token punctuation">..</span>.<span class="token punctuation">]</span>

<span class="token comment">#2. 获取数据（获取全部数据）</span>
smembers key

<span class="token comment">#3. 随机获取一个数据（获取的同时，移除数据，count默认为1，代表弹出数据的数量）</span>
spop key <span class="token punctuation">[</span>count<span class="token punctuation">]</span>

<span class="token comment">#4. 交集（取多个set集合交集）</span>
sinter set1 set2 <span class="token punctuation">..</span>.

<span class="token comment">#5. 并集（获取全部集合中的数据）</span>
sunion set1 set2 <span class="token punctuation">..</span>.

<span class="token comment">#6. 差集（获取多个集合中不一样的数据）</span>
<span class="token function">sdiff</span> set1 set2 <span class="token punctuation">..</span>.

<span class="token comment"># 7. 删除数据</span>
srem key member <span class="token punctuation">[</span>member <span class="token punctuation">..</span>.<span class="token punctuation">]</span>

<span class="token comment"># 8. 查看当前的set集合中是否包含这个值</span>
sismember key member
</code></pre></div><blockquote><p>应用场景 朋友圈点赞</p> <p>sadd like:messageid:1 1 messageid:1 消息 被 id为1 的用户点赞</p> <p>SCARD like:messageid:1 获取点赞数</p> <p>SISMEMBER like:messageid:1 2 判断 id 为2 的 有没有给这个朋友圈信息点赞</p></blockquote> <blockquote><p>抖音的关注模型</p> <p>zs关注的人 sadd zslike ls ww zl</p> <p>ls 关注的人 sadd lslike ww zl tq</p> <p>ww关注的人 sadd wwlike zs ls zl tq</p> <p>ww的粉丝 sadd wwfans zs ls</p> <p>zs和ls 共同关注的人 SINTER zslike lslike</p> <p>zs可能认识的人</p> <p>SDIFF lslike zslike</p></blockquote> <h3 id="_4-6-zset的常用命令"><a href="#_4-6-zset的常用命令" class="header-anchor">#</a> 4.6 zset的常用命令</h3> <blockquote><p>zset常用命令</p> <p>有序且不重复。每个元素都会关联一个double类型的分数，Redis通过分数进行从小到大的排序。</p> <p>分数可以重复</p></blockquote> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment">#1. 添加数据(score必须是数值。member不允许重复的。)</span>
zadd key score member <span class="token punctuation">[</span>score member <span class="token punctuation">..</span>.<span class="token punctuation">]</span>

<span class="token comment">#2. 修改member的分数（如果member是存在于key中的，正常增加分数，如果memeber不存在，这个命令就相当于zadd）</span>
zincrby key increment member

<span class="token comment">#3. 查看指定的member的分数</span>
zscore key member

<span class="token comment">#4. 获取zset中数据的数量</span>
zcard key

<span class="token comment">#5. 根据score的范围查询member数量</span>
zcount key min max

<span class="token comment">#6. 删除zset中的成员</span>
zrem key member <span class="token punctuation">[</span>member<span class="token punctuation">..</span>.<span class="token punctuation">]</span>

<span class="token comment">#7. 根据分数从小到大排序，获取指定范围内的数据（withscores如果添加这个参数，那么会返回member对应的分数）</span>
<span class="token comment"># 全部元素根据分数从小到大排序</span>
<span class="token comment"># start 起始下标</span>
<span class="token comment"># stop 终止下标</span>
zrange key start stop <span class="token punctuation">[</span>withscores<span class="token punctuation">]</span>

<span class="token comment">#8. 根据分数从大到小排序，获取指定范围内的数据（withscores如果添加这个参数，那么会返回member对应的分数）</span>
zrevrange key start stop <span class="token punctuation">[</span>withscores<span class="token punctuation">]</span>

<span class="token comment">#9. 根据分数的返回去获取member(withscores代表同时返回score，添加limit，就和MySQL中一样，如果不希望等于min或者max的值被查询出来可以采用 ‘(分数’ 相当于 &lt; 但是不等于的方式，最大值和最小值使用+inf和-inf来标识)</span>
zrangebyscore key min max <span class="token punctuation">[</span>withscores<span class="token punctuation">]</span> <span class="token punctuation">[</span>limit offset count<span class="token punctuation">]</span>

<span class="token comment">#   ZRANGEBYSCORE zset1 10 18 withscores limit 0 2    </span>
取score  为  <span class="token number">10</span> 到  <span class="token number">18</span> 之间的 value（包含边界值10  和  <span class="token number">18</span>）  从 索引为 <span class="token number">0</span> 处开始取    取两个 

<span class="token comment">#   ZRANGEBYSCORE zset1 (10 (18 withscores limit 0 2 </span>
取score  为  <span class="token number">10</span> 到  <span class="token number">18</span> 之间的 value（不包含边界值10  和  <span class="token number">18</span>）  从 索引为 <span class="token number">0</span> 处开始取    取两个

<span class="token comment">#  ZRANGEBYscore zset1 -inf +inf withscores limit 1  3</span>
取 最小 score 到 最大score 的值   从 索引1  开始 取 ，取 <span class="token number">3</span> 个  

<span class="token comment">#10. 根据分数的返回去获取member(withscores代表同时返回score，添加limit，就和MySQL中一样)</span>
<span class="token comment">#  返回有序集中指定分数区间内的所有的成员。有序集成员按分数值递减(从大到小)的次序排列。</span>
<span class="token comment">#  成员按分数值递减的次序排列</span>
zrevrangebyscore key max min <span class="token punctuation">[</span>withscores<span class="token punctuation">]</span> <span class="token punctuation">[</span>limit offset count<span class="token punctuation">]</span>
</code></pre></div><blockquote><p>rev: reverse 反转</p> <p>range: 范围</p> <p>score: 分数</p> <p>inf: 无穷，无限</p></blockquote> <p>分数的取值范围【可以是整数小数】</p> <p>如果分数相同，就按元素的字典序排列【数值从小到大，字母从a到z】</p> <h3 id="_4-7-key常用命令"><a href="#_4-7-key常用命令" class="header-anchor">#</a> 4.7 key常用命令</h3> <blockquote><p>key常用命令</p></blockquote> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment">#1. 查看Redis中的全部的key（pattern：* ，xxx*，*xxx）</span>
keys pattern

<span class="token comment">#2. 查看某一个key是否存在（1 - key存在，0 - key不存在）</span>
exists key

<span class="token comment">#3. 删除key</span>
del key <span class="token punctuation">[</span>key <span class="token punctuation">..</span>.<span class="token punctuation">]</span>

<span class="token comment">#4. 设置key的生存时间，单位为秒，设置还能活多久</span>
expire key second
<span class="token comment"># 单位为毫秒,</span>
pexpire key milliseconds

<span class="token comment">#5. 设置key的生存时间，单位为秒,设置能活到什么时间点    接收到的是unix 时间戳</span>
expireat key timestamp 
<span class="token comment"># 单位为毫秒</span>
pexpireat key milliseconds

<span class="token comment">#6. 查看key的剩余生存时间,单位为秒</span>
<span class="token comment">#（-2 表示当前key不存在，-1 -表示当前key没有设置生存时间，其他数值表示具体剩余的生存时间）</span>
ttl key
<span class="token comment"># 单位为毫秒</span>
pttl key

<span class="token comment">#7. 移除key的生存时间（1 - 移除成功，0 - key不存在生存时间或者key不存在）</span>
persist key

<span class="token comment">#8. 选择操作的库</span>
<span class="token keyword">select</span> <span class="token number">0</span>~15

<span class="token comment">#9. 移动key到另外一个库中</span>
move key db

<span class="token comment">#10. 重命名key</span>
<span class="token function">rename</span> key newkey：修改key的名称

<span class="token comment">#11. 查看key存储值的数据类型</span>
<span class="token builtin class-name">type</span> key：返回key所储存的值的类型
</code></pre></div><p>expirekey的使用场景：</p> <blockquote><p>1、限时的优惠活动
2、网站数据缓存
3、手机验证码
4、限制网站访客频率</p></blockquote> <p>key的命名建议：</p> <blockquote><ol><li>key不要太长，尽量不要超过1024字节。不仅消耗内存，也会降低查找的效率</li> <li>key不要太短，太短可读性会降低</li> <li>在一个项目中，key最好使用统一的命名模式，如 user:123:password</li> <li>key区分大小写</li></ol></blockquote> <h3 id="_4-8-库的常用命令"><a href="#_4-8-库的常用命令" class="header-anchor">#</a> 4.8 库的常用命令</h3> <blockquote><p>db常用命令</p></blockquote> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment">#1. 清空当前所在的数据库</span>
flushdb

<span class="token comment">#2. 清空全部数据库</span>
flushall

<span class="token comment">#3. 查看当前数据库中有多少个key</span>
dbsize

<span class="token comment">#4. 查看最后一次操作的时间   Lastsave 命令返回最近一次 Redis 成功将数据保存到磁盘上的时间，以 UNIX 时间戳格式表示。</span>
lastsave        返回   integer 值 

<span class="token comment">#5. 实时监控Redis服务接收到的命令   在一个连接上  使用 monitor 可以监控 别的连接对redis 的操作  </span>
monitor
</code></pre></div><h2 id="五、java连接redis【重点】"><a href="#五、java连接redis【重点】" class="header-anchor">#</a> 五、Java连接Redis【重点】</h2> <h3 id="_5-1-springboot连接redis"><a href="#_5-1-springboot连接redis" class="header-anchor">#</a> 5.1 SpringBoot连接Redis</h3> <h4 id="_5-1-1-创建maven工程"><a href="#_5-1-1-创建maven工程" class="header-anchor">#</a> 5.1.1 创建Maven工程</h4> <blockquote><p>idea创建，创建时选择就选择单元测试/Lombok/NoSQL中的redis模块</p></blockquote> <h4 id="_5-1-2-导入需要的依赖"><a href="#_5-1-2-导入需要的依赖" class="header-anchor">#</a> 5.1.2 导入需要的依赖</h4> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-data-redis<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-devtools<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">&gt;</span></span>runtime<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>optional</span><span class="token punctuation">&gt;</span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>optional</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.projectlombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>lombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>optional</span><span class="token punctuation">&gt;</span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>optional</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">&gt;</span></span>test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>配置文件</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token comment"># redis连接信息配置</span>
  <span class="token key atrule">redis</span><span class="token punctuation">:</span>
    <span class="token key atrule">host</span><span class="token punctuation">:</span> 192.168.29.110
    <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">6379</span>
    <span class="token comment"># springboot2.0以上的版本默认使用的是lettuce redis客户端</span>
    <span class="token key atrule">lettuce</span><span class="token punctuation">:</span>
      <span class="token key atrule">pool</span><span class="token punctuation">:</span>
        <span class="token key atrule">max-active</span><span class="token punctuation">:</span> <span class="token number">8</span>
        <span class="token key atrule">max-wait</span><span class="token punctuation">:</span> <span class="token number">-1</span>
        <span class="token key atrule">max-idle</span><span class="token punctuation">:</span> <span class="token number">5</span>
        <span class="token key atrule">min-idle</span><span class="token punctuation">:</span> <span class="token number">0</span>
</code></pre></div><h4 id="_5-1-3-测试"><a href="#_5-1-3-测试" class="header-anchor">#</a> 5.1.3 测试</h4> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@SpringBootTest</span>
<span class="token keyword">class</span> <span class="token class-name">RedisDemoApplicationTests</span> <span class="token punctuation">{</span>
    
    <span class="token comment">// 注入StringRedisTemplate 字串类型的redis操作模板类</span>
    <span class="token comment">// 只能操作key/value都是字串类型的数据</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token class-name">StringRedisTemplate</span> stringRedisTemplate<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">void</span> <span class="token function">contextLoads</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ValueOperations</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> ops <span class="token operator">=</span> stringRedisTemplate<span class="token punctuation">.</span><span class="token function">opsForValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 设置数据</span>
        ops<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;name1&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;仁康&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 获取值</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>ops<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;name1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 设置值同时指定过期时间</span>
        <span class="token comment">// ops.set(&quot;name2&quot;,&quot;李四&quot;,30,TimeUnit.SECONDS);</span>

        <span class="token comment">// 如果key不存在时设置值并返回true，如果存在时什么都不在返回false</span>
        <span class="token comment">// ops.setIfAbsent(&quot;name1&quot;,&quot;王五&quot;);</span>

        <span class="token comment">// 如果key存在时设置值并返回true，如果不存在时什么都不在返回false</span>
        <span class="token comment">// ops.setIfPresent(&quot;name1&quot;,&quot;王五&quot;);</span>

        ops<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;name1&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;大好人&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>ops<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;name1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 获取字串的字符数</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>ops<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token string">&quot;name1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div><h3 id="_5-2-存储一个对象到redis以json的形式"><a href="#_5-2-存储一个对象到redis以json的形式" class="header-anchor">#</a> 5.2 存储一个对象到Redis以json的形式</h3> <h4 id="_5-2-1-准备一个user实体类"><a href="#_5-2-1-准备一个user实体类" class="header-anchor">#</a> 5.2.1 准备一个User实体类</h4> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Data</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token keyword">implements</span> <span class="token class-name">Serializable</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> serialVersionUID <span class="token operator">=</span> <span class="token number">5700617907293625554L</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> id<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Date</span> birthday<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>配置序列化类，自动添加serialVersionUID</p> <blockquote><p>实体类需要实现Serializable接口，</p> <p>配置过以后，在类上使用 alt+Enter可以自动提示，生成serialVersionUID</p></blockquote> <h4 id="_5-2-2-redis配置类"><a href="#_5-2-2-redis配置类" class="header-anchor">#</a> 5.2.2 Redis配置类</h4> <p>一般需要配置 redis key/value的序列化方式</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RedisConfig</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">RedisTemplate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> <span class="token function">redisTemplate</span><span class="token punctuation">(</span><span class="token class-name">RedisConnectionFactory</span> factory<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">RedisTemplate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> template <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RedisTemplate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 设置开启事务支持</span>
        template<span class="token punctuation">.</span><span class="token function">setEnableTransactionSupport</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//关联</span>
        template<span class="token punctuation">.</span><span class="token function">setConnectionFactory</span><span class="token punctuation">(</span>factory<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//设置key的序列化器</span>
        template<span class="token punctuation">.</span><span class="token function">setKeySerializer</span><span class="token punctuation">(</span><span class="token class-name">RedisSerializer</span><span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//设置value的序列器</span>
        template<span class="token punctuation">.</span><span class="token function">setValueSerializer</span><span class="token punctuation">(</span><span class="token class-name">RedisSerializer</span><span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> template<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>RedisSerializer指定序列化的方式，常用的 string() 和 json()</p> <p>本质上Spring自动注入的StringRedisTemplate就是指定了string()的序列化方式</p></blockquote> <h4 id="_5-2-3-创建demo测试类"><a href="#_5-2-3-创建demo测试类" class="header-anchor">#</a> 5.2.3 创建Demo测试类</h4> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">void</span> <span class="token function">testJson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">ValueOperations</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> ops <span class="token operator">=</span> redisTemplate<span class="token punctuation">.</span><span class="token function">opsForValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">User</span> user <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    user<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    user<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">&quot;董晨旭&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    user<span class="token punctuation">.</span><span class="token function">setBirthday</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ops<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;user1&quot;</span><span class="token punctuation">,</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_5-3-注意事项"><a href="#_5-3-注意事项" class="header-anchor">#</a> 5.3 注意事项</h3> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token comment">&lt;!-- 需要引入jackson本质原因是因为redis使用了json序列化 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.fasterxml.jackson.core<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>jackson-databind<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- 或者直接导入web模块，WEB模块中有依赖jackson-databind --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="_5-4-常用命令操作"><a href="#_5-4-常用命令操作" class="header-anchor">#</a> 5.4 常用命令操作</h3> <blockquote><p>Java验证key的常用命令</p></blockquote> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">void</span> <span class="token function">testKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">ValueOperations</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> ops <span class="token operator">=</span> stringRedisTemplate<span class="token punctuation">.</span><span class="token function">opsForValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">RedisOperations</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> operations <span class="token operator">=</span> ops<span class="token punctuation">.</span><span class="token function">getOperations</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>operations<span class="token punctuation">.</span><span class="token function">getExpire</span><span class="token punctuation">(</span><span class="token string">&quot;aaa&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>operations<span class="token punctuation">.</span><span class="token function">getExpire</span><span class="token punctuation">(</span><span class="token string">&quot;name1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 获取key的值数据类型</span>
    <span class="token class-name">DataType</span> dataType <span class="token operator">=</span> operations<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token string">&quot;name1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>dataType<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="六、redis其他配置及集群【重点】"><a href="#六、redis其他配置及集群【重点】" class="header-anchor">#</a> 六、Redis其他配置及集群【重点】</h2> <blockquote><p>redis默认配置文件中的内容</p></blockquote> <div class="language-properties extra-class"><pre class="language-properties"><code><span class="token comment"># 他的意思是只允许指定的地址来连接</span>
<span class="token key attr-name">bind</span> <span class="token value attr-value">127.0.0.1  </span>

<span class="token comment"># 900秒 如果15分钟内有超过1个key发生变化，就会把redis内存中的数据持久化到磁盘</span>
<span class="token key attr-name">save</span> <span class="token value attr-value">900 1 </span>
<span class="token comment"># 300秒 如果5分钟内有超过10个key发生变化，就会把redis内存中的数据持久化到磁盘</span>
<span class="token key attr-name">save</span> <span class="token value attr-value">300 10</span>
<span class="token comment"># 60秒 如果1分钟内有超过10000个key发生变化，就会把redis内存中的数据持久化到磁盘</span>
<span class="token key attr-name">save</span> <span class="token value attr-value">60 10000</span>

<span class="token comment"># The filename where to dump the DB</span>
<span class="token comment"># 默认持久化文件的名字是 dump.rdb</span>
<span class="token key attr-name">dbfilename</span> <span class="token value attr-value">dump.rdb</span>

<span class="token comment"># requirepass 这个配置项是指定连接redis的密码的，默认没有开启</span>
<span class="token comment"># 如果我们需要指定密码，就把这一项开启，设置一个密码就行</span>
<span class="token comment"># requirepass foobared</span>
</code></pre></div><blockquote><p>修改yml文件，以方便后期修改Redis配置信息</p> <p>./conf redis的配置文件目录</p> <p>./data redis的数据文件</p> <p>command 启动redis并指定配置文件</p></blockquote> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">'3.1'</span>
<span class="token key atrule">services</span><span class="token punctuation">:</span>
  <span class="token key atrule">redis</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> daocloud.io/library/redis<span class="token punctuation">:</span>5.0.7
    <span class="token key atrule">restart</span><span class="token punctuation">:</span> always
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> redis
    <span class="token key atrule">environment</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> TZ=Asia/Shanghai
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> 6379<span class="token punctuation">:</span><span class="token number">6379</span>
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> ./conf/redis.conf<span class="token punctuation">:</span>/usr/local/redis/redis.conf
      <span class="token punctuation">-</span> ./data<span class="token punctuation">:</span>/data
    <span class="token key atrule">command</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;redis-server&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;/usr/local/redis/redis.conf&quot;</span><span class="token punctuation">]</span>
</code></pre></div><h3 id="_6-1-redis的auth"><a href="#_6-1-redis的auth" class="header-anchor">#</a> 6.1 Redis的AUTH</h3> <blockquote><p>通过修改Redis的配置文件，实现Redis的密码校验，</p> <p>需要在docker-compose.yml文件所在目录中创建 conf 和 data目录</p> <p>image-20220824095424074</p> <p>进入conf目录，创建redis.conf文件</p> <p>vi redis.conf</p> <p>配置文件内容如下</p></blockquote> <div class="language-conf extra-class"><pre class="language-text"><code>requirepass 密码
</code></pre></div><p>修改配置文件后重启redis</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># 先停止redis:  </span>
<span class="token function">docker-compose</span> down
<span class="token comment"># 重新启动: </span>
<span class="token function">docker-compose</span> up <span class="token parameter variable">-d</span>
</code></pre></div><blockquote><p>三种客户端的连接方式</p> <ul><li>redis-cli：在输入正常命令之前，先输入auth 密码即可。</li></ul> <p>看到上面的提示，就表示要求输入密码，输入 auth 你的密码</p> <ul><li><p>图形化界面：在连接Redis的信息中添加上验证的密码。</p></li> <li><p>Java客户端：修改application.yml 文件指定redis的password</p></li></ul></blockquote> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">redis</span><span class="token punctuation">:</span>
    <span class="token key atrule">password</span><span class="token punctuation">:</span> <span class="token number">123</span>
    <span class="token key atrule">host</span><span class="token punctuation">:</span> 192.168.174.128
    <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">6379</span>
</code></pre></div><h3 id="_6-2-redis的事务"><a href="#_6-2-redis的事务" class="header-anchor">#</a> 6.2 Redis的事务</h3> <blockquote><p>Redis的事务：一次事务操作，该成功的成功，该失败的失败。</p> <p>先开启事务，执行一些系列命令，但是命令不会立即执行，会被放在一个队列中，如果你执行事务，那么这个队列中的命令全部执行，如果取消了事务，一个队列中的命令全部作废。</p> <ul><li>开启事务：multi</li> <li>输入要执行的命令：被放入到一个队列中</li> <li>执行事务：exec</li> <li>取消事务：discard</li></ul> <p>Redis的事务要想发挥功能，需要配置watch监听机制</p> <p>在开启事务之前，先通过watch命令去监听一个或多个key，在开启事务之后，如果有其他客户端修改了我监听的key，事务会自动取消。</p> <p>如果执行了事务，或者取消了事务，watch监听自动消除，一般不需要手动执行unwatch。</p></blockquote> <h3 id="_6-3-redis持久化机制"><a href="#_6-3-redis持久化机制" class="header-anchor">#</a> 6.3 Redis持久化机制</h3> <h4 id="_6-3-1-rdb"><a href="#_6-3-1-rdb" class="header-anchor">#</a> 6.3.1 RDB</h4> <blockquote><p>RDB是Redis默认的持久化机制</p> <ul><li><p>RDB持久化文件，速度比较快，而且存储的是一个二进制的文件，传输起来很方便。</p></li> <li><p>RDB持久化的时机：</p> <p>save 900 1：在900秒内，有1个key改变了，就执行RDB持久化。</p> <p>save 300 10：在300秒内，有10个key改变了，就执行RDB持久化。</p> <p>save 60 10000：在60秒内，有10000个key改变了，就执行RDB持久化。</p></li> <li><p>RDB无法保证数据的绝对安全。</p></li></ul></blockquote> <p>关闭REDIS服务时可以指定，是否持久化[默认不持久化]</p> <p>重启redis可以验证，redis从磁盘恢复数据到内存中了。</p> <h4 id="_6-3-2-aof"><a href="#_6-3-2-aof" class="header-anchor">#</a> 6.3.2 AOF</h4> <blockquote><p>AOF持久化机制默认是关闭的，Redis官方推荐同时开启RDB和AOF持久化，更安全，避免数据丢失。</p> <ul><li><p>AOF持久化的速度，相对RDB较慢的，存储的是一个文本文件，到了后期文件会比较大，传输困难。</p></li> <li><p>AOF持久化时机。</p> <p>appendfsync always：每执行一个写操作，立即持久化到AOF文件中，性能比较低。
appendfsync everysec：每秒执行一次持久化。
appendfsync no：会根据你的操作系统不同，环境的不同，在一定时间内执行一次持久化。</p></li> <li><p>AOF相对RDB更安全，推荐同时开启AOF和RDB。</p></li></ul></blockquote> <p>AOF相关的配置</p> <div class="language-bash extra-class"><pre class="language-bash"><code>appendonly no
appendfilename <span class="token string">&quot;appendonly.aof&quot;</span>

<span class="token comment"># If unsure, use &quot;everysec&quot;.</span>
<span class="token comment"># 如果你不确定 aof持久化使用哪些配置，建议使用 everysec</span>
<span class="token comment"># appendfsync always</span>
<span class="token comment"># everysec 每秒中持久化一次</span>
appendfsync everysec
<span class="token comment"># appendfsync no</span>
</code></pre></div><p>修改为如下的配置内容</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># 开启AOF持久化</span>
appendonly <span class="token function">yes</span>
appendfilename <span class="token string">&quot;redis.aof&quot;</span>
</code></pre></div><h4 id="_6-3-3-注意事项"><a href="#_6-3-3-注意事项" class="header-anchor">#</a> 6.3.3 注意事项</h4> <blockquote><p>同时开启RDB和AOF的注意事项：</p> <p>如果同时开启了AOF和RDB持久化，那么在Redis宕机重启之后，需要加载一个持久化文件，优先选择AOF文件。</p> <p>如果先开启了RDB，再次开启AOF，如果RDB执行了持久化，那么RDB文件中的内容会被AOF覆盖掉。</p> <p>或者是：建议redis配置完成后，同时开启RDB和AOF备份！</p></blockquote> <h3 id="_6-4-redis的主从架构"><a href="#_6-4-redis的主从架构" class="header-anchor">#</a> 6.4 Redis的主从架构</h3> <blockquote><p>单机版 Redis存在读写瓶颈的问题 110000/s 的 读 81000/s 的写</p></blockquote> <blockquote><p>指定docker-compose.yml文件</p></blockquote> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">&quot;3.1&quot;</span>
<span class="token key atrule">services</span><span class="token punctuation">:</span>
  <span class="token key atrule">redis1</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> daocloud.io/library/redis<span class="token punctuation">:</span>5.0.7
    <span class="token key atrule">restart</span><span class="token punctuation">:</span> always
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> redis1
    <span class="token key atrule">environment</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> TZ=Asia/Shanghai
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> 7001<span class="token punctuation">:</span><span class="token number">6379</span>
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> ./conf/redis1.conf<span class="token punctuation">:</span>/usr/local/redis/redis.conf
    <span class="token key atrule">command</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;redis-server&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;/usr/local/redis/redis.conf&quot;</span><span class="token punctuation">]</span>
  <span class="token key atrule">redis2</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> daocloud.io/library/redis<span class="token punctuation">:</span>5.0.7
    <span class="token key atrule">restart</span><span class="token punctuation">:</span> always
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> redis2
    <span class="token key atrule">environment</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> TZ=Asia/Shanghai
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> 7002<span class="token punctuation">:</span><span class="token number">6379</span>
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> ./conf/redis2.conf<span class="token punctuation">:</span>/usr/local/redis/redis.conf
    <span class="token key atrule">links</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> redis1<span class="token punctuation">:</span>master
    <span class="token key atrule">command</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;redis-server&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;/usr/local/redis/redis.conf&quot;</span><span class="token punctuation">]</span>
  <span class="token key atrule">redis3</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> daocloud.io/library/redis<span class="token punctuation">:</span>5.0.7
    <span class="token key atrule">restart</span><span class="token punctuation">:</span> always
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> redis3
    <span class="token key atrule">environment</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> TZ=Asia/Shanghai
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> 7003<span class="token punctuation">:</span><span class="token number">6379</span>
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> ./conf/redis3.conf<span class="token punctuation">:</span>/usr/local/redis/redis.conf
    <span class="token key atrule">links</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> redis1<span class="token punctuation">:</span>master
    <span class="token key atrule">command</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;redis-server&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;/usr/local/redis/redis.conf&quot;</span><span class="token punctuation">]</span>
</code></pre></div><div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment">#redis1.conf配置文件中什么都不用写</span>

<span class="token comment"># redis2.conf和redis3.conf从节点配置内容如下</span>
replicaof master <span class="token number">6379</span>
</code></pre></div><p>验证：到redis1中写数据，redis2/redis3中会同步数据。</p> <blockquote><p>演示： 在redis1中写数据，redis2和redis3中会自动同步</p></blockquote> <p>主从结构： 读写分离性能扩展 容灾恢复，但是还是存在单点故障问题，就是主节点挂掉 ，redis 服务不可用了，剩下的从节点无法进行写操作，咱们希望的是 主节点挂掉，从节点能够上位。</p> <p>解决这个问题需要使用哨兵模式。</p> <h3 id="_6-5-哨兵"><a href="#_6-5-哨兵" class="header-anchor">#</a> 6.5 哨兵</h3> <blockquote><p>哨兵可以帮助我们解决主从架构中的单点故障问题</p></blockquote> <blockquote><p>1、准备哨兵的配置文件，在conf目录中编写</p> <p>主节点配置：sentinel1.conf</p> <p>从节点配置：sentinel2.conf sentinel3.conf</p></blockquote> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># 禁止保护模式</span>
protected-mode no
<span class="token comment"># 哨兵需要后台启动</span>
daemonize <span class="token function">yes</span>
<span class="token comment"># 指定Master节点的ip和端口（主节点配置）</span>
sentinel monitor master localhost <span class="token number">6379</span> <span class="token number">2</span>
<span class="token comment"># 指定Master节点的ip和端口（从节点配置）</span>
sentinel monitor master master <span class="token number">6379</span> <span class="token number">2</span>
<span class="token comment"># 哨兵每隔多久监听一次redis架构</span>
sentinel down-after-milliseconds master <span class="token number">10000</span>

<span class="token comment">#所有相关的端口号需要在防火墙开启比如 7001 7002 7003 26379（是哨兵通信端口也得开 在哨兵配置文件可以看到） </span>
</code></pre></div><p>完整的配置文件内容如下：</p> <table><thead><tr><th>配置文件</th> <th>内容</th></tr></thead> <tbody><tr><td>redis1.conf</td> <td></td></tr> <tr><td>redis2.conf</td> <td>replicaof master 6379</td></tr> <tr><td>redis3.conf</td> <td>replicaof master 6379</td></tr> <tr><td>sentinel1.conf</td> <td>protected-mode no daemonize yes sentinel monitor master localhost 6379 2 sentinel down-after-milliseconds master 10000</td></tr> <tr><td>sentinel2.conf</td> <td>protected-mode no daemonize yes sentinel monitor master master 6379 2 sentinel down-after-milliseconds master 10000</td></tr> <tr><td>sentinel3.conf</td> <td>protected-mode no daemonize yes sentinel monitor master master 6379 2 sentinel down-after-milliseconds master 10000</td></tr></tbody></table> <blockquote><p>修改了以下docker-compose.yml，为了可以在容器内部使用哨兵的配置</p></blockquote> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">&quot;3.1&quot;</span>
<span class="token key atrule">services</span><span class="token punctuation">:</span>
  <span class="token key atrule">redis1</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> daocloud.io/library/redis<span class="token punctuation">:</span>5.0.7
    <span class="token key atrule">restart</span><span class="token punctuation">:</span> always
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> redis1
    <span class="token key atrule">environment</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> TZ=Asia/Shanghai
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> 7001<span class="token punctuation">:</span><span class="token number">6379</span>
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> ./conf/redis1.conf<span class="token punctuation">:</span>/usr/local/redis/redis.conf
      <span class="token punctuation">-</span> ./conf/sentinel1.conf<span class="token punctuation">:</span>/data/sentinel.conf        <span class="token comment"># 添加的内容</span>
    <span class="token key atrule">command</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;redis-server&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;/usr/local/redis/redis.conf&quot;</span><span class="token punctuation">]</span>
  <span class="token key atrule">redis2</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> daocloud.io/library/redis<span class="token punctuation">:</span>5.0.7
    <span class="token key atrule">restart</span><span class="token punctuation">:</span> always
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> redis2
    <span class="token key atrule">environment</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> TZ=Asia/Shanghai
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> 7002<span class="token punctuation">:</span><span class="token number">6379</span>
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> ./conf/redis2.conf<span class="token punctuation">:</span>/usr/local/redis/redis.conf
      <span class="token punctuation">-</span> ./conf/sentinel2.conf<span class="token punctuation">:</span>/data/sentinel.conf        <span class="token comment"># 添加的内容</span>
    <span class="token key atrule">links</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> redis1<span class="token punctuation">:</span>master
    <span class="token key atrule">command</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;redis-server&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;/usr/local/redis/redis.conf&quot;</span><span class="token punctuation">]</span>
  <span class="token key atrule">redis3</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> daocloud.io/library/redis<span class="token punctuation">:</span>5.0.7
    <span class="token key atrule">restart</span><span class="token punctuation">:</span> always
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> redis3
    <span class="token key atrule">environment</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> TZ=Asia/Shanghai
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> 7003<span class="token punctuation">:</span><span class="token number">6379</span>
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> ./conf/redis3.conf<span class="token punctuation">:</span>/usr/local/redis/redis.conf
      <span class="token punctuation">-</span> ./conf/sentinel3.conf<span class="token punctuation">:</span>/data/sentinel.conf        <span class="token comment"># 添加的内容 </span>
    <span class="token key atrule">links</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> redis1<span class="token punctuation">:</span>master
    <span class="token key atrule">command</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;redis-server&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;/usr/local/redis/redis.conf&quot;</span><span class="token punctuation">]</span>
</code></pre></div><blockquote><p>启动docker-compose， docker-compose up -d</p> <p>然后在Redis容器内部手动启动哨兵即可 redis-sentinel sentinel.conf 三台机器的哨兵都需要启动</p> <p>image-20220529200653149</p></blockquote> <p>哨兵模式 主节点 挂掉之后 在从机中选出新的主节点，哪个从机会被选为新的主节点？</p> <p>根据 配置文件的replica-priority 100 这个配置 这个值越小 优先级越高</p> <blockquote><p>验证哨兵：redis主节点停止后，redis会重新选择一个节点作为主节点</p></blockquote> <h3 id="_6-6-redis的集群"><a href="#_6-6-redis的集群" class="header-anchor">#</a> 6.6 Redis的集群</h3> <blockquote><p>前面的主从复制 解决了 redis 的 读写压力问题 ，分出了两个从节点 分担了 读取数据的压力</p> <p>哨兵 解决了单点故障的问题 当有一个 master 节点 挂掉了 自动投票选举 出来一个 master 保证 主从架构正常执行 但是 这种架构还有一种问题 就是 存储的数据有限 ，也就是当数据量很大的时候 一个redis 存不下，上面的 一个 redis 主节点 无法存储这么多的数据 此时 就需要集群了</p> <p>Redis集群在保证主从加哨兵的基本功能之外，还能够提升Redis存储数据的能力。</p></blockquote> <blockquote><p>注意 这里的从节点 跟上面的一主二从的 从节点不一样 ，这里的从节点 只负责备份主节点的数据 不负责分担主节点的读压力，而是一直看主节点干活 如果发现主节点挂掉了 马上顶替主节点干活</p> <p>那么 如果某个节点上的一些数据 查询频率太高 也可以针对某一个节点 搭建 读写分离的那种 主从</p> <p>主从 哨兵 和 集群 是三个概念</p> <p>集群中的节点 超过半数挂掉 那么 整个集群服务就不可用了</p> <p>如果某一个主节点挂掉 那么从节点顶上来做主节点 这个过程 是由其他节点选举</p> <p>如果某一个主从节点都挂掉了 redis集群是否还能提供服务要看下面的配置</p> <p>cluster-require-full-coverage yes 那么 整个集群都挂掉</p> <p>cluster-require-full-coverage no 该节点不可用 该节点上的插槽都不能使用 其他节点正常使用</p></blockquote> <div class="language-text extra-class"><pre class="language-text"><code>正常的心跳数据包携带节点的完整配置，它能以幂等方式来更新配置。如果采用 16384 个插槽，占空间 2KB （16384/8）；如果采用 65536 个插槽，占空间 8KB (65536/8)。
Redis Cluster 不太可能扩展到超过 1000 个主节点，太多可能导致网络拥堵。
16384 个插槽范围比较合适，当集群扩展到1000个节点时，也能确保每个master节点有足够的插槽，
8KB 的心跳包看似不大，但是这个是心跳包每秒都要将本节点的信息同步给集群其他节点。比起 16384 个插槽，头大小增加了4倍，ping消息的消息头太大了，浪费带宽。
</code></pre></div><blockquote><p>创建docker_redis_cluster目录，准备yml文件</p></blockquote> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token comment"># docker-compose.yml</span>
<span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">&quot;3.1&quot;</span>
<span class="token key atrule">services</span><span class="token punctuation">:</span>
  <span class="token key atrule">redis1</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> daocloud.io/library/redis<span class="token punctuation">:</span>5.0.7
    <span class="token key atrule">restart</span><span class="token punctuation">:</span> always
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> redis1
    <span class="token key atrule">environment</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> TZ=Asia/Shanghai
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> 7001<span class="token punctuation">:</span><span class="token number">7001</span>
      <span class="token punctuation">-</span> 17001<span class="token punctuation">:</span><span class="token number">17001</span>
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> ./conf/redis1.conf<span class="token punctuation">:</span>/usr/local/redis/redis.conf
    <span class="token key atrule">command</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;redis-server&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;/usr/local/redis/redis.conf&quot;</span><span class="token punctuation">]</span>
  <span class="token key atrule">redis2</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> daocloud.io/library/redis<span class="token punctuation">:</span>5.0.7
    <span class="token key atrule">restart</span><span class="token punctuation">:</span> always
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> redis2
    <span class="token key atrule">environment</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> TZ=Asia/Shanghai
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> 7002<span class="token punctuation">:</span><span class="token number">7002</span>
      <span class="token punctuation">-</span> 17002<span class="token punctuation">:</span><span class="token number">17002</span>
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> ./conf/redis2.conf<span class="token punctuation">:</span>/usr/local/redis/redis.conf
    <span class="token key atrule">command</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;redis-server&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;/usr/local/redis/redis.conf&quot;</span><span class="token punctuation">]</span>  
  <span class="token key atrule">redis3</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> daocloud.io/library/redis<span class="token punctuation">:</span>5.0.7
    <span class="token key atrule">restart</span><span class="token punctuation">:</span> always
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> redis3
    <span class="token key atrule">environment</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> TZ=Asia/Shanghai
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> 7003<span class="token punctuation">:</span><span class="token number">7003</span>
      <span class="token punctuation">-</span> 17003<span class="token punctuation">:</span><span class="token number">17003</span>
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> ./conf/redis3.conf<span class="token punctuation">:</span>/usr/local/redis/redis.conf
    <span class="token key atrule">command</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;redis-server&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;/usr/local/redis/redis.conf&quot;</span><span class="token punctuation">]</span>  
  <span class="token key atrule">redis4</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> daocloud.io/library/redis<span class="token punctuation">:</span>5.0.7
    <span class="token key atrule">restart</span><span class="token punctuation">:</span> always
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> redis4
    <span class="token key atrule">environment</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> TZ=Asia/Shanghai
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> 7004<span class="token punctuation">:</span><span class="token number">7004</span>
      <span class="token punctuation">-</span> 17004<span class="token punctuation">:</span><span class="token number">17004</span>
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> ./conf/redis4.conf<span class="token punctuation">:</span>/usr/local/redis/redis.conf
    <span class="token key atrule">command</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;redis-server&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;/usr/local/redis/redis.conf&quot;</span><span class="token punctuation">]</span>  
  <span class="token key atrule">redis5</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> daocloud.io/library/redis<span class="token punctuation">:</span>5.0.7
    <span class="token key atrule">restart</span><span class="token punctuation">:</span> always
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> redis5
    <span class="token key atrule">environment</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> TZ=Asia/Shanghai
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> 7005<span class="token punctuation">:</span><span class="token number">7005</span>
      <span class="token punctuation">-</span> 17005<span class="token punctuation">:</span><span class="token number">17005</span>
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> ./conf/redis5.conf<span class="token punctuation">:</span>/usr/local/redis/redis.conf
    <span class="token key atrule">command</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;redis-server&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;/usr/local/redis/redis.conf&quot;</span><span class="token punctuation">]</span>  
  <span class="token key atrule">redis6</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> daocloud.io/library/redis<span class="token punctuation">:</span>5.0.7
    <span class="token key atrule">restart</span><span class="token punctuation">:</span> always
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> redis6
    <span class="token key atrule">environment</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> TZ=Asia/Shanghai
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> 7006<span class="token punctuation">:</span><span class="token number">7006</span>
      <span class="token punctuation">-</span> 17006<span class="token punctuation">:</span><span class="token number">17006</span>
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> ./conf/redis6.conf<span class="token punctuation">:</span>/usr/local/redis/redis.conf
    <span class="token key atrule">command</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;redis-server&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;/usr/local/redis/redis.conf&quot;</span><span class="token punctuation">]</span>  
</code></pre></div><blockquote><p>配置文件，创建redis1.conf redis2.conf ... redis6.conf</p> <p>配置文件内容类似，需要修改为不同的端口</p></blockquote> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># redis1.conf</span>
<span class="token comment"># 指定redis的端口号</span>
port <span class="token number">7001</span>
<span class="token comment"># 开启Redis集群</span>
cluster-enabled <span class="token function">yes</span>
<span class="token comment"># 集群信息的文件</span>
cluster-config-file nodes-7001.conf
<span class="token comment"># 集群的对外ip地址【这个IP地址需要改成自己的】</span>
cluster-announce-ip <span class="token number">192.168</span>.29.110
<span class="token comment"># 集群的对外port</span>
cluster-announce-port <span class="token number">7001</span>
<span class="token comment"># 集群的总线端口</span>
cluster-announce-bus-port <span class="token number">17001</span>
</code></pre></div><p>替换操作可以使用vi编辑器的替换命令</p> <div class="language- extra-class"><pre class="language-text"><code>:.,%s/7001/7002/g
</code></pre></div><p>进入尾行模式 ., 表示同从第一行到最后一行 %s 字符替换</p> <p>/7701 要替换的字串 /7002 替换为 /g 全局替换</p> <blockquote><p>通过docker-compose启动了6个Redis的节点。 切记开启所有相关的端口号 重启防火墙 重启docker服务</p> <p>随便跳转到一个容器内部，使用redis-cli管理集群</p></blockquote> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># 【这个IP地址需要改成自己的】</span>
redis-cli <span class="token parameter variable">--cluster</span> create <span class="token number">192.168</span>.29.110:7001 <span class="token number">192.168</span>.29.110:7002  <span class="token number">192.168</span>.29.110:7003  <span class="token number">192.168</span>.29.110:7004  <span class="token number">192.168</span>.29.110:7005  <span class="token number">192.168</span>.29.110:7006 --cluster-replicas <span class="token number">1</span>
</code></pre></div><blockquote><p>验证：操作集群</p></blockquote> <div class="language-bash extra-class"><pre class="language-bash"><code>redis-cli 操作集群

<span class="token comment"># -c 实现自动重定向</span>
<span class="token comment"># -h 指定IP地址 【这个IP地址需要改成自己的】</span>
<span class="token comment"># -p 指定端口号</span>
redis-cli <span class="token parameter variable">-c</span> <span class="token parameter variable">-h</span> <span class="token number">192.168</span>.29.110 <span class="token parameter variable">-p</span> <span class="token number">7001</span> 
</code></pre></div><h3 id="_6-7-java连接redis集群"><a href="#_6-7-java连接redis集群" class="header-anchor">#</a> 6.7 Java连接Redis集群</h3> <blockquote><p>SpringBoot连接Redis集群，只需要修改配置文件，增加集群配置即可</p></blockquote> <p>SpringBoot配置文件</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">redis</span><span class="token punctuation">:</span>
    <span class="token key atrule">cluster</span><span class="token punctuation">:</span>
      <span class="token comment"># 集群IP和PORT</span>
      <span class="token key atrule">nodes</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> 192.168.29.110<span class="token punctuation">:</span><span class="token number">7001</span>
        <span class="token punctuation">-</span> 192.168.29.110<span class="token punctuation">:</span><span class="token number">7002</span>
        <span class="token punctuation">-</span> 192.168.29.110<span class="token punctuation">:</span><span class="token number">7003</span>
        <span class="token punctuation">-</span> 192.168.29.110<span class="token punctuation">:</span><span class="token number">7004</span>
        <span class="token punctuation">-</span> 192.168.29.110<span class="token punctuation">:</span><span class="token number">7005</span>
        <span class="token punctuation">-</span> 192.168.29.110<span class="token punctuation">:</span><span class="token number">7006</span>
      <span class="token comment"># 跨集群执行命令时要遵循的最大重定向数</span>
      <span class="token key atrule">max-redirects</span><span class="token punctuation">:</span> <span class="token number">3</span>
    <span class="token key atrule">lettuce</span><span class="token punctuation">:</span>
      <span class="token key atrule">pool</span><span class="token punctuation">:</span>
        <span class="token key atrule">max-active</span><span class="token punctuation">:</span> <span class="token number">1024</span>
        <span class="token key atrule">max-wait</span><span class="token punctuation">:</span> <span class="token number">10000</span>
        <span class="token key atrule">max-idle</span><span class="token punctuation">:</span> <span class="token number">10</span>
        <span class="token key atrule">min-idle</span><span class="token punctuation">:</span> <span class="token number">5</span>
</code></pre></div><p>正常测试</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">void</span> <span class="token function">testCluster</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">ValueOperations</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> ops <span class="token operator">=</span> stringRedisTemplate<span class="token punctuation">.</span><span class="token function">opsForValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ops<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;哈哈&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Redis管道方式测试【了解】</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">void</span> <span class="token function">testPipeline</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 管道命令</span>
    <span class="token class-name">SessionCallback</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> sessionCallback <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SessionCallback</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">execute</span><span class="token punctuation">(</span><span class="token class-name">RedisOperations</span> operations<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">DataAccessException</span> <span class="token punctuation">{</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">1000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                operations<span class="token punctuation">.</span><span class="token function">boundValueOps</span><span class="token punctuation">(</span><span class="token string">&quot;cluster:&quot;</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;集群&quot;</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    redisTemplate<span class="token punctuation">.</span><span class="token function">executePipelined</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="七、redis常见问题【重点】"><a href="#七、redis常见问题【重点】" class="header-anchor">#</a> 七、Redis常见问题【重点】</h2> <h3 id="_7-1-key的生存时间到了-redis会立即删除吗"><a href="#_7-1-key的生存时间到了-redis会立即删除吗" class="header-anchor">#</a> 7.1 key的生存时间到了，Redis会立即删除吗？</h3> <blockquote><p>不会立即删除。</p> <ul><li>定期删除：Redis每隔一段时间就去会去查看Redis设置了过期时间的key，会再100ms的间隔中默认查看3个key。</li> <li>惰性删除：如果当你去查询一个已经过了生存时间的key时，Redis会先查看当前key的生存时间，是否已经到了，直接删除当前key，并且给用户返回一个空值。</li></ul></blockquote> <h3 id="_7-2-redis的淘汰机制"><a href="#_7-2-redis的淘汰机制" class="header-anchor">#</a> 7.2 Redis的淘汰机制</h3> <blockquote><p>在Redis内存已经满的时候，添加了一个新的数据，执行淘汰机制。</p> <ul><li>volatile-lru：在内存不足时，Redis会在设置过了生存时间的key中干掉一个最近最少使用的key。</li> <li>allkeys-lru：在内存不足时，Redis会再全部的key中干掉一个最近最少使用的key。</li> <li>volatile-lfu：在内存不足时，Redis会再设置过了生存时间的key中干掉一个最近最少频次使用的key。</li> <li>allkeys-lfu：在内存不足时，Redis会再全部的key中干掉一个最近最少频次使用的key。</li> <li>volatile-random：在内存不足时，Redis会再设置过了生存时间的key中随机干掉一个。</li> <li>allkeys-random：在内存不足时，Redis会再全部的key中随机干掉一个。</li> <li>volatile-ttl：在内存不足时，Redis会在设置过了生存时间的key中干掉一个剩余生存时间最少的key。</li> <li>noeviction：（默认）在内存不足时，直接报错。</li></ul> <p>指定淘汰机制的方式：maxmemory-policy 具体策略，设置Redis的最大内存：maxmemory 字节大小
内存配置
(1)、内存设置</p> <p>①、如果不设置内存大小或者设置内存大小为0，在64位操作系统下不限制内存大小，在32位操作系统下最多使用3GB内存。
②、Redis一般推荐设置内存为最大物理内存的四分之三。</p> <p>(2)、修改文件配置
修改maxmemory大小，单位字节</p></blockquote> <h3 id="_7-3-缓存的常问题"><a href="#_7-3-缓存的常问题" class="header-anchor">#</a> 7.3 缓存的常问题</h3> <h4 id="_7-3-1-缓存穿透问题"><a href="#_7-3-1-缓存穿透问题" class="header-anchor">#</a> 7.3.1 缓存穿透问题</h4> <blockquote><p>缓存穿透</p> <p>个人理解：指查询一个一定不存在的数据，由于缓存是不命中的，将去查询数据库，但是数据库也没有这个数据，更糟糕的是我们没有把这次查询的 null 结果 写入缓存，这将导致这个不存在的数据每次查询 都走数据库。 缓存也就没有意义了</p> <p>风险: 利用不存在的数据 进行攻击 数据库瞬时压力增大 可能导致崩溃</p> <p>解决：将null 结果放入 缓存 ，最好 加入一个 过期时间</p></blockquote> <h4 id="_7-3-2-缓存击穿问题"><a href="#_7-3-2-缓存击穿问题" class="header-anchor">#</a> 7.3.2 缓存击穿问题</h4> <blockquote><p>缓存击穿</p> <p>个人理解：对于某些热点数据 可能设置了过期时间 或者 在 第一次访问之前缓存中没有 在某一刻的高并发访问 都没有命中缓存，都查询了数据库 这称之为 缓存击穿</p> <p>解决方案：加锁</p> <p>预先设置下热点数据</p></blockquote> <h4 id="_7-3-3-缓存雪崩问题"><a href="#_7-3-3-缓存雪崩问题" class="header-anchor">#</a> 7.3.3 缓存雪崩问题</h4> <blockquote><p>缓存雪崩</p> <p>个人理解：我们在设置缓存的 key 时 采用了相同的过期时间 导致缓存在某一时刻同时失效 请求全部转到数据库 数据库瞬时压力大 造成雪崩</p> <p>解决方案：设置key 的时候 在原有的过期时间上 加上一个 随机值 比如 1-5 分钟的随机值 这样 每一个缓存key 的过期时间 重复率就会降低</p></blockquote> <h4 id="_7-3-4-缓存倾斜问题"><a href="#_7-3-4-缓存倾斜问题" class="header-anchor">#</a> 7.3.4 缓存倾斜问题</h4> <blockquote><p>缓存倾斜</p> <p>问题：热点数据放在了一个Redis节点上，导致Redis节点无法承受住大量的请求，最终Redis宕机。</p> <p>1.扩展主从架构，搭建大量的从节点，缓解Redis的压力。</p> <p>2.可以在Tomcat中JVM缓存，在查看Redis之前，先去查询Tomcat中的缓存。</p></blockquote> <h2 id="八、redis的使用场景"><a href="#八、redis的使用场景" class="header-anchor">#</a> 八、Redis的使用场景</h2> <p>缓存和数据库的一致性问题，最终解决方案：延迟双删！</p> <p>redis延迟双删的策略</p> <p>1.为什么要进行延迟双删
一般我们在更新数据库数据时，需要同步redis中缓存的数据
所以存在两种方法：
（1）第一种方案：先执行update操作，再执行缓存清除。
（2）第二种方案：先执行缓存清除，再执行update操作。</p> <p>弊端:当存在并发请求时，很容易出现问题
（1）第一种方案：当请求1执行update操作后，还未来得及进行缓存清除，此时请求2查询到并使用了redis中的旧数据。
（2）第二种方案：当请求1执行清除缓存后，还未进行update操作，此时请求2进行查询到了旧数据并写入了redis。</p> <p>2.如何实现延迟双删
所以此时我们需要使用第三种方案：
先进行缓存清除，再执行update，最后（延迟N秒）再执行缓存清除。</p> <p>3.需要注意的点
上述中（延迟N秒）的时间要大于一次写操作的时间，一般为3-5秒。
原因：如果延迟时间小于写入redis的时间，会导致请求1清除了缓存，但是请求2缓存还未写入的尴尬。。。</p></div></section> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev"><a href="/数据库/MySQL/MySQL-多数据源配置.html" class="prev">
          MySQL-多数据源配置
        </a></span> <span class="next"><a href="/数据库/Redis/redis-lock.html">
          Redis-lock
        </a></span></p></div> <div class="comments-wrapper"><!----></div></main></div> <!----></div> <ul class="sub-sidebar sub-sidebar-wrapper" style="width:12rem;" data-v-b57cc07c data-v-7dd95ae2><li class="level-2" data-v-b57cc07c><a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/Redis/Redis.html#一、引言" class="sidebar-link reco-side-一、引言" data-v-b57cc07c>一、引言</a></li><li class="level-3" data-v-b57cc07c><a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/Redis/Redis.html#_1-1-数据库压力过大" class="sidebar-link reco-side-_1-1-数据库压力过大" data-v-b57cc07c>1.1 数据库压力过大</a></li><li class="level-3" data-v-b57cc07c><a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/Redis/Redis.html#_1-2-数据不同步" class="sidebar-link reco-side-_1-2-数据不同步" data-v-b57cc07c>1.2 数据不同步</a></li><li class="level-3" data-v-b57cc07c><a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/Redis/Redis.html#_1-3-传统锁失效" class="sidebar-link reco-side-_1-3-传统锁失效" data-v-b57cc07c>1.3 传统锁失效</a></li><li class="level-2" data-v-b57cc07c><a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/Redis/Redis.html#二、redis介绍" class="sidebar-link reco-side-二、redis介绍" data-v-b57cc07c>二、Redis介绍</a></li><li class="level-3" data-v-b57cc07c><a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/Redis/Redis.html#_2-1-nosql介绍" class="sidebar-link reco-side-_2-1-nosql介绍" data-v-b57cc07c>2.1 NoSQL介绍</a></li><li class="level-3" data-v-b57cc07c><a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/Redis/Redis.html#_2-2-redis介绍" class="sidebar-link reco-side-_2-2-redis介绍" data-v-b57cc07c>2.2 Redis介绍</a></li><li class="level-2" data-v-b57cc07c><a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/Redis/Redis.html#三、redis安装" class="sidebar-link reco-side-三、redis安装" data-v-b57cc07c>三、Redis安装</a></li><li class="level-3" data-v-b57cc07c><a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/Redis/Redis.html#_3-1-安装redis" class="sidebar-link reco-side-_3-1-安装redis" data-v-b57cc07c>3.1 安装Redis</a></li><li class="level-3" data-v-b57cc07c><a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/Redis/Redis.html#_3-2-使用redis-cli连接redis" class="sidebar-link reco-side-_3-2-使用redis-cli连接redis" data-v-b57cc07c>3.2 使用redis-cli连接Redis</a></li><li class="level-3" data-v-b57cc07c><a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/Redis/Redis.html#_3-3-使用图形化界面连接redis" class="sidebar-link reco-side-_3-3-使用图形化界面连接redis" data-v-b57cc07c>3.3 使用图形化界面连接Redis</a></li><li class="level-2" data-v-b57cc07c><a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/Redis/Redis.html#四、redis常用命令【重点】" class="sidebar-link reco-side-四、redis常用命令【重点】" data-v-b57cc07c>四、Redis常用命令【重点】</a></li><li class="level-3" data-v-b57cc07c><a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/Redis/Redis.html#_4-1-redis存储数据的结构" class="sidebar-link reco-side-_4-1-redis存储数据的结构" data-v-b57cc07c>4.1 Redis存储数据的结构</a></li><li class="level-3" data-v-b57cc07c><a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/Redis/Redis.html#_4-2-string常用命令" class="sidebar-link reco-side-_4-2-string常用命令" data-v-b57cc07c>4.2 string常用命令</a></li><li class="level-3" data-v-b57cc07c><a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/Redis/Redis.html#_4-3-hash常用命令" class="sidebar-link reco-side-_4-3-hash常用命令" data-v-b57cc07c>4.3 hash常用命令</a></li><li class="level-3" data-v-b57cc07c><a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/Redis/Redis.html#_4-4-list常用命令" class="sidebar-link reco-side-_4-4-list常用命令" data-v-b57cc07c>4.4 list常用命令</a></li><li class="level-3" data-v-b57cc07c><a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/Redis/Redis.html#_4-5-set常用命令" class="sidebar-link reco-side-_4-5-set常用命令" data-v-b57cc07c>4.5 set常用命令</a></li><li class="level-3" data-v-b57cc07c><a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/Redis/Redis.html#_4-6-zset的常用命令" class="sidebar-link reco-side-_4-6-zset的常用命令" data-v-b57cc07c>4.6 zset的常用命令</a></li><li class="level-3" data-v-b57cc07c><a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/Redis/Redis.html#_4-7-key常用命令" class="sidebar-link reco-side-_4-7-key常用命令" data-v-b57cc07c>4.7 key常用命令</a></li><li class="level-3" data-v-b57cc07c><a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/Redis/Redis.html#_4-8-库的常用命令" class="sidebar-link reco-side-_4-8-库的常用命令" data-v-b57cc07c>4.8 库的常用命令</a></li><li class="level-2" data-v-b57cc07c><a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/Redis/Redis.html#五、java连接redis【重点】" class="sidebar-link reco-side-五、java连接redis【重点】" data-v-b57cc07c>五、Java连接Redis【重点】</a></li><li class="level-3" data-v-b57cc07c><a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/Redis/Redis.html#_5-1-springboot连接redis" class="sidebar-link reco-side-_5-1-springboot连接redis" data-v-b57cc07c>5.1 SpringBoot连接Redis</a></li><li class="level-3" data-v-b57cc07c><a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/Redis/Redis.html#_5-2-存储一个对象到redis以json的形式" class="sidebar-link reco-side-_5-2-存储一个对象到redis以json的形式" data-v-b57cc07c>5.2 存储一个对象到Redis以json的形式</a></li><li class="level-3" data-v-b57cc07c><a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/Redis/Redis.html#_5-3-注意事项" class="sidebar-link reco-side-_5-3-注意事项" data-v-b57cc07c>5.3 注意事项</a></li><li class="level-3" data-v-b57cc07c><a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/Redis/Redis.html#_5-4-常用命令操作" class="sidebar-link reco-side-_5-4-常用命令操作" data-v-b57cc07c>5.4 常用命令操作</a></li><li class="level-2" data-v-b57cc07c><a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/Redis/Redis.html#六、redis其他配置及集群【重点】" class="sidebar-link reco-side-六、redis其他配置及集群【重点】" data-v-b57cc07c>六、Redis其他配置及集群【重点】</a></li><li class="level-3" data-v-b57cc07c><a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/Redis/Redis.html#_6-1-redis的auth" class="sidebar-link reco-side-_6-1-redis的auth" data-v-b57cc07c>6.1 Redis的AUTH</a></li><li class="level-3" data-v-b57cc07c><a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/Redis/Redis.html#_6-2-redis的事务" class="sidebar-link reco-side-_6-2-redis的事务" data-v-b57cc07c>6.2 Redis的事务</a></li><li class="level-3" data-v-b57cc07c><a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/Redis/Redis.html#_6-3-redis持久化机制" class="sidebar-link reco-side-_6-3-redis持久化机制" data-v-b57cc07c>6.3 Redis持久化机制</a></li><li class="level-3" data-v-b57cc07c><a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/Redis/Redis.html#_6-4-redis的主从架构" class="sidebar-link reco-side-_6-4-redis的主从架构" data-v-b57cc07c>6.4 Redis的主从架构</a></li><li class="level-3" data-v-b57cc07c><a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/Redis/Redis.html#_6-5-哨兵" class="sidebar-link reco-side-_6-5-哨兵" data-v-b57cc07c>6.5 哨兵</a></li><li class="level-3" data-v-b57cc07c><a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/Redis/Redis.html#_6-6-redis的集群" class="sidebar-link reco-side-_6-6-redis的集群" data-v-b57cc07c>6.6 Redis的集群</a></li><li class="level-3" data-v-b57cc07c><a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/Redis/Redis.html#_6-7-java连接redis集群" class="sidebar-link reco-side-_6-7-java连接redis集群" data-v-b57cc07c>6.7 Java连接Redis集群</a></li><li class="level-2" data-v-b57cc07c><a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/Redis/Redis.html#七、redis常见问题【重点】" class="sidebar-link reco-side-七、redis常见问题【重点】" data-v-b57cc07c>七、Redis常见问题【重点】</a></li><li class="level-3" data-v-b57cc07c><a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/Redis/Redis.html#_7-1-key的生存时间到了-redis会立即删除吗" class="sidebar-link reco-side-_7-1-key的生存时间到了-redis会立即删除吗" data-v-b57cc07c>7.1 key的生存时间到了，Redis会立即删除吗？</a></li><li class="level-3" data-v-b57cc07c><a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/Redis/Redis.html#_7-2-redis的淘汰机制" class="sidebar-link reco-side-_7-2-redis的淘汰机制" data-v-b57cc07c>7.2 Redis的淘汰机制</a></li><li class="level-3" data-v-b57cc07c><a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/Redis/Redis.html#_7-3-缓存的常问题" class="sidebar-link reco-side-_7-3-缓存的常问题" data-v-b57cc07c>7.3 缓存的常问题</a></li><li class="level-2" data-v-b57cc07c><a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/Redis/Redis.html#八、redis的使用场景" class="sidebar-link reco-side-八、redis的使用场景" data-v-b57cc07c>八、Redis的使用场景</a></li></ul></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div></div></div>
    <script src="/assets/js/app.9ff2d364.js" defer></script><script src="/assets/js/3.531b82cf.js" defer></script><script src="/assets/js/1.66bfa7cb.js" defer></script><script src="/assets/js/143.b21df084.js" defer></script>
  </body>
</html>
