(window.webpackJsonp=window.webpackJsonp||[]).push([[59],{476:function(s,t,a){"use strict";a.r(t);var e=a(2),n=Object(e.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"_1-实体类字段不一致-entity"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-实体类字段不一致-entity"}},[s._v("#")]),s._v(" 1 实体类字段不一致 entity")]),s._v(" "),t("blockquote",[t("p",[s._v("今天看一个很久老项目日志时，发现有一个定时任务报错了，打debug发现发送方多发了几个字段过来了，")]),s._v(" "),t("p",[s._v('"videoClipstimeSegment"]->java.util.ArrayList[0]->com.dataojo.huhehaotebasic.model.master.entity.VideoClipstimeSegment["beginTime"])')]),s._v(" "),t("p",[s._v("因为我接收的时候没有这些字段就报错了")])]),s._v(" "),t("p",[s._v("问题出在JSON反序列化过程中，"),t("code",[s._v("VideoClipstimeSegment")]),s._v(' 类型的对象包含了 "beginTime" 属性，而这个属性在对应的 Java 类中并未定义（已知的属性有 "from", "to", "type"）。为了解决这个问题，您可以采取以下几种方式：')]),s._v(" "),t("h2",{attrs:{id:"更新-videoclipstimesegment-类"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#更新-videoclipstimesegment-类"}},[s._v("#")]),s._v(" 更新 VideoClipstimeSegment 类")]),s._v(" "),t("p",[s._v("如果您控制了 "),t("code",[s._v("VideoClipstimeSegment")]),s._v(' 类的源代码，那么可以在其中添加一个与 JSON 对应的 "beginTime" 字段，并提供其 getter 和 setter 方法。')]),s._v(" "),t("p",[s._v("Java")]),s._v(" "),t("div",{staticClass:"language-java extra-class"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("public "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("VideoClipstimeSegment")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Long")]),s._v(" from"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Long")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("to")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Integer")]),s._v(" type"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 添加 beginTime 字段")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Long")]),s._v(" beginTime"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Long")]),s._v(" endTime"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" flag"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// getter 和 setter 方法...")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),t("h2",{attrs:{id:"忽略未知属性-jsonignoreproperties-ignoreunknown-true"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#忽略未知属性-jsonignoreproperties-ignoreunknown-true"}},[s._v("#")]),s._v(" 忽略未知属性 @JsonIgnoreProperties(ignoreUnknown = true)")]),s._v(" "),t("p",[s._v('如果不想在类中添加 "beginTime" 字段，可以使用 Jackson 的 '),t("code",[s._v("@JsonIgnoreProperties")]),s._v(" 注解来忽略未知属性。")]),s._v(" "),t("p",[s._v("Java")]),s._v(" "),t("div",{staticClass:"language-java extra-class"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("import "),t("span",{pre:!0,attrs:{class:"token class-name"}},[t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("com"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("fasterxml"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("jackson"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("annotation"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),s._v("JsonIgnoreProperties")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@JsonIgnoreProperties")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ignoreUnknown "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("public "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("VideoClipstimeSegment")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ...")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),t("h2",{attrs:{id:"自定义反序列化逻辑"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#自定义反序列化逻辑"}},[s._v("#")]),s._v(" "),t("strong",[s._v("自定义反序列化逻辑")])]),s._v(" "),t("p",[s._v('如果需要更复杂的处理，比如将 "beginTime" 映射到已存在的某个字段上，可以通过实现 '),t("code",[s._v("JsonDeserializer")]),s._v(" 或重写 "),t("code",[s._v("@JsonCreator")]),s._v(" 来自定义反序列化过程。")]),s._v(" "),t("p",[s._v("在进行了上述优化后，请确保重新构建并部署应用以使更改生效。同时，由于您的代码涉及数据库操作且使用了事务管理，确保在处理此类异常时能够正确回滚事务也是十分重要的。")])])}),[],!1,null,null,null);t.default=n.exports}}]);