(window.webpackJsonp=window.webpackJsonp||[]).push([[55],{470:function(e,t,n){"use strict";n.r(t);var r=n(2),s=Object(r.a)({},(function(){var e=this,t=e._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h2",{attrs:{id:"_1-nginx-跨域代理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-nginx-跨域代理"}},[e._v("#")]),e._v(" 1 nginx 跨域代理")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("location /proxy/gateway/ {\n    proxy_pass http://10.100.12.34/gateway/;\n    proxy_set_header Host $host;\n    proxy_set_header X-Real-IP $remote_addr;\n    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n    add_header 'Access-Control-Allow-Origin' '*';\n    add_header 'Access-Control-Allow-Methods' 'GET, POST, OPTIONS';\n    add_header 'Access-Control-Allow-Headers' 'DNT,X-CustomHeader,Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type';\n    add_header 'Access-Control-Max-Age' 1728000;\n    if ($request_method = 'OPTIONS') {\n        return 204;\n    }\n}\n")])])]),t("h2",{attrs:{id:"_2-java配置跨域过滤器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-java配置跨域过滤器"}},[e._v("#")]),e._v(" 2 Java配置跨域过滤器")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('public class CrossFilter implements Filter {\n\n    @Override\n    public void init(FilterConfig filterConfig) throws ServletException {\n        // do nothing\n    }\n\n    @Override\n    public void doFilter(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain) throws IOException, ServletException {\n        HttpServletResponse response = (HttpServletResponse) servletResponse;\n        response.setHeader("Access-Control-Allow-Origin", "*");\n        response.setHeader("Access-Control-Allow-Methods", "*");\n        response.setHeader("Access-Control-Allow-Headers", "Origin, No-Cache, X-Requested-With, Cache-Control, Content-Type,Authorization");\n        response.setHeader("Access-Control-Max-Age", "600");\n\n        HttpServletRequest request = (HttpServletRequest) servletRequest;\n        if (request.getMethod().equals("OPTIONS")) {\n            response.setStatus(204);\n            return;\n        }\n\n        filterChain.doFilter(servletRequest, servletResponse);\n\n        response.setCharacterEncoding("UTF-8");\n        response.setContentType("application/json; charset=utf-8");\n    }\n\n    @Override\n    public void destroy() {\n        // do nothing\n    }\n}\n')])])]),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('@Configuration\npublic class WebMvcConfig implements WebMvcConfigurer {\n\n\n    /**\n     * 注册跨域过滤器\n     *\n     * @return\n     */\n    @Bean("registerCrossFilter")\n    public FilterRegistrationBean registerCrossFilter() {\n        FilterRegistrationBean registration = new FilterRegistrationBean();\n        registration.setFilter(new CrossFilter());\n        registration.addUrlPatterns("/*");\n        registration.setOrder(1);\n\n        return registration;\n    }\n\n\n}\n\n')])])]),t("h2",{attrs:{id:"_3-spring-boot项目使用resttemplate转发"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-spring-boot项目使用resttemplate转发"}},[e._v("#")]),e._v(" 3 spring boot项目使用restTemplate转发")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('@RestController\n@RequestMapping("/agency")\npublic class AgencyController {\n\n    @Autowired\n    RestTemplate restTemplate;\n\n    @Value(value = "${hik.cameras}")\n    String hikCameras;\n\n    @Value(value = "${hik.preview}")\n    String preView;\n\n    @PostMapping("/cameras")\n    public String getUserDomain(@RequestBody(required = false) PageReq req) {\n        //请求头\n        HttpHeaders headers = new HttpHeaders();\n        headers.setContentType(MediaType.APPLICATION_JSON);\n        //请求体\n        HttpEntity<PageReq> request = new HttpEntity<PageReq>(req, headers);\n        return restTemplate.exchange(hikCameras, HttpMethod.POST, request, String.class).getBody();\n    }\n\n\n    @PostMapping("/preview")\n    public String getUserDomain(@RequestBody(required = false) PreviewReq req) {\n        //请求头\n        HttpHeaders headers = new HttpHeaders();\n        headers.setContentType(MediaType.APPLICATION_JSON);\n        //请求体\n        HttpEntity<PreviewReq> request = new HttpEntity<PreviewReq>(req, headers);\n        return restTemplate.exchange(preView, HttpMethod.POST, request, String.class).getBody();\n    }\n}\n')])])]),t("h3",{attrs:{id:"resttemplateconfig"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#resttemplateconfig"}},[e._v("#")]),e._v(" RestTemplateConfig")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("@Configuration\npublic class RestTemplateConfig {\n    @Bean\n    public RestTemplate restTemplate() {\n        return new RestTemplate();\n    }\n}\n")])])]),t("h3",{attrs:{id:"yml"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#yml"}},[e._v("#")]),e._v(" yml")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("server:\n  port: 8081\n  servlet:\n    context-path: /hhl-basic\nhik:\n  cameras: http://xxxxxxxx/gateway/hikvision/cameras\n  preview: http://xxxxxxxx/gateway/hikvision/cameras/preview\n\n")])])]),t("h2",{attrs:{id:"maven项目打包build配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#maven项目打包build配置"}},[e._v("#")]),e._v(" maven项目打包build配置")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("\n    <build>\n        <plugins>\n            <plugin>\n                <groupId>org.apache.maven.plugins</groupId>\n                <artifactId>maven-compiler-plugin</artifactId>\n                <version>3.8.1</version>\n                <configuration>\n                    <source>1.8</source>\n                    <target>1.8</target>\n                    <encoding>UTF-8</encoding>\n                </configuration>\n            </plugin>\n            <plugin>\n                <groupId>org.springframework.boot</groupId>\n                <artifactId>spring-boot-maven-plugin</artifactId>\n                <version>${spring-boot.version}</version>\x3c!-- 对应springboot版本--\x3e\n                <configuration>\n                    <mainClass>com.dataojo.huangheloubasic.HuangHeLouBasicApplication</mainClass>\n                </configuration>\n                <executions>\n                    <execution>\n                        <id>repackage</id>\n                        <goals>\n                            <goal>repackage</goal>\n                        </goals>\n                    </execution>\n                </executions>\n            </plugin>\n        </plugins>\n    </build>\n")])])])])}),[],!1,null,null,null);t.default=s.exports}}]);