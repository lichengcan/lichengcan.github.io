(window.webpackJsonp=window.webpackJsonp||[]).push([[122],{541:function(e,r,n){"use strict";n.r(r);var a=n(2),t=Object(a.a)({},(function(){var e=this,r=e._self._c;return r("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[r("blockquote",[r("p",[e._v("è½¬è½½ï¼š"),r("a",{attrs:{href:"https://www.iocoder.cn/Spring-Boot/ActiveMQ/?self",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://www.iocoder.cn/Spring-Boot/ActiveMQ/?self"),r("OutboundLink")],1)])]),e._v(" "),r("h1",{attrs:{id:"_1-æ¦‚è¿°"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_1-æ¦‚è¿°"}},[e._v("#")]),e._v(" 1. æ¦‚è¿°")]),e._v(" "),r("p",[e._v("å¦‚æœèƒ–å‹è¿˜æ²¡äº†è§£è¿‡åˆ†å¸ƒå¼æ¶ˆæ¯é˜Ÿåˆ— "),r("a",{attrs:{href:"https://activemq.apache.org/",target:"_blank",rel:"noopener noreferrer"}},[e._v("ActiveMQ"),r("OutboundLink")],1),e._v(" ï¼Œå»ºè®®å…ˆé˜…è¯»ä¸‹è‰¿è‰¿å†™çš„ "),r("a",{attrs:{href:"http://www.iocoder.cn/ActiveMQ/install/?self",target:"_blank",rel:"noopener noreferrer"}},[e._v("ã€ŠèŠ‹é“ ActiveMQ æç®€å…¥é—¨ã€‹"),r("OutboundLink")],1),e._v(" æ–‡ç« ã€‚è™½ç„¶è¿™ç¯‡æ–‡ç« æ ‡é¢˜æ˜¯å®‰è£…éƒ¨ç½²ï¼Œå®é™…å¯ä»¥ç†è§£æˆã€Šä¸€æ–‡å¸¦ä½ å¿«é€Ÿå…¥é—¨ ActiveMQã€‹ï¼Œå“ˆå“ˆå“ˆã€‚")]),e._v(" "),r("p",[e._v("è€ƒè™‘è¿™æ˜¯ ActiveMQ å¦‚ä½•åœ¨ Spring Boot æ•´åˆä¸ä½¿ç”¨çš„æ–‡ç« ï¼Œæ‰€ä»¥è¿˜æ˜¯ç®€å•ä»‹ç»ä¸‹ ActiveMQ æ˜¯ä»€ä¹ˆï¼Ÿ")]),e._v(" "),r("blockquote",[r("p",[e._v("FROM "),r("a",{attrs:{href:"https://www.oschina.net/p/activemq",target:"_blank",rel:"noopener noreferrer"}},[e._v("ã€ŠJMS æ¶ˆæ¯æœåŠ¡å™¨ ActiveMQã€‹"),r("OutboundLink")],1)]),e._v(" "),r("p",[e._v("ActiveMQ æ˜¯ Apache å‡ºå“ï¼Œæœ€æµè¡Œçš„ï¼Œèƒ½åŠ›å¼ºåŠ²çš„å¼€æºæ¶ˆæ¯æ€»çº¿ã€‚")]),e._v(" "),r("p",[e._v("ActiveMQ æ˜¯ä¸€ä¸ªå®Œå…¨æ”¯æŒ JMS1.1 å’Œ J2EE1.4 è§„èŒƒçš„ JMS Provider å®ç°ï¼Œå°½ç®¡ JMS è§„èŒƒå‡ºå°å·²ç»æ˜¯å¾ˆä¹…çš„äº‹æƒ…äº†,ä½†æ˜¯ JMS åœ¨å½“ä»Šçš„ J2EE åº”ç”¨ä¸­é—´ä»ç„¶æ‰®æ¼”ç€ç‰¹æ®Šçš„åœ°ä½ã€‚")]),e._v(" "),r("p",[e._v("ä¸»è¦ç‰¹ç‚¹ï¼š")]),e._v(" "),r("ol",[r("li",[e._v("å¤šç§è¯­è¨€å’Œåè®®ç¼–å†™å®¢æˆ·ç«¯ã€‚è¯­è¨€: Java, C, C++, C#, Ruby, Perl, Python, PHPã€‚åº”ç”¨åè®®: OpenWire,Stomp REST,WS Notification,XMPP,AMQP")]),e._v(" "),r("li",[e._v("å®Œå…¨æ”¯æŒJMS1.1 å’Œ J2EE1.4 è§„èŒƒ (æŒä¹…åŒ–,XAæ¶ˆæ¯,äº‹åŠ¡)")]),e._v(" "),r("li",[e._v("å¯¹ Spring çš„æ”¯æŒ,ActiveMQ å¯ä»¥å¾ˆå®¹æ˜“å†…åµŒåˆ°ä½¿ç”¨ Spring çš„ç³»ç»Ÿé‡Œé¢å»,è€Œä¸”ä¹Ÿæ”¯æŒ Spring2.0 çš„ç‰¹æ€§")]),e._v(" "),r("li",[e._v("é€šè¿‡äº†å¸¸è§ J2EE æœåŠ¡å™¨(å¦‚ Geronimo,JBoss 4, GlassFish,WebLogic)çš„æµ‹è¯•,å…¶ä¸­é€šè¿‡ JCA 1.5 resource adaptors çš„é…ç½®,å¯ä»¥è®©ActiveMQå¯ä»¥è‡ªåŠ¨çš„éƒ¨ç½²åˆ°ä»»ä½•å…¼å®¹J2EE 1.4 å•†ä¸šæœåŠ¡å™¨ä¸Š")]),e._v(" "),r("li",[e._v("æ”¯æŒå¤šç§ä¼ é€åè®®:in-VM,TCP,SSL,NIO,UDP,JGroups,JXTA")]),e._v(" "),r("li",[e._v("æ”¯æŒé€šè¿‡ JDBC å’Œ journal æä¾›é«˜é€Ÿçš„æ¶ˆæ¯æŒä¹…åŒ–")]),e._v(" "),r("li",[e._v("ä»è®¾è®¡ä¸Šä¿è¯äº†é«˜æ€§èƒ½çš„é›†ç¾¤,å®¢æˆ·ç«¯-æœåŠ¡å™¨,ç‚¹å¯¹ç‚¹")]),e._v(" "),r("li",[e._v("æ”¯æŒ Ajax")]),e._v(" "),r("li",[e._v("æ”¯æŒä¸ Axis çš„æ•´åˆ")]),e._v(" "),r("li",[e._v("å¯ä»¥å¾ˆå®¹æ˜“å¾—è°ƒç”¨å†…åµŒ JMS provider,è¿›è¡Œæµ‹è¯•")])])]),e._v(" "),r("p",[e._v("åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬ä¼šæ¯” "),r("a",{attrs:{href:"http://www.iocoder.cn/ActiveMQ/install/?self",target:"_blank",rel:"noopener noreferrer"}},[e._v("ã€ŠèŠ‹é“ ActiveMQ æç®€å…¥é—¨ã€‹"),r("OutboundLink")],1),e._v(" æä¾›æ›´å¤šçš„ç”Ÿäº§è€… Producer å’Œæ¶ˆè´¹è€… Consumer çš„ä½¿ç”¨ç¤ºä¾‹ã€‚ä¾‹å¦‚è¯´ï¼š")]),e._v(" "),r("ul",[r("li",[e._v("Producer åŒæ­¥ä¸å¼‚æ­¥å‘é€æ¶ˆæ¯çš„æ–¹å¼ã€‚")]),e._v(" "),r("li",[e._v("Producer å‘é€"),r("strong",[e._v("é¡ºåº")]),e._v("æ¶ˆæ¯ï¼ŒConsumer "),r("strong",[e._v("é¡ºåº")]),e._v("æ¶ˆè´¹æ¶ˆæ¯ã€‚")]),e._v(" "),r("li",[e._v("Producer å‘é€"),r("strong",[e._v("å®šæ—¶")]),e._v("æ¶ˆæ¯ã€‚")]),e._v(" "),r("li",[e._v("Producer å‘é€"),r("strong",[e._v("äº‹åŠ¡")]),e._v("æ¶ˆæ¯ã€‚TODO")]),e._v(" "),r("li",[e._v("Consumer "),r("strong",[e._v("å¹¿æ’­")]),e._v("å’Œ"),r("strong",[e._v("é›†ç¾¤")]),e._v("æ¶ˆè´¹æ¶ˆæ¯ã€‚")])]),e._v(" "),r("h1",{attrs:{id:"_2-spring-jms"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_2-spring-jms"}},[e._v("#")]),e._v(" 2. Spring-JMS")]),e._v(" "),r("p",[e._v("åœ¨ Spring ä½“ç³»ä¸­ï¼Œæä¾›äº† "),r("a",{attrs:{href:"https://github.com/spring-projects/spring-framework/tree/master/spring-jms",target:"_blank",rel:"noopener noreferrer"}},[e._v("Spring-JMS"),r("OutboundLink")],1),e._v(" ç»„ä»¶ï¼Œå®ç°å¯¹ "),r("a",{attrs:{href:"https://mvnrepository.com/artifact/javax.jms/javax.jms-api",target:"_blank",rel:"noopener noreferrer"}},[e._v("JMS"),r("OutboundLink")],1),e._v(" è§„èŒƒçš„é›†æˆã€‚æˆ‘ä»¬æ¥çœ‹çœ‹ Spring æ–‡æ¡£å¯¹ Spring JMS çš„æè¿°ï¼š")]),e._v(" "),r("blockquote",[r("p",[e._v("FROM "),r("a",{attrs:{href:"https://docs.spring.io/spring-framework/docs/current/spring-framework-reference/integration.html#jms",target:"_blank",rel:"noopener noreferrer"}},[e._v("ã€ŠSpring æ–‡æ¡£ â€”â€” JMS (Java Message Service)ã€‹"),r("OutboundLink")],1)]),e._v(" "),r("p",[e._v("Spring provides a JMS integration framework that simplifies the use of the JMS API in much the same way as Springâ€™s integration does for the JDBC API.\nSpring æä¾›äº†ä¸€ä¸ª JMS çš„é›†æˆæ¡†æ¶ï¼Œç®€åŒ–äº† JMS API çš„ä½¿ç”¨ï¼Œå°±åƒ Spring å¯¹ JDBC API çš„é›†æˆä¸€æ ·ã€‚")]),e._v(" "),r("p",[e._v("JMS can be roughly divided into two areas of functionality, namely the production and consumption of messages.")]),e._v(" "),r("ul",[r("li",[e._v("The "),r("a",{attrs:{href:"https://github.com/spring-projects/spring-framework/blob/master/spring-jms/src/main/java/org/springframework/jms/core/JmsTemplate.java",target:"_blank",rel:"noopener noreferrer"}},[e._v("JmsTemplate"),r("OutboundLink")],1),e._v(" class is used for message production and synchronous message reception.")]),e._v(" "),r("li",[e._v("For asynchronous reception similar to Java EEâ€™s message-driven bean style, Spring provides a number of message-listener containers that you can use to create Message-Driven POJOs (MDPs). Spring also provides a declarative way to create message listeners.")])]),e._v(" "),r("p",[e._v("JMS å¯ä»¥å¤§è‡´åˆ†ä¸ºä¸¤å—åŠŸèƒ½ï¼Œå³æ¶ˆæ¯çš„å‘é€å’Œæ¶ˆè´¹ã€‚")]),e._v(" "),r("ul",[r("li",[e._v("JmsTemplate ç±»ï¼Œç”¨äºæ¶ˆæ¯çš„å‘é€å’Œæ¶ˆæ¯çš„åŒæ­¥æ¥æ”¶ã€‚")]),e._v(" "),r("li",[e._v("å¯¹äºç±»ä¼¼ Java EE çš„æ¶ˆæ¯é©±åŠ¨ Bean å½¢å¼çš„å¼‚æ­¥æ¥æ”¶ï¼ŒSpring æä¾›äº†å¤§é‡ç”¨äºåˆ›å»ºæ¶ˆæ¯é©±åŠ¨ POJOsï¼ˆMDPsï¼‰çš„æ¶ˆæ¯ç›‘å¬å™¨ã€‚Spring è¿˜æä¾›äº†ä¸€ç§åˆ›å»ºæ¶ˆæ¯ä¾¦å¬å™¨çš„"),r("strong",[e._v("å£°æ˜å¼")]),e._v("æ–¹æ³•ã€‚")])])]),e._v(" "),r("ul",[r("li",[e._v("è‹±æ–‡è·Ÿè‰¿è‰¿ä¸€æ ·ä¸å¥½çš„èƒ–å‹ï¼Œå¯ä»¥çœ‹çœ‹"),r("a",{attrs:{href:"https://my.oschina.net/landas/blog/858784",target:"_blank",rel:"noopener noreferrer"}},[e._v("ã€Šã€è¯‘ã€‘Spring Framework Reference â€”â€” JMS éƒ¨åˆ†ã€‹"),r("OutboundLink")],1),e._v(" ã€‚")]),e._v(" "),r("li",[e._v("å› ä¸º ActiveMQ æä¾›äº†å¯¹ JMS è§„èŒƒçš„æ”¯æŒï¼Œè‡ªç„¶ Spring-JMS å¯ä»¥è®¿é—® ActiveMQ æ¶ˆæ¯é˜Ÿåˆ—ï¼Œæ›´åŠ æ–¹ä¾¿çš„å®ç°æ¶ˆæ¯çš„å‘é€ä¸æ¶ˆè´¹ã€‚")])]),e._v(" "),r("p",[e._v("åœ¨ "),r("a",{attrs:{href:"https://spring.io/projects/spring-boot",target:"_blank",rel:"noopener noreferrer"}},[e._v("Spring-Boot"),r("OutboundLink")],1),e._v(" é¡¹ç›®ä¸­ï¼Œæä¾›äº† ActiveMQ çš„è‡ªåŠ¨åŒ–é…ç½®ï¼Œæ‰€ä»¥æˆ‘ä»¬ä»…éœ€å¼•å…¥ "),r("a",{attrs:{href:"https://mvnrepository.com/artifact/org.springframework.boot/spring-boot-starter-activemq",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("spring-boot-starter-activemq")]),r("OutboundLink")],1),e._v(" ä¾èµ–ï¼Œå³å¯æ„‰å¿«çš„ä½¿ç”¨ã€‚")]),e._v(" "),r("h1",{attrs:{id:"_3-å¿«é€Ÿå…¥é—¨"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_3-å¿«é€Ÿå…¥é—¨"}},[e._v("#")]),e._v(" 3. å¿«é€Ÿå…¥é—¨")]),e._v(" "),r("blockquote",[r("p",[e._v("ç¤ºä¾‹ä»£ç å¯¹åº”ä»“åº“ï¼š"),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo",target:"_blank",rel:"noopener noreferrer"}},[e._v("lab-32-activemq-demo"),r("OutboundLink")],1),e._v(" ã€‚")])]),e._v(" "),r("p",[e._v("æœ¬å°èŠ‚ï¼Œæˆ‘ä»¬å…ˆæ¥å¯¹ Spring-JMS åšä¸€ä¸ªå¿«é€Ÿå…¥é—¨ï¼Œå®ç° Producer åŒæ­¥ä¸å¼‚æ­¥å‘é€æ¶ˆæ¯åˆ° Queue ä¸­ï¼ŒåŒæ—¶åˆ›å»ºä¸€ä¸ª Consumer æ¶ˆè´¹æ¶ˆæ¯ã€‚")]),e._v(" "),r("p",[e._v("è€ƒè™‘åˆ°ä¸€ä¸ªåº”ç”¨æ—¢å¯ä»¥ä½¿ç”¨ç”Ÿäº§è€… Producer ï¼Œåˆå¯ä»¥ä½¿ç”¨æ¶ˆè´¹è€… Consumer ï¼Œæ‰€ä»¥ç¤ºä¾‹å°±åšæˆä¸€ä¸ª "),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo",target:"_blank",rel:"noopener noreferrer"}},[e._v("lab-32-activemq-demo"),r("OutboundLink")],1),e._v(" é¡¹ç›®ã€‚")]),e._v(" "),r("h2",{attrs:{id:"_3-1-å¼•å…¥ä¾èµ–"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-å¼•å…¥ä¾èµ–"}},[e._v("#")]),e._v(" 3.1 å¼•å…¥ä¾èµ–")]),e._v(" "),r("p",[e._v("åœ¨ "),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo/pom.xml",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("pom.xml")]),r("OutboundLink")],1),e._v(" æ–‡ä»¶ä¸­ï¼Œå¼•å…¥ç›¸å…³ä¾èµ–ã€‚")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v('<?xml version="1.0" encoding="UTF-8"?>\n<project xmlns="http://maven.apache.org/POM/4.0.0"\n         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">\n    <parent>\n        <groupId>org.springframework.boot</groupId>\n        <artifactId>spring-boot-starter-parent</artifactId>\n        <version>2.2.1.RELEASE</version>\n        <relativePath/> \x3c!-- lookup parent from repository --\x3e\n    </parent>\n    <modelVersion>4.0.0</modelVersion>\n\n    <artifactId>lab-32-activemq-demo</artifactId>\n\n    <dependencies>\n        \x3c!-- å®ç°å¯¹ ActiveMQ çš„è‡ªåŠ¨åŒ–é…ç½® --\x3e\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-activemq</artifactId>\n        </dependency>\n\n        \x3c!-- æ–¹ä¾¿ç­‰ä¼šå†™å•å…ƒæµ‹è¯• --\x3e\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-test</artifactId>\n            <scope>test</scope>\n        </dependency>\n    </dependencies>\n\n</project>\n')])])]),r("ul",[r("li",[e._v("å…·ä½“æ¯ä¸ªä¾èµ–çš„ä½œç”¨ï¼Œèƒ–å‹è‡ªå·±è®¤çœŸçœ‹ä¸‹è‰¿è‰¿æ·»åŠ çš„æ‰€æœ‰æ³¨é‡Šå™¢ã€‚")])]),e._v(" "),r("h2",{attrs:{id:"_3-2-åº”ç”¨é…ç½®æ–‡ä»¶"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-åº”ç”¨é…ç½®æ–‡ä»¶"}},[e._v("#")]),e._v(" 3.2 åº”ç”¨é…ç½®æ–‡ä»¶")]),e._v(" "),r("p",[e._v("åœ¨ "),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo/src/main/resources",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("resources")]),r("OutboundLink")],1),e._v(" ç›®å½•ä¸‹ï¼Œåˆ›å»º "),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo/src/main/resources/application.yaml",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("application.yaml")]),r("OutboundLink")],1),e._v(" é…ç½®æ–‡ä»¶ã€‚é…ç½®å¦‚ä¸‹ï¼š")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("spring:\n  # ActiveMQ é…ç½®é¡¹ï¼Œå¯¹åº” ActiveMQProperties é…ç½®ç±»\n  activemq:\n    broker-url: tcp://127.0.0.1:61616 # Activemq Broker çš„åœ°å€\n    user: admin # è´¦å·\n    password: admin # å¯†ç \n    packages:\n      trust-all: true # å¯ä¿¡ä»»çš„ååºåˆ—åŒ–åŒ…\n")])])]),r("ul",[r("li",[e._v("åœ¨ "),r("code",[e._v("spring.activemq")]),e._v(" é…ç½®é¡¹ï¼Œè®¾ç½® Kafka çš„é…ç½®ï¼Œå¯¹åº” "),r("a",{attrs:{href:"https://github.com/spring-projects/spring-boot/blob/master/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/jms/activemq/ActiveMQProperties.java",target:"_blank",rel:"noopener noreferrer"}},[e._v("ActiveMQProperties"),r("OutboundLink")],1),e._v(" é…ç½®ç±»ã€‚")]),e._v(" "),r("li",[e._v("Spring Boot æä¾›çš„ "),r("a",{attrs:{href:"https://github.com/spring-projects/spring-boot/blob/master/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/jms/activemq/ActiveMQAutoConfiguration.java",target:"_blank",rel:"noopener noreferrer"}},[e._v("ActiveMQAutoConfiguration"),r("OutboundLink")],1),e._v(" è‡ªåŠ¨åŒ–é…ç½®ç±»ï¼Œå®ç° ActiveMQ çš„è‡ªåŠ¨é…ç½®ï¼Œåˆ›å»ºç›¸åº”çš„ Producer å’Œ Consumer ã€‚")]),e._v(" "),r("li",[r("code",[e._v("spring.activemq.packages.trust-all")]),e._v(" é…ç½®é¡¹ï¼Œé…ç½®å¯ä¿¡èµ–æ‰€æœ‰çš„ "),r("code",[e._v("package")]),e._v(" åŒ…ã€‚å› ä¸º ActiveMQ åœ¨ååºåˆ—åŒ– POJO çš„æ¶ˆæ¯æ—¶ï¼Œè€ƒè™‘åˆ°å®‰å…¨æ€§ï¼Œå¦‚æœéå¯ä¿¡èµ–çš„ Java ç±»ï¼Œä¼šæŠ›å‡º "),r("code",[e._v('"This class is not trusted to be serialized"')]),e._v(" çš„å¼‚å¸¸ã€‚ğŸ˜ˆ æƒ³è¦å°è¯•ä¸‹æ•ˆæœçš„èƒ–å‹ï¼Œå¯ä»¥é€‰æ‹©å»æ‰è¿™ä¸ªé…ç½®ï¼Œå¾ˆé…¸çˆ½ã€‚")])]),e._v(" "),r("h2",{attrs:{id:"_3-3-application"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-application"}},[e._v("#")]),e._v(" 3.3 Application")]),e._v(" "),r("p",[e._v("åˆ›å»º "),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/Application.java",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("Application.java")]),r("OutboundLink")],1),e._v(" ç±»ï¼Œé…ç½® "),r("code",[e._v("@SpringBootApplication")]),e._v(" æ³¨è§£å³å¯ã€‚ä»£ç å¦‚ä¸‹ï¼š")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("// Application.java\n\n@SpringBootApplication\n@EnableAsync // å¼€å¯å¼‚æ­¥\npublic class Application {\n\n    public static void main(String[] args) {\n        SpringApplication.run(Application.class, args);\n    }\n\n}\n")])])]),r("ul",[r("li",[e._v("æˆ‘ä»¬é¢å¤–æ·»åŠ äº† "),r("code",[e._v("@EnableAsync")]),e._v(" æ³¨è§£ï¼Œå› ä¸ºæˆ‘ä»¬ç¨åè¦ä½¿ç”¨ Spring æä¾›çš„å¼‚æ­¥è°ƒç”¨çš„åŠŸèƒ½ã€‚ä¸äº†è§£è¿™å—çš„èƒ–å‹ï¼Œå¯ä»¥çœ‹çœ‹è‰¿è‰¿å†™çš„ "),r("a",{attrs:{href:"http://www.iocoder.cn/Spring-Boot/Async-Job/?self",target:"_blank",rel:"noopener noreferrer"}},[e._v("ã€ŠèŠ‹é“ Spring Boot å¼‚æ­¥ä»»åŠ¡å…¥é—¨ã€‹"),r("OutboundLink")],1),e._v(" æ–‡ç« ã€‚")])]),e._v(" "),r("h2",{attrs:{id:"_3-4-demo01message"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_3-4-demo01message"}},[e._v("#")]),e._v(" 3.4 Demo01Message")]),e._v(" "),r("p",[e._v("åœ¨ "),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/message",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("cn.iocoder.springboot.lab32.activemqdemo.message")]),r("OutboundLink")],1),e._v(" åŒ…ä¸‹ï¼Œåˆ›å»º "),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/message/Demo01Message.java",target:"_blank",rel:"noopener noreferrer"}},[e._v("Demo01Message"),r("OutboundLink")],1),e._v(" æ¶ˆæ¯ç±»ï¼Œæä¾›ç»™å½“å‰ç¤ºä¾‹ä½¿ç”¨ã€‚ä»£ç å¦‚ä¸‹ï¼š")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v('// Demo01Message.java\n\npublic class Demo01Message implements Serializable {\n\n    public static final String QUEUE = "QUEUE_DEMO_01";\n\n    /**\n     * ç¼–å·\n     */\n    private Integer id;\n\n    // ... çœç•¥ set/get/toString æ–¹æ³•\n\n}\n')])])]),r("ul",[r("li",[e._v("æ³¨æ„ï¼Œè¦å®ç° Java Serializable åºåˆ—åŒ–æ¥å£ã€‚å› ä¸º JMS è§„èŒƒè¦æ±‚ POJO æ¶ˆæ¯ç±»ï¼Œéœ€è¦å®ç° Serializable æ¥å£ã€‚")]),e._v(" "),r("li",[e._v("åœ¨æ¶ˆæ¯ç±»é‡Œï¼Œæˆ‘ä»¬æšä¸¾äº† Queue çš„åå­—ã€‚")])]),e._v(" "),r("p",[e._v("æˆ‘ä»¬æ— éœ€ä¸­å» ActiveMQ æˆ–è€… Spring-JMS "),r("strong",[e._v("ä¸»åŠ¨")]),e._v("å£°æ˜è¿™ä¸ª ActiveMQ Queue ã€‚å› ä¸º Consumer è®¢é˜…è¯¥ Queue æ—¶ï¼Œä¼š"),r("strong",[e._v("è‡ªåŠ¨")]),e._v("è¿›è¡Œåˆ›å»ºã€‚åˆæˆ–è€… Producer åœ¨å‘é€æ¶ˆæ¯åˆ° Queue ä¸­æ—¶ï¼Œä¹Ÿä¼š"),r("strong",[e._v("è‡ªåŠ¨")]),e._v("è¿›è¡Œåˆ›å»ºã€‚")]),e._v(" "),r("h2",{attrs:{id:"_3-5-demo01producer"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_3-5-demo01producer"}},[e._v("#")]),e._v(" 3.5 Demo01Producer")]),e._v(" "),r("p",[e._v("åœ¨ "),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/producer",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("cn.iocoder.springboot.lab32.activemqdemo.producer")]),r("OutboundLink")],1),e._v(" åŒ…ä¸‹ï¼Œåˆ›å»º "),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/producer/Demo01Producer.java",target:"_blank",rel:"noopener noreferrer"}},[e._v("Demo01Producer"),r("OutboundLink")],1),e._v(" ç±»ï¼Œå®ƒä¼šä½¿ç”¨ Spring-JMS å°è£…æä¾›çš„ JmsMessagingTemplate ï¼Œå®ç°å‘é€æ¶ˆæ¯ã€‚ä»£ç å¦‚ä¸‹ï¼š")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("// Demo01Producer.java\n\n@Component\npublic class Demo01Producer {\n\n    @Autowired\n    private JmsMessagingTemplate jmsTemplate;\n\n    public void syncSend(Integer id) {\n        // åˆ›å»º Demo01Message æ¶ˆæ¯\n        Demo01Message message = new Demo01Message();\n        message.setId(id);\n        // åŒæ­¥å‘é€æ¶ˆæ¯\n        jmsTemplate.convertAndSend(Demo01Message.QUEUE, message);\n    }\n\n    @Async\n    public ListenableFuture<Void> asyncSend(Integer id) {\n        try {\n            // å‘é€æ¶ˆæ¯\n            this.syncSend(id);\n            // è¿”å›æˆåŠŸçš„ Future\n            return AsyncResult.forValue(null);\n        } catch (Throwable ex) {\n            // è¿”å›å¼‚å¸¸çš„ Future\n            return AsyncResult.forExecutionException(ex);\n        }\n    }\n\n}\n")])])]),r("ul",[r("li",[r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("jmsTemplate\n")])])]),r("p",[e._v("å±æ€§ï¼Œæ˜¯")]),e._v(" "),r("p",[e._v("JmsMessagingTemplate")]),e._v(" "),r("p",[e._v("å¯¹è±¡ï¼Œè€Œä¸æ˜¯")]),e._v(" "),r("p",[e._v("JmsTemplate")]),e._v(" "),r("p",[e._v("ã€‚")]),e._v(" "),r("ul",[r("li",[e._v("JmsTemplate æ˜¯ JMS API çš„å°è£…ï¼Œç®€åŒ–æ¶ˆæ¯çš„å‘é€ä¸æ¥æ”¶ã€‚")]),e._v(" "),r("li",[e._v("JmsMessagingTemplate æ˜¯å°† JmsTemplate é›†æˆåˆ° "),r("a",{attrs:{href:"https://github.com/spring-projects/spring-framework/tree/master/spring-messaging/src/main/java/org/springframework/messaging",target:"_blank",rel:"noopener noreferrer"}},[e._v("Spring-Messaging"),r("OutboundLink")],1),e._v(" ä½“ç³»ä¸­ï¼Œå…¶å†…éƒ¨è°ƒç”¨çš„è¿˜æ˜¯ JmsTemplate çš„æ–¹æ³•ã€‚")])])]),e._v(" "),r("li",[r("p",[r("code",[e._v("#syncSend(Integer id)")]),e._v(" æ–¹æ³•ï¼Œè°ƒç”¨ JmsMessagingTemplate çš„åŒæ­¥å‘é€æ¶ˆæ¯æ–¹æ³•ã€‚")])]),e._v(" "),r("li",[r("p",[r("code",[e._v("#asyncSend(Integer id)")]),e._v(" æ–¹æ³•ï¼Œé€šè¿‡ "),r("code",[e._v("@Async")]),e._v(" æ³¨è§£ï¼Œå£°æ˜å¼‚æ­¥è°ƒç”¨è¯¥æ–¹æ³•ï¼Œä»è€Œå®ç°å¼‚æ­¥æ¶ˆæ¯åˆ° ActiveMQ ä¸­ã€‚å› ä¸º JmsMessagingTemplate å¹¶æœªåƒ "),r("a",{attrs:{href:"https://github.com/spring-projects/spring-kafka/blob/master/spring-kafka/src/main/java/org/springframework/kafka/core/KafkaTemplate.java",target:"_blank",rel:"noopener noreferrer"}},[e._v("KafkaTemplate"),r("OutboundLink")],1),e._v(" æˆ– "),r("a",{attrs:{href:"https://github.com/apache/rocketmq-spring/blob/master/rocketmq-spring-boot/src/main/java/org/apache/rocketmq/spring/core/RocketMQTemplate.java",target:"_blank",rel:"noopener noreferrer"}},[e._v("RocketMQTemplate"),r("OutboundLink")],1),e._v(" ç›´æ¥æä¾›äº†å¼‚æ­¥å‘é€æ¶ˆæ¯çš„æ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ç»“åˆ Spring å¼‚æ­¥è°ƒç”¨æ¥å®ç°ã€‚")])])]),e._v(" "),r("h2",{attrs:{id:"_3-6-demo01consumer"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_3-6-demo01consumer"}},[e._v("#")]),e._v(" 3.6 Demo01Consumer")]),e._v(" "),r("p",[e._v("åœ¨ "),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/consumer",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("cn.iocoder.springboot.lab32.activemqdemo.consumer")]),r("OutboundLink")],1),e._v(" åŒ…ä¸‹ï¼Œåˆ›å»º "),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/consumer/Demo01Consumer.java",target:"_blank",rel:"noopener noreferrer"}},[e._v("Demo01Consumer"),r("OutboundLink")],1),e._v(" ç±»ï¼Œæ¶ˆè´¹æ¶ˆæ¯ã€‚ä»£ç å¦‚ä¸‹ï¼š")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v('// Demo01Consumer.java\n\n@Component\npublic class Demo01Consumer {\n\n    private Logger logger = LoggerFactory.getLogger(getClass());\n\n    @JmsListener(destination = Demo01Message.QUEUE)\n    public void onMessage(Demo01Message message) {\n        logger.info("[onMessage][çº¿ç¨‹ç¼–å·:{} æ¶ˆæ¯å†…å®¹ï¼š{}]", Thread.currentThread().getId(), message);\n    }\n\n//    @JmsListener(destination = Demo01Message.QUEUE)\n//    public void onMessage(javax.jms.Message message) {\n//        logger.info("[onMessage][çº¿ç¨‹ç¼–å·:{} æ¶ˆæ¯å†…å®¹ï¼š{}]", Thread.currentThread().getId(), message);\n//    }\n\n}\n')])])]),r("ul",[r("li",[e._v("åœ¨ç±»ä¸Šï¼Œæ·»åŠ äº† "),r("code",[e._v("@Component")]),e._v(" æ³¨è§£ï¼Œä¿è¯å…¶èƒ½è¢« Spring ä½œä¸ºä¸€ä¸ª Bean æ‰«æåˆ°ã€‚")]),e._v(" "),r("li",[e._v("åœ¨æ–¹æ³•ä¸Šï¼Œæ·»åŠ äº† "),r("a",{attrs:{href:"https://github.com/spring-projects/spring-framework/blob/master/spring-jms/src/main/java/org/springframework/jms/annotation/JmsListener.java",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("@JmsListener")]),r("OutboundLink")],1),e._v(" æ³¨è§£ï¼Œç”³æ˜äº†å¤„ç†æ¶ˆæ¯çš„æ–¹æ³•ã€‚åŒæ—¶ï¼Œæ–¹æ³•å…¥å‚ä¸ºæ¶ˆæ¯çš„ç±»å‹ã€‚è¿™é‡Œï¼Œæˆ‘ä»¬è®¾ç½®äº†"),r("a",{attrs:{href:"https://www.iocoder.cn/Spring-Boot/ActiveMQ/?self#",target:"_blank",rel:"noopener noreferrer"}},[e._v("ã€Œ3.4 Demo01Messageã€"),r("OutboundLink")],1),e._v(" ã€‚")]),e._v(" "),r("li",[e._v("å¦‚æœæˆ‘ä»¬æƒ³è¦è·å¾—æ¶ˆè´¹æ¶ˆæ¯çš„æ›´å¤šä¿¡æ¯ï¼Œä¾‹å¦‚è¯´ï¼Œæ¶ˆæ¯ç¼–å·ã€åˆ›å»ºæ—¶é—´ç­‰ç­‰ä¿¡æ¯ï¼Œåˆ™å¯ä»¥è€ƒè™‘ä½¿ç”¨è‰¿è‰¿"),r("strong",[e._v("æ³¨é‡Šæ‰çš„é‚£æ®µä»£ç ")]),e._v("ï¼Œé€šè¿‡æ–¹æ³•å…¥å‚ä¸º "),r("a",{attrs:{href:"https://github.com/javaee/javax.jms/blob/master/src/main/java/javax/jms/Message.java",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("javax.jms.Messagee")]),r("OutboundLink")],1),e._v(" ç±»å‹ã€‚ä¸è¿‡ç»å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¹¶ä¸éœ€è¦è¿™ä¹ˆåšã€‚")])]),e._v(" "),r("h2",{attrs:{id:"_3-7-ç®€å•æµ‹è¯•"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_3-7-ç®€å•æµ‹è¯•"}},[e._v("#")]),e._v(" 3.7 ç®€å•æµ‹è¯•")]),e._v(" "),r("p",[e._v("åˆ›å»º "),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo/src/test/java/cn/iocoder/springboot/lab32/activemqdemo/producer/Demo01ProducerTest.java",target:"_blank",rel:"noopener noreferrer"}},[e._v("Demo01ProducerTest"),r("OutboundLink")],1),e._v(" æµ‹è¯•ç±»ï¼Œç¼–å†™å•å…ƒæµ‹è¯•æ–¹æ³•ï¼Œè°ƒç”¨ Demo01Producer ä¸¤ä¸ªå‘é€æ¶ˆæ¯çš„æ–¹å¼ã€‚ä»£ç å¦‚ä¸‹ï¼š")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v('// Demo01ProducerTest.java\n\n@RunWith(SpringRunner.class)\n@SpringBootTest(classes = Application.class)\npublic class Demo01ProducerTest {\n\n    private Logger logger = LoggerFactory.getLogger(getClass());\n\n    @Autowired\n    private Demo01Producer producer;\n\n    @Test\n    public void testSyncSend() throws InterruptedException {\n        // å‘é€æ¶ˆæ¯\n        int id = (int) (System.currentTimeMillis() / 1000);\n        producer.syncSend(id);\n        logger.info("[testSyncSend][å‘é€ç¼–å·ï¼š[{}] å‘é€æˆåŠŸ]", id);\n\n        // é˜»å¡ç­‰å¾…ï¼Œä¿è¯æ¶ˆè´¹\n        new CountDownLatch(1).await();\n    }\n\n    @Test\n    public void testAsyncSend() throws InterruptedException {\n        int id = (int) (System.currentTimeMillis() / 1000);\n        producer.asyncSend(id).addCallback(new ListenableFutureCallback<Void>() {\n\n            @Override\n            public void onFailure(Throwable e) {\n                logger.info("[testASyncSend][å‘é€ç¼–å·ï¼š[{}] å‘é€å¼‚å¸¸]]", id, e);\n            }\n\n            @Override\n            public void onSuccess(Void aVoid) {\n                logger.info("[testASyncSend][å‘é€ç¼–å·ï¼š[{}] å‘é€æˆåŠŸï¼Œå‘é€æˆåŠŸ]", id);\n            }\n\n        });\n        logger.info("[testASyncSend][å‘é€ç¼–å·ï¼š[{}] è°ƒç”¨å®Œæˆ]", id);\n\n        // é˜»å¡ç­‰å¾…ï¼Œä¿è¯æ¶ˆè´¹\n        new CountDownLatch(1).await();\n    }\n\n}\n')])])]),r("ul",[r("li",[e._v("æ¯”è¾ƒç®€å•ï¼Œèƒ–å‹è‡ªå·±çœ‹ä¸‹ä¸¤ä¸ªå•å…ƒæµ‹è¯•æ–¹æ³•ã€‚")])]),e._v(" "),r("p",[e._v("æˆ‘ä»¬æ¥æ‰§è¡Œ "),r("code",[e._v("#testSyncSend()")]),e._v(" æ–¹æ³•ï¼Œæµ‹è¯•åŒæ­¥å‘é€æ¶ˆæ¯ã€‚æ§åˆ¶å°è¾“å‡ºå¦‚ä¸‹ï¼š")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("# Producer åŒæ­¥å‘é€æ¶ˆæ¯æˆåŠŸã€‚\n2019-12-15 00:19:18.736  INFO 87164 --- [           main] c.i.s.l.r.producer.Demo01ProducerTest    : [testSyncSend][å‘é€ç¼–å·ï¼š[1575908358] å‘é€æˆåŠŸ]\n\n# Demo01Consumer æˆåŠŸæ¶ˆè´¹äº†è¯¥æ¶ˆæ¯\n2019-12-15 00:19:18.751  INFO 87164 --- [ntContainer#0-1] c.i.s.l.r.consumer.Demo01Consumer        : [onMessage][çº¿ç¨‹ç¼–å·:17 æ¶ˆæ¯å†…å®¹ï¼šDemo01Message{id=1575908358}]\n")])])]),r("ul",[r("li",[e._v("åŒæ­¥å‘é€çš„æ¶ˆæ¯ï¼ŒæˆåŠŸè¢«æ¶ˆè´¹ã€‚")])]),e._v(" "),r("p",[e._v("æˆ‘ä»¬å†æ¥æ‰§è¡Œ "),r("code",[e._v("#tesSyncSendDefault()")]),e._v(" æ–¹æ³•ï¼Œæµ‹è¯•å¦ä¸€ä¸ªåŒæ­¥å‘é€æ¶ˆæ¯ã€‚æ§åˆ¶å°è¾“å‡ºå¦‚ä¸‹ï¼š")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("# Producer åŒæ­¥å‘é€æ¶ˆæ¯æˆåŠŸã€‚\n2019-12-15 11:50:38.857  INFO 74430 --- [           main] c.i.s.l.a.producer.Demo01ProducerTest    : [testSyncSend][å‘é€ç¼–å·ï¼š[1576381838] å‘é€æˆåŠŸ]\n\n# Demo01Consumer æˆåŠŸæ¶ˆè´¹äº†è¯¥æ¶ˆæ¯\n2019-12-15 11:50:38.860  INFO 74430 --- [enerContainer-1] c.i.s.l.a.consumer.Demo01Consumer        : [onMessage][çº¿ç¨‹ç¼–å·:18 æ¶ˆæ¯å†…å®¹ï¼šDemo01Message{id=1576381838}]\n")])])]),r("ul",[r("li",[e._v("åŒæ­¥å‘é€çš„æ¶ˆæ¯ï¼ŒæˆåŠŸä¹Ÿè¢«æ¶ˆè´¹ã€‚")])]),e._v(" "),r("p",[e._v("æˆ‘ä»¬æœ€åæ¥æ‰§è¡Œ "),r("code",[e._v("#testAsyncSend()")]),e._v(" æ–¹æ³•ï¼Œæµ‹è¯•å¼‚æ­¥å‘é€æ¶ˆæ¯ã€‚æ§åˆ¶å°è¾“å‡ºå¦‚ä¸‹ï¼š")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("# Producer å¼‚æ­¥å‘é€æ¶ˆæ¯çš„è°ƒç”¨å®Œæˆã€‚\n2019-12-15 11:52:43.156  INFO 74582 --- [           main] c.i.s.l.a.producer.Demo01ProducerTest    : [testASyncSend][å‘é€ç¼–å·ï¼š[1576381963] è°ƒç”¨å®Œæˆ]\n\n# Producer å¼‚æ­¥å‘é€æ¶ˆæ¯æˆåŠŸã€‚ã€å›è°ƒã€‘\n2019-12-15 11:52:43.214  INFO 74582 --- [         task-1] c.i.s.l.a.producer.Demo01ProducerTest    : [testASyncSend][å‘é€ç¼–å·ï¼š[1576381963] å‘é€æˆåŠŸï¼Œå‘é€æˆåŠŸ]\n\n# Demo01Consumer æˆåŠŸæ¶ˆè´¹äº†è¯¥æ¶ˆæ¯\n2019-12-15 11:52:43.218  INFO 74582 --- [enerContainer-1] c.i.s.l.a.consumer.Demo01Consumer        : [onMessage][çº¿ç¨‹ç¼–å·:18 æ¶ˆæ¯å†…å®¹ï¼šDemo01Message{id=1576381963}]\n")])])]),r("ul",[r("li",[e._v("å¼‚æ­¥å‘é€çš„æ¶ˆæ¯ï¼ŒæˆåŠŸä¹Ÿè¢«æ¶ˆè´¹ã€‚")])]),e._v(" "),r("h1",{attrs:{id:"_4-æ¶ˆæ¯æ¨¡å¼"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_4-æ¶ˆæ¯æ¨¡å¼"}},[e._v("#")]),e._v(" 4. æ¶ˆæ¯æ¨¡å¼")]),e._v(" "),r("blockquote",[r("p",[e._v("ç¤ºä¾‹ä»£ç å¯¹åº”ä»“åº“ï¼š"),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo-message-model",target:"_blank",rel:"noopener noreferrer"}},[e._v("lab-32-activemq-demo-message-model"),r("OutboundLink")],1)])]),e._v(" "),r("p",[e._v("åœ¨ JMS è§„èŒƒä¸­ï¼Œå®šä¹‰äº†ä¸¤ç§æ¶ˆæ¯æ¨¡å¼ï¼š")]),e._v(" "),r("ul",[r("li",[e._v("ç‚¹å¯¹ç‚¹ï¼ˆpoint to pointï¼‰ï¼šåŸºäº Queue é˜Ÿåˆ—çš„æ–¹å¼ã€‚")]),e._v(" "),r("li",[e._v("å‘å¸ƒ/è®¢é˜…ï¼ˆpublish/subscribeï¼‰ï¼šåŸºäº Topic ä¸»é¢˜çš„æ–¹å¼ã€‚")])]),e._v(" "),r("p",[e._v("å…·ä½“çš„æ¦‚å¿µï¼Œè‰¿è‰¿å°±å…ˆä¸è§£é‡Šï¼Œèƒ–å‹å¯ä»¥çœ‹çœ‹"),r("a",{attrs:{href:"http://www.iocoder.cn/Fight/There-are-two-modes-of-message-queuing-point-to-point-and-publish-subscription/?self",target:"_blank",rel:"noopener noreferrer"}},[e._v("ã€Šæ¶ˆæ¯é˜Ÿåˆ—ä¸¤ç§æ¨¡å¼ï¼šç‚¹å¯¹ç‚¹ä¸å‘å¸ƒè®¢é˜…ã€‹"),r("OutboundLink")],1),e._v("æ–‡ç« ã€‚ğŸ™‚ å®é™…ä¸Šï¼Œæˆ‘ä»¬åœ¨"),r("a",{attrs:{href:"https://www.iocoder.cn/Spring-Boot/ActiveMQ/?self#",target:"_blank",rel:"noopener noreferrer"}},[e._v("ã€Œ3. å¿«é€Ÿå…¥é—¨ã€"),r("OutboundLink")],1),e._v("ä¸­ï¼Œå°±é‡‡ç”¨çš„æ˜¯ç‚¹å¯¹ç‚¹çš„æ¶ˆæ¯æ¨¡å¼ã€‚")]),e._v(" "),r("p",[e._v("å¦‚æœèƒ–å‹æœ‰ä½¿ç”¨è¿‡ RocketMQ æˆ–è€… Kafka æ¶ˆæ¯é˜Ÿåˆ—ï¼Œå¯èƒ½æ¯”è¾ƒä¹ æƒ¯çš„å«æ³•æ˜¯ï¼š")]),e._v(" "),r("blockquote",[r("p",[r("strong",[e._v("é›†ç¾¤æ¶ˆè´¹ï¼ˆClusteringï¼‰")]),e._v("ï¼šå¯¹åº”ã€Œç‚¹å¯¹ç‚¹ã€ é›†ç¾¤æ¶ˆè´¹æ¨¡å¼ä¸‹ï¼Œç›¸åŒ Consumer Group çš„æ¯ä¸ª Consumer å®ä¾‹å¹³å‡åˆ†æ‘Šæ¶ˆæ¯ã€‚")]),e._v(" "),r("p",[r("strong",[e._v("å¹¿æ’­æ¶ˆè´¹ï¼ˆBroadcastingï¼‰")]),e._v("ï¼šå¯¹åº”ã€Œå‘å¸ƒè®¢é˜…ã€ å¹¿æ’­æ¶ˆè´¹æ¨¡å¼ä¸‹ï¼Œç›¸åŒ Consumer Group çš„æ¯ä¸ª Consumer å®ä¾‹éƒ½æ¥æ”¶å…¨é‡çš„æ¶ˆæ¯ã€‚")])]),e._v(" "),r("p",[e._v("ğŸ˜ˆ è€ƒè™‘åˆ°è‰¿è‰¿è‡ªå·±çš„ä¹ æƒ¯ï¼Œä¸‹æ–‡æˆ‘ä»¬ç»Ÿä¸€é‡‡ç”¨é›†ç¾¤æ¶ˆè´¹å’Œå¹¿æ’­æ¶ˆè´¹å«æ³•ã€‚")]),e._v(" "),r("p",[e._v("ä¸‹é¢ï¼Œæˆ‘ä»¬åˆ†åˆ«åœ¨"),r("a",{attrs:{href:"https://www.iocoder.cn/Spring-Boot/ActiveMQ/?self#",target:"_blank",rel:"noopener noreferrer"}},[e._v("ã€Œ4.1 é›†ç¾¤æ¶ˆè´¹ã€"),r("OutboundLink")],1),e._v("å’Œ"),r("a",{attrs:{href:"https://www.iocoder.cn/Spring-Boot/ActiveMQ/?self#",target:"_blank",rel:"noopener noreferrer"}},[e._v("ã€Œ4.2 å¹¿æ’­æ¶ˆè´¹ã€"),r("OutboundLink")],1),e._v("çš„ç¤ºä¾‹ä»£ç ã€‚ä¸¤ä¸ªç¤ºä¾‹ï¼Œæˆ‘ä»¬éƒ½ä¼šæ”¾åœ¨ä¸€ä¸ª "),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo-message-model",target:"_blank",rel:"noopener noreferrer"}},[e._v("lab-32-activemq-demo-message-model"),r("OutboundLink")],1),e._v(" é¡¹ç›®ã€‚")]),e._v(" "),r("h2",{attrs:{id:"_4-1-é›†ç¾¤æ¶ˆè´¹"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-é›†ç¾¤æ¶ˆè´¹"}},[e._v("#")]),e._v(" 4.1 é›†ç¾¤æ¶ˆè´¹")]),e._v(" "),r("p",[e._v("åœ¨ ActiveMQ ä¸­ï¼Œå¦‚æœå¤šä¸ª Consumer è®¢é˜…ç›¸åŒçš„ Queue ï¼Œé‚£ä¹ˆæ¯ä¸€æ¡æ¶ˆæ¯æœ‰ä¸”ä»…ä¼šè¢«ä¸€ä¸ª Consumer æ‰€æ¶ˆè´¹ã€‚è¿™ä¸ªç‰¹æ€§ï¼Œå°±ä¸ºæˆ‘ä»¬å®ç°é›†ç¾¤æ¶ˆè´¹æä¾›äº†åŸºç¡€ã€‚")]),e._v(" "),r("p",[e._v("åœ¨æœ¬ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬ä¼šæŠŠä¸€ä¸ª Queue ä½œä¸ºä¸€ä¸ª Consumer Group ï¼ŒåŒæ—¶åˆ›å»ºæ¶ˆè´¹è¯¥ Queue çš„ Consumer ã€‚è¿™æ ·ï¼Œåœ¨æˆ‘ä»¬å¯åŠ¨å¤šä¸ª JVM è¿›ç¨‹æ—¶ï¼Œå°±ä¼šæœ‰å¤šä¸ª Consumer æ¶ˆè´¹è¯¥ Queue ï¼Œä»è€Œå®ç°é›†ç¾¤æ¶ˆè´¹çš„æ•ˆæœã€‚")]),e._v(" "),r("p",[e._v("ä¸‹é¢ï¼Œè®©æˆ‘ä»¬å¼€å§‹é›†ç¾¤æ¶ˆè´¹çš„ç¤ºä¾‹ã€‚")]),e._v(" "),r("h3",{attrs:{id:"_4-1-1-å¼•å…¥ä¾èµ–"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-1-å¼•å…¥ä¾èµ–"}},[e._v("#")]),e._v(" 4.1.1 å¼•å…¥ä¾èµ–")]),e._v(" "),r("p",[e._v("å’Œ "),r("a",{attrs:{href:"https://www.iocoder.cn/Spring-Boot/ActiveMQ/?self#",target:"_blank",rel:"noopener noreferrer"}},[e._v("ã€Œ3.1 å¼•å…¥ä¾èµ–ã€"),r("OutboundLink")],1),e._v(" ä¸€è‡´ï¼Œè§ "),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo-message-model/pom.xml",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("pom.xml")]),r("OutboundLink")],1),e._v(" æ–‡ä»¶ã€‚")]),e._v(" "),r("h3",{attrs:{id:"_4-1-2-åº”ç”¨é…ç½®æ–‡ä»¶"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-2-åº”ç”¨é…ç½®æ–‡ä»¶"}},[e._v("#")]),e._v(" 4.1.2 åº”ç”¨é…ç½®æ–‡ä»¶")]),e._v(" "),r("p",[e._v("å’Œ "),r("a",{attrs:{href:"https://www.iocoder.cn/Spring-Boot/ActiveMQ/?self#",target:"_blank",rel:"noopener noreferrer"}},[e._v("ã€Œ3.2 åº”ç”¨é…ç½®æ–‡ä»¶ã€"),r("OutboundLink")],1),e._v(" ä¸€è‡´ï¼Œè§ "),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo-message-model/src/main/resources/application.yaml",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("application.yaml")]),r("OutboundLink")],1),e._v(" æ–‡ä»¶ã€‚")]),e._v(" "),r("h3",{attrs:{id:"_4-1-3-clusteringmessage"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-3-clusteringmessage"}},[e._v("#")]),e._v(" 4.1.3 ClusteringMessage")]),e._v(" "),r("p",[e._v("åœ¨ "),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo-message-model/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/message/",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("cn.iocoder.springboot.lab32.activemqdemo.message")]),r("OutboundLink")],1),e._v(" åŒ…ä¸‹ï¼Œåˆ›å»º "),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo-message-model/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/message/ClusteringMessage.java",target:"_blank",rel:"noopener noreferrer"}},[e._v("ClusteringMessage"),r("OutboundLink")],1),e._v(" æ¶ˆæ¯ç±»ï¼Œæä¾›ç»™å½“å‰ç¤ºä¾‹ä½¿ç”¨ã€‚ä»£ç å¦‚ä¸‹ï¼š")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v('// ClusteringMessage.java\n\npublic class ClusteringMessage implements Serializable {\n\n    public static final String QUEUE = "QUEUE_CLUSTERING";\n\n    /**\n     * ç¼–å·\n     */\n    private Integer id;\n\n    // ... çœç•¥ set/get/toString æ–¹æ³•\n\n}\n')])])]),r("ul",[r("li",[e._v("åœ¨æ¶ˆæ¯ç±»é‡Œï¼Œæˆ‘ä»¬æšä¸¾äº† Queue çš„åå­—ã€‚")])]),e._v(" "),r("h3",{attrs:{id:"_4-1-4-activemqconfig"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-4-activemqconfig"}},[e._v("#")]),e._v(" 4.1.4 ActiveMQConfig")]),e._v(" "),r("p",[e._v("åœ¨ "),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo-message-model/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/config",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("cn.iocoder.springboot.lab32.activemqdemo.config")]),r("OutboundLink")],1),e._v(" åŒ…ä¸‹ï¼Œåˆ›å»º "),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo-message-model/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/config/ActiveMQConfig.java",target:"_blank",rel:"noopener noreferrer"}},[e._v("ActiveMQConfig"),r("OutboundLink")],1),e._v(" é…ç½®ç±»ï¼Œæ·»åŠ é›†ç¾¤æ¶ˆè´¹éœ€è¦çš„é…ç½®ã€‚ä»£ç å¦‚ä¸‹ï¼š")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v('// ActiveMQConfig.java\n\npublic static final String CLUSTERING_JMS_LISTENER_CONTAINER_FACTORY_BEAN_NAME = "clusteringJmsListenerContainerFactory";\n\npublic static final String CLUSTERING_JMS_TEMPLATE_BEAN_NAME = "clusteringJmsTemplate";\n\n@Bean(CLUSTERING_JMS_LISTENER_CONTAINER_FACTORY_BEAN_NAME)\npublic DefaultJmsListenerContainerFactory clusteringJmsListenerContainerFactory(\n        DefaultJmsListenerContainerFactoryConfigurer configurer, ConnectionFactory connectionFactory) {\n    DefaultJmsListenerContainerFactory factory = new DefaultJmsListenerContainerFactory();\n    configurer.configure(factory, connectionFactory);\n    factory.setPubSubDomain(false);\n    return factory;\n}\n\n@Bean(CLUSTERING_JMS_TEMPLATE_BEAN_NAME)\npublic JmsMessagingTemplate clusteringJmsTemplate(ConnectionFactory connectionFactory) {\n    // åˆ›å»º JmsTemplate å¯¹è±¡\n    JmsTemplate template = new JmsTemplate(connectionFactory);\n    template.setPubSubDomain(false);\n    // åˆ›å»º JmsMessageTemplate\n    return new JmsMessagingTemplate(template);\n}\n')])])]),r("ul",[r("li",[r("p",[e._v("é€šè¿‡")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("spring.jms.pub-sub-domain\n")])])]),r("p",[e._v("é…ç½®é¡¹ï¼Œæ§åˆ¶åˆ›å»ºçš„ JmsTemplate å’Œ DefaultJmsListenerContainerFactory Bean æ˜¯é’ˆå¯¹")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("true\n")])])]),r("p",[e._v("å¹¿æ’­æ¶ˆè´¹ï¼Œè¿˜æ˜¯")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("false\n")])])]),r("p",[e._v("é›†ç¾¤æ¶ˆè´¹ã€‚")]),e._v(" "),r("ul",[r("li",[e._v("å› ä¸ºåœ¨æœ¬å°èŠ‚çš„ç¤ºä¾‹é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬æ—¢è¦æ”¯æŒé›†ç¾¤æ¶ˆè´¹ï¼Œåˆè¦æ”¯æŒå¹¿æ’­æ¶ˆè´¹ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦"),r("strong",[e._v("æ‰‹åŠ¨")]),e._v("åˆ›å»ºä¸¤å¥— JmsTemplate å’Œ DefaultJmsListenerContainerFactory Bean ï¼Œåˆ†åˆ«ç»™"),r("a",{attrs:{href:"https://www.iocoder.cn/Spring-Boot/ActiveMQ/?self#",target:"_blank",rel:"noopener noreferrer"}},[e._v("ã€Œ4.1 é›†ç¾¤æ¶ˆè´¹ã€"),r("OutboundLink")],1),e._v("å’Œ"),r("a",{attrs:{href:"https://www.iocoder.cn/Spring-Boot/ActiveMQ/?self#",target:"_blank",rel:"noopener noreferrer"}},[e._v("ã€Œ4.2 å¹¿æ’­æ¶ˆè´¹ã€"),r("OutboundLink")],1),e._v("ä½¿ç”¨ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å…ˆç»™é›†ç¾¤æ¶ˆè´¹åˆ›å»ºäº†ä¸€å¥— JmsTemplate å’Œ DefaultJmsListenerContainerFactory ã€‚")]),e._v(" "),r("li",[e._v("å¦‚æœèƒ–å‹çš„é¡¹ç›®ä¸­ï¼Œåªéœ€è¦æŒé›†ç¾¤æ¶ˆè´¹æˆ–å¹¿æ’­æ¶ˆè´¹çš„å…¶ä¸­ä¸€ç§ï¼Œä»…ä»…éœ€è¦ "),r("code",[e._v("spring.jms.pub-sub-domain")]),e._v(" é…ç½®é¡¹å³å¯ï¼Œæ— éœ€"),r("strong",[e._v("æ‰‹åŠ¨")]),e._v("ä¸€å¥— JmsTemplate å’Œ DefaultJmsListenerContainerFactory Bean ã€‚")])])]),e._v(" "),r("li",[r("p",[e._v("å¦å¤–ï¼Œå› ä¸ºæˆ‘ä»¬åœ¨ Producer ä¸­ï¼Œä½¿ç”¨çš„æ˜¯ JmsMessagingTemplate æ¥å‘é€æ¶ˆæ¯ï¼Œæ‰€ä»¥è¿™é‡Œæœ€ç»ˆåˆ›å»ºçš„æ˜¯ JmsMessagingTemplate Bean ã€‚")])])]),e._v(" "),r("h3",{attrs:{id:"_4-1-5-clusteringproducer"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-5-clusteringproducer"}},[e._v("#")]),e._v(" 4.1.5 ClusteringProducer")]),e._v(" "),r("p",[e._v("åœ¨ "),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo-message-model/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/producer",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("cn.iocoder.springboot.lab32.activemqdemo.producer")]),r("OutboundLink")],1),e._v(" åŒ…ä¸‹ï¼Œåˆ›å»º "),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo-message-model/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/producer/ClusteringProducer.java",target:"_blank",rel:"noopener noreferrer"}},[e._v("ClusteringProducer"),r("OutboundLink")],1),e._v(" ç±»ï¼Œå®ƒä¼šä½¿ç”¨ Spring-JMS å°è£…æä¾›çš„ JmsMessagingTemplate ï¼Œå®ç°å‘é€æ¶ˆæ¯ã€‚ä»£ç å¦‚ä¸‹ï¼š")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("// ClusteringProducer.java\n\n@Component\npublic class ClusteringProducer {\n\n    @Resource(name = ActiveMQConfig.CLUSTERING_JMS_TEMPLATE_BEAN_NAME)\n    private JmsMessagingTemplate jmsTemplate;\n\n    public void syncSend(Integer id) {\n        // åˆ›å»º ClusteringMessage æ¶ˆæ¯\n        ClusteringMessage message = new ClusteringMessage();\n        message.setId(id);\n        // åŒæ­¥å‘é€æ¶ˆæ¯\n        jmsTemplate.convertAndSend(ClusteringMessage.QUEUE, message);\n    }\n\n}\n")])])]),r("ul",[r("li",[e._v("æ³¨æ„ï¼Œè¦æ³¨å…¥å¯¹åº”çš„ Bean åå­—ä¸º "),r("code",[e._v("ActiveMQConfig.CLUSTERING_JMS_TEMPLATE_BEAN_NAME")]),e._v(" çš„ JmsMessagingTemplate å¯¹è±¡ã€‚")])]),e._v(" "),r("h3",{attrs:{id:"_4-1-6-clusteringconsumer"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-6-clusteringconsumer"}},[e._v("#")]),e._v(" 4.1.6 ClusteringConsumer")]),e._v(" "),r("p",[e._v("åœ¨ "),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo-message-model/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/consumer",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("cn.iocoder.springboot.lab32.activemqdemo.consumer")]),r("OutboundLink")],1),e._v(" åŒ…ä¸‹ï¼Œåˆ›å»º "),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo-message-model/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/consumer/ClusteringConsumer.java",target:"_blank",rel:"noopener noreferrer"}},[e._v("ClusteringConsumer"),r("OutboundLink")],1),e._v(" ç±»ï¼Œ"),r("strong",[e._v("é›†ç¾¤")]),e._v("æ¶ˆè´¹æ¶ˆæ¯ã€‚ä»£ç å¦‚ä¸‹ï¼š")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v('// ClusteringConsumer.java\n\n@Component\npublic class ClusteringConsumer {\n\n    private Logger logger = LoggerFactory.getLogger(getClass());\n\n    @JmsListener(destination = ClusteringMessage.QUEUE,\n            containerFactory = ActiveMQConfig.CLUSTERING_JMS_LISTENER_CONTAINER_FACTORY_BEAN_NAME)\n    public void onMessage(ClusteringMessage message) {\n        logger.info("[onMessage][çº¿ç¨‹ç¼–å·:{} æ¶ˆæ¯å†…å®¹ï¼š{}]", Thread.currentThread().getId(), message);\n    }\n\n}\n')])])]),r("ul",[r("li",[e._v("åœ¨ "),r("code",[e._v("@JmsListener")]),e._v(" æ³¨è§£çš„ "),r("code",[e._v("containerFactory")]),e._v(" å±æ€§ï¼Œè®¾ç½® Bean åå­—ä¸º "),r("code",[e._v("ActiveMQConfig.CLUSTERING_JMS_TEMPLATE_BEAN_NAME")]),e._v(" çš„ DefaultJmsListenerContainerFactory å¯¹è±¡ã€‚")])]),e._v(" "),r("h3",{attrs:{id:"_4-1-7-ç®€å•æµ‹è¯•"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-7-ç®€å•æµ‹è¯•"}},[e._v("#")]),e._v(" 4.1.7 ç®€å•æµ‹è¯•")]),e._v(" "),r("p",[e._v("åˆ›å»º "),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo-message-model/src/test/java/cn/iocoder/springboot/lab32/activemqdemo/producer/ClusteringProducerTest.java",target:"_blank",rel:"noopener noreferrer"}},[e._v("ClusteringProducerTest"),r("OutboundLink")],1),e._v(" æµ‹è¯•ç±»ï¼Œç”¨äºæµ‹è¯•é›†ç¾¤æ¶ˆè´¹ã€‚ä»£ç å¦‚ä¸‹ï¼š")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v('// ClusteringProducerTest.java\n\n@RunWith(SpringRunner.class)\n@SpringBootTest(classes = Application.class)\npublic class ClusteringProducerTest {\n\n    private Logger logger = LoggerFactory.getLogger(getClass());\n\n    @Autowired\n    private ClusteringProducer producer;\n\n    @Test\n    public void mock() throws InterruptedException {\n        // é˜»å¡ç­‰å¾…ï¼Œä¿è¯æ¶ˆè´¹\n        new CountDownLatch(1).await();\n    }\n\n    @Test\n    public void testSyncSend() throws InterruptedException {\n        // å‘é€ 3 æ¡æ¶ˆæ¯\n        for (int i = 0; i < 3; i++) {\n            int id = (int) (System.currentTimeMillis() / 1000);\n            producer.syncSend(id);\n            logger.info("[testSyncSend][å‘é€ç¼–å·ï¼š[{}] å‘é€æˆåŠŸ]", id);\n        }\n\n        // é˜»å¡ç­‰å¾…ï¼Œä¿è¯æ¶ˆè´¹\n        new CountDownLatch(1).await();\n    }\n\n}\n')])])]),r("p",[e._v("é¦–å…ˆï¼Œæ‰§è¡Œ "),r("code",[e._v("#mock()")]),e._v(" æµ‹è¯•æ–¹æ³•ï¼Œå…ˆå¯åŠ¨ä¸€ä¸ªæ¶ˆè´¹ "),r("code",[e._v('"QUEUE_CLUSTERING"')]),e._v(" è¿™ä¸ª Queue çš„ Consumer èŠ‚ç‚¹ã€‚")]),e._v(" "),r("p",[e._v("ç„¶åï¼Œæ‰§è¡Œ "),r("code",[e._v("#testSyncSend()")]),e._v(" æµ‹è¯•æ–¹æ³•ï¼Œå†å¯åŠ¨ä¸€ä¸ªæ¶ˆè´¹ "),r("code",[e._v('"QUEUE_CLUSTERING"')]),e._v(" è¿™ä¸ª Queue çš„ Consumer èŠ‚ç‚¹ã€‚åŒæ—¶ï¼Œè¯¥æµ‹è¯•æ–¹æ³•ï¼Œè°ƒç”¨ "),r("code",[e._v("ClusteringProducer#syncSend(id)")]),e._v(" æ–¹æ³•ï¼ŒåŒæ­¥å‘é€äº† 3 æ¡æ¶ˆæ¯ã€‚æ§åˆ¶å°è¾“å‡ºå¦‚ä¸‹ï¼š")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("// #### testSyncSend æ–¹æ³•å¯¹åº”çš„æ§åˆ¶å° ####\n\n# Producer åŒæ­¥å‘é€æ¶ˆæ¯æˆåŠŸ\n2019-12-15 13:43:07.010  INFO 79244 --- [           main] c.i.s.l.a.p.ClusteringProducerTest       : [testSyncSend][å‘é€ç¼–å·ï¼š[1576388586] å‘é€æˆåŠŸ]\n2019-12-15 13:43:07.015  INFO 79244 --- [           main] c.i.s.l.a.p.ClusteringProducerTest       : [testSyncSend][å‘é€ç¼–å·ï¼š[1576388587] å‘é€æˆåŠŸ]\n2019-12-15 13:43:07.017  INFO 79244 --- [           main] c.i.s.l.a.p.ClusteringProducerTest       : [testSyncSend][å‘é€ç¼–å·ï¼š[1576388587] å‘é€æˆåŠŸ]\n\n# ClusteringConsumer æ¶ˆè´¹äº† 1 æ¡æ¶ˆæ¯\n2019-12-15 13:43:07.021  INFO 79244 --- [enerContainer-1] c.i.s.l.a.consumer.ClusteringConsumer    : [onMessage][çº¿ç¨‹ç¼–å·:18 æ¶ˆæ¯å†…å®¹ï¼šClusteringtMessage{id=1576388587}]\n\n// ### mock æ–¹æ³•å¯¹åº”çš„æ§åˆ¶å° ####\n\n# ClusteringConsumer æ¶ˆè´¹äº† 2 æ¡æ¶ˆæ¯\n2019-12-15 13:43:07.029  INFO 79234 --- [enerContainer-1] c.i.s.l.a.consumer.ClusteringConsumer    : [onMessage][çº¿ç¨‹ç¼–å·:18 æ¶ˆæ¯å†…å®¹ï¼šClusteringtMessage{id=1576388586}]\n2019-12-15 13:43:07.034  INFO 79234 --- [enerContainer-1] c.i.s.l.a.consumer.ClusteringConsumer    : [onMessage][çº¿ç¨‹ç¼–å·:18 æ¶ˆæ¯å†…å®¹ï¼šClusteringtMessage{id=1576388587}\n")])])]),r("ul",[r("li",[e._v("3 æ¡æ¶ˆæ¯ï¼Œéƒ½ä»…è¢« "),r("strong",[e._v("ä¸¤ä¸ª")]),e._v(" Consumer èŠ‚ç‚¹çš„"),r("strong",[e._v("ä¸€ä¸ª")]),e._v("è¿›è¡Œæ¶ˆè´¹ã€‚ç¬¦åˆé›†ç¾¤æ¶ˆè´¹çš„é¢„æœŸ~")])]),e._v(" "),r("h3",{attrs:{id:"_4-1-8-å¤šé›†ç¾¤ä¸‹çš„é›†ç¾¤æ¶ˆè´¹"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-8-å¤šé›†ç¾¤ä¸‹çš„é›†ç¾¤æ¶ˆè´¹"}},[e._v("#")]),e._v(" 4.1.8 å¤šé›†ç¾¤ä¸‹çš„é›†ç¾¤æ¶ˆè´¹")]),e._v(" "),r("p",[e._v("åœ¨"),r("a",{attrs:{href:"https://www.iocoder.cn/Spring-Boot/ActiveMQ/?self#",target:"_blank",rel:"noopener noreferrer"}},[e._v("ã€Œ4.1 é›†ç¾¤æ¶ˆè´¹ã€"),r("OutboundLink")],1),e._v("çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬åªæä¾›äº†"),r("strong",[e._v("å•é›†ç¾¤")]),e._v("ä¸‹çš„é›†ç¾¤æ¶ˆè´¹ã€‚å®é™…ä¸šåŠ¡åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šå­˜åœ¨"),r("strong",[e._v("å¤šé›†ç¾¤")]),e._v("çš„é›†ç¾¤æ¶ˆè´¹ã€‚ä¸äº†è§£çš„èƒ–å‹ï¼Œå¯ä»¥çœ‹çœ‹"),r("a",{attrs:{href:"https://www.cnblogs.com/Peter2014/p/9389600.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("ã€ŠActiveMQ ä¹‹ VirtualTopic æ˜¯ä»€ä¹ˆï¼Ÿã€‹"),r("OutboundLink")],1),e._v(" ã€‚")]),e._v(" "),r("p",[e._v("æ­£å¦‚è¯¥æ–‡ç« çš„æ ‡é¢˜ï¼Œéœ€è¦é€šè¿‡ ActiveMQ "),r("strong",[e._v("è‡ªå®šä¹‰")]),e._v("çš„ VirtualTopic è™šæ‹Ÿä¸»é¢˜ï¼Œè€Œé JMS æ‰€æä¾›çš„ã€‚å…·ä½“çš„ç¤ºä¾‹ï¼Œèƒ–å‹å¯ä»¥å…ˆçœ‹å¦‚ä¸‹ä¸¤ç¯‡æ–‡ç« ï¼š")]),e._v(" "),r("ul",[r("li",[r("a",{attrs:{href:"http://blog.sina.com.cn/s/blog_7d1968e20102wyq0.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("ã€Šspringboot-29-activemq è™šæ‹Ÿä¸»é¢˜å®ç°æ¶ˆè´¹è€…åˆ†ç»„å’Œç®€å•è·¯ç”±ã€‹"),r("OutboundLink")],1)]),e._v(" "),r("li",[r("a",{attrs:{href:"https://blog.csdn.net/kimmking/article/details/9773085",target:"_blank",rel:"noopener noreferrer"}},[e._v("ã€ŠActiveMQ é«˜çº§ç‰¹æ€§ï¼šè™šæ‹Ÿ Destinations å®ç°æ¶ˆè´¹è€…åˆ†ç»„ä¸ç®€å•è·¯ç”±ã€‹"),r("OutboundLink")],1)])]),e._v(" "),r("h2",{attrs:{id:"_4-2-å¹¿æ’­æ¶ˆè´¹"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-å¹¿æ’­æ¶ˆè´¹"}},[e._v("#")]),e._v(" 4.2 å¹¿æ’­æ¶ˆè´¹")]),e._v(" "),r("p",[e._v("åœ¨ ActiveMQ ä¸­ï¼Œå¦‚æœå¤šä¸ª Consumer è®¢é˜…ç›¸åŒçš„ Topic ï¼Œé‚£ä¹ˆæ¯ä¸€æ¡æ¶ˆæ¯"),r("strong",[e._v("éƒ½")]),e._v("ä¼šè¢«ä¸€ä¸ª Consumer æ‰€æ¶ˆè´¹ã€‚è¿™ä¸ªç‰¹æ€§ï¼Œå°±ä¸ºæˆ‘ä»¬å®ç°å¹¿æ’­æ¶ˆè´¹æä¾›äº†åŸºç¡€ã€‚")]),e._v(" "),r("p",[e._v("ä¸‹é¢ï¼Œè®©æˆ‘ä»¬å¼€å§‹é›†ç¾¤æ¶ˆè´¹çš„ç¤ºä¾‹ã€‚")]),e._v(" "),r("h3",{attrs:{id:"_4-2-1-broadcastmessage"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-1-broadcastmessage"}},[e._v("#")]),e._v(" 4.2.1 BroadcastMessage")]),e._v(" "),r("p",[e._v("åœ¨ "),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo-message-model/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/message/",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("cn.iocoder.springboot.lab32.activemqdemo.message")]),r("OutboundLink")],1),e._v(" åŒ…ä¸‹ï¼Œåˆ›å»º "),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo-message-model/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/message/BroadcastMessage.java",target:"_blank",rel:"noopener noreferrer"}},[e._v("BroadcastMessage"),r("OutboundLink")],1),e._v(" æ¶ˆæ¯ç±»ï¼Œæä¾›ç»™å½“å‰ç¤ºä¾‹ä½¿ç”¨ã€‚ä»£ç å¦‚ä¸‹ï¼š")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v('// ClusteringMessage.java\n\npublic class BroadcastMessage implements Serializable {\n\n    public static final String TOPIC = "TOPIC_BROADCASTING";\n\n    /**\n     * ç¼–å·\n     */\n    private Integer id;\n\n    // ... çœç•¥ set/get/toString æ–¹æ³•\n\n}\n')])])]),r("ul",[r("li",[e._v("åœ¨æ¶ˆæ¯ç±»é‡Œï¼Œæˆ‘ä»¬æšä¸¾äº† Topic çš„åå­—ã€‚")])]),e._v(" "),r("h3",{attrs:{id:"_4-2-2-activemqconfig"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-2-activemqconfig"}},[e._v("#")]),e._v(" 4.2.2 ActiveMQConfig")]),e._v(" "),r("p",[e._v("ä¿®æ”¹ "),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo-message-model/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/config/ActiveMQConfig.java",target:"_blank",rel:"noopener noreferrer"}},[e._v("ActiveMQConfig"),r("OutboundLink")],1),e._v(" é…ç½®ç±»ï¼Œæ·»åŠ å¹¿æ’­æ¶ˆè´¹éœ€è¦çš„é…ç½®ã€‚ä»£ç å¦‚ä¸‹ï¼š")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v('// ActiveMQConfig.java\n\npublic static final String BROADCAST_JMS_LISTENER_CONTAINER_FACTORY_BEAN_NAME = "broadcastJmsListenerContainerFactory";\n\npublic static final String BROADCAST_JMS_TEMPLATE_BEAN_NAME = "broadcastJmsTemplate";\n\n    @Bean(BROADCAST_JMS_LISTENER_CONTAINER_FACTORY_BEAN_NAME)\npublic DefaultJmsListenerContainerFactory broadcastJmsListenerContainerFactory(\n        DefaultJmsListenerContainerFactoryConfigurer configurer, ConnectionFactory connectionFactory) {\n    DefaultJmsListenerContainerFactory factory = new DefaultJmsListenerContainerFactory();\n    configurer.configure(factory, connectionFactory);\n    factory.setPubSubDomain(true);\n    return factory;\n}\n\n@Bean(BROADCAST_JMS_TEMPLATE_BEAN_NAME)\npublic JmsMessagingTemplate broadcastJmsTemplate(ConnectionFactory connectionFactory) {\n    // åˆ›å»º JmsTemplate å¯¹è±¡\n    JmsTemplate template = new JmsTemplate(connectionFactory);\n    template.setPubSubDomain(true);\n    // åˆ›å»º JmsMessageTemplate\n    return new JmsMessagingTemplate(template);\n}\n')])])]),r("ul",[r("li",[e._v("åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ç»™é›†ç¾¤æ¶ˆè´¹åˆ›å»ºäº†ä¸€å¥— JmsTemplate å’Œ DefaultJmsListenerContainerFactory ã€‚")])]),e._v(" "),r("h3",{attrs:{id:"_4-2-3-broadcastproducer"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-3-broadcastproducer"}},[e._v("#")]),e._v(" 4.2.3 BroadcastProducer")]),e._v(" "),r("p",[e._v("åœ¨ "),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo-message-model/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/producer",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("cn.iocoder.springboot.lab32.activemqdemo.producer")]),r("OutboundLink")],1),e._v(" åŒ…ä¸‹ï¼Œåˆ›å»º "),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo-message-model/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/producer/BroadcastProducer.java",target:"_blank",rel:"noopener noreferrer"}},[e._v("BroadcastProducer"),r("OutboundLink")],1),e._v(" ç±»ï¼Œå®ƒä¼šä½¿ç”¨ Spring-JMS å°è£…æä¾›çš„ JmsMessagingTemplate ï¼Œå®ç°å‘é€æ¶ˆæ¯ã€‚ä»£ç å¦‚ä¸‹ï¼š")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("// BroadcastProducer.java\n\n@Component\npublic class BroadcastProducer {\n\n    @Resource(name = ActiveMQConfig.BROADCAST_JMS_TEMPLATE_BEAN_NAME)\n    private JmsMessagingTemplate jmsMessagingTemplate;\n\n    public void syncSend(Integer id) {\n        // åˆ›å»º BroadcastMessage æ¶ˆæ¯\n        BroadcastMessage message = new BroadcastMessage();\n        message.setId(id);\n        // åŒæ­¥å‘é€æ¶ˆæ¯\n        jmsMessagingTemplate.convertAndSend(BroadcastMessage.TOPIC, message);\n    }\n\n}\n")])])]),r("ul",[r("li",[e._v("å’Œ"),r("a",{attrs:{href:"https://www.iocoder.cn/Spring-Boot/ActiveMQ/?self#",target:"_blank",rel:"noopener noreferrer"}},[e._v("ã€Œ4.1.5 ClusteringProducerã€"),r("OutboundLink")],1),e._v("æ˜¯ä¸€è‡´ï¼Œåªæ˜¯ä½¿ç”¨äº†ä¸åŒçš„ Topic å’Œæ¶ˆæ¯ã€‚")]),e._v(" "),r("li",[e._v("æ³¨æ„ï¼Œè¦æ³¨å…¥å¯¹åº”çš„ Bean åå­—ä¸º "),r("code",[e._v("ActiveMQConfig.BROADCAST_JMS_TEMPLATE_BEAN_NAME")]),e._v(" çš„ JmsMessagingTemplate å¯¹è±¡ã€‚")])]),e._v(" "),r("h3",{attrs:{id:"_4-2-4-broadcastconsumer"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-4-broadcastconsumer"}},[e._v("#")]),e._v(" 4.2.4 BroadcastConsumer")]),e._v(" "),r("p",[e._v("åœ¨ "),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo-message-model/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/consumer",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("cn.iocoder.springboot.lab32.activemqdemo.consumer")]),r("OutboundLink")],1),e._v(" åŒ…ä¸‹ï¼Œåˆ›å»º "),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo-message-model/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/consumer/BroadcastConsumer.java",target:"_blank",rel:"noopener noreferrer"}},[e._v("BroadcastConsumer"),r("OutboundLink")],1),e._v(" ç±»ï¼Œ"),r("strong",[e._v("å¹¿æ’­")]),e._v("æ¶ˆè´¹æ¶ˆæ¯ã€‚ä»£ç å¦‚ä¸‹ï¼š")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v('// BroadcastConsumer.java\n\n@Component\npublic class BroadcastConsumer {\n\n    private Logger logger = LoggerFactory.getLogger(getClass());\n\n    @JmsListener(destination = BroadcastMessage.TOPIC,\n            containerFactory = ActiveMQConfig.BROADCAST_JMS_LISTENER_CONTAINER_FACTORY_BEAN_NAME)\n    public void onMessage(BroadcastMessage message) {\n        logger.info("[onMessage][çº¿ç¨‹ç¼–å·:{} æ¶ˆæ¯å†…å®¹ï¼š{}]", Thread.currentThread().getId(), message);\n    }\n\n}\n')])])]),r("ul",[r("li",[e._v("æ€»ä½“å’Œ"),r("a",{attrs:{href:"https://www.iocoder.cn/Spring-Boot/ActiveMQ/?self#",target:"_blank",rel:"noopener noreferrer"}},[e._v("ã€Œ4.1.6 ClusteringConsumerã€"),r("OutboundLink")],1),e._v("æ˜¯ä¸€è‡´çš„ã€‚")]),e._v(" "),r("li",[e._v("åœ¨ "),r("code",[e._v("@JmsListener")]),e._v(" æ³¨è§£çš„ "),r("code",[e._v("containerFactory")]),e._v(" å±æ€§ï¼Œè®¾ç½® Bean åå­—ä¸º "),r("code",[e._v("ActiveMQConfig.BROADCAST_JMS_LISTENER_CONTAINER_FACTORY_BEAN_NAME")]),e._v(" çš„ DefaultJmsListenerContainerFactory å¯¹è±¡ã€‚")])]),e._v(" "),r("h3",{attrs:{id:"_4-2-5-ç®€å•æµ‹è¯•"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-5-ç®€å•æµ‹è¯•"}},[e._v("#")]),e._v(" 4.2.5 ç®€å•æµ‹è¯•")]),e._v(" "),r("p",[e._v("åˆ›å»º "),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo-message-model/src/test/java/cn/iocoder/springboot/lab32/activemqdemo/producer/BroadcastProducerTest.java",target:"_blank",rel:"noopener noreferrer"}},[e._v("BroadcastProducerTest"),r("OutboundLink")],1),e._v(" æµ‹è¯•ç±»ï¼Œç”¨äºæµ‹è¯•å¹¿æ’­æ¶ˆè´¹ã€‚ä»£ç å¦‚ä¸‹ï¼š")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v('// BroadcastProducerTest.java\n\n@RunWith(SpringRunner.class)\n@SpringBootTest(classes = Application.class)\npublic class BroadcastProducerTest {\n\n    private Logger logger = LoggerFactory.getLogger(getClass());\n\n    @Autowired\n    private BroadcastProducer producer;\n\n    @Test\n    public void mock() throws InterruptedException {\n        // é˜»å¡ç­‰å¾…ï¼Œä¿è¯æ¶ˆè´¹\n        new CountDownLatch(1).await();\n    }\n\n    @Test\n    public void testSyncSend() throws InterruptedException {\n        for (int i = 0; i < 3; i++) {\n            int id = (int) (System.currentTimeMillis() / 1000);\n            producer.syncSend(id);\n            logger.info("[testSyncSend][å‘é€ç¼–å·ï¼š[{}] å‘é€æˆåŠŸ]", id);\n        }\n\n        // é˜»å¡ç­‰å¾…ï¼Œä¿è¯æ¶ˆè´¹\n        new CountDownLatch(1).await();\n    }\n\n}\n')])])]),r("p",[e._v("é¦–å…ˆï¼Œæ‰§è¡Œ "),r("code",[e._v("#mock()")]),e._v(" æµ‹è¯•æ–¹æ³•ï¼Œå…ˆå¯åŠ¨ä¸€ä¸ªæ¶ˆè´¹ "),r("code",[e._v('"TOPIC_BROADCASTING"')]),e._v(" è¿™ä¸ª Topic çš„ Consumer èŠ‚ç‚¹ã€‚")]),e._v(" "),r("p",[e._v("ç„¶åï¼Œæ‰§è¡Œ "),r("code",[e._v("#testSyncSend()")]),e._v(" æµ‹è¯•æ–¹æ³•ï¼Œå†å¯åŠ¨ä¸€ä¸ªæ¶ˆè´¹ "),r("code",[e._v('"TOPIC_BROADCASTING"')]),e._v(" è¿™ä¸ª Topic çš„ Consumer èŠ‚ç‚¹ã€‚åŒæ—¶ï¼Œè¯¥æµ‹è¯•æ–¹æ³•ï¼Œè°ƒç”¨ "),r("code",[e._v("BroadcastProducer#syncSend(id)")]),e._v(" æ–¹æ³•ï¼ŒåŒæ­¥å‘é€äº† 3 æ¡æ¶ˆæ¯ã€‚æ§åˆ¶å°è¾“å‡ºå¦‚ä¸‹ï¼š")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("// #### testSyncSend æ–¹æ³•å¯¹åº”çš„æ§åˆ¶å° ####\n\n# Producer åŒæ­¥å‘é€æ¶ˆæ¯æˆåŠŸ\n2019-12-15 14:11:41.256  INFO 80487 --- [           main] c.i.s.l.a.p.BroadcastProducerTest        : [testSyncSend][å‘é€ç¼–å·ï¼š[1576390301] å‘é€æˆåŠŸ]\n2019-12-15 14:11:41.258  INFO 80487 --- [           main] c.i.s.l.a.p.BroadcastProducerTest        : [testSyncSend][å‘é€ç¼–å·ï¼š[1576390301] å‘é€æˆåŠŸ]\n2019-12-15 14:11:41.259  INFO 80487 --- [           main] c.i.s.l.a.p.BroadcastProducerTest        : [testSyncSend][å‘é€ç¼–å·ï¼š[1576390301] å‘é€æˆåŠŸ]\n\n# BroadcastConsumer æ¶ˆè´¹äº† 3 æ¡æ¶ˆæ¯\n2019-12-15 14:11:41.259  INFO 80487 --- [enerContainer-1] c.i.s.l.a.consumer.BroadcastConsumer     : [onMessage][çº¿ç¨‹ç¼–å·:19 æ¶ˆæ¯å†…å®¹ï¼šBroadcastMessage{id=1576390301}]\n2019-12-15 14:11:41.261  INFO 80487 --- [enerContainer-1] c.i.s.l.a.consumer.BroadcastConsumer     : [onMessage][çº¿ç¨‹ç¼–å·:19 æ¶ˆæ¯å†…å®¹ï¼šBroadcastMessage{id=1576390301}]\n2019-12-15 14:11:41.263  INFO 80487 --- [enerContainer-1] c.i.s.l.a.consumer.BroadcastConsumer     : [onMessage][çº¿ç¨‹ç¼–å·:19 æ¶ˆæ¯å†…å®¹ï¼šBroadcastMessage{id=1576390301}]\n\n// ### mock æ–¹æ³•å¯¹åº”çš„æ§åˆ¶å° ####\n\n# BroadcastConsumer ä¹Ÿæ¶ˆè´¹äº† 3 æ¡æ¶ˆ\n2019-12-15 14:11:41.275  INFO 80478 --- [enerContainer-1] c.i.s.l.a.consumer.BroadcastConsumer     : [onMessage][çº¿ç¨‹ç¼–å·:19 æ¶ˆæ¯å†…å®¹ï¼šBroadcastMessage{id=1576390301}]\n2019-12-15 14:11:41.278  INFO 80478 --- [enerContainer-1] c.i.s.l.a.consumer.BroadcastConsumer     : [onMessage][çº¿ç¨‹ç¼–å·:19 æ¶ˆæ¯å†…å®¹ï¼šBroadcastMessage{id=1576390301}]\n2019-12-15 14:11:41.279  INFO 80478 --- [enerContainer-1] c.i.s.l.a.consumer.BroadcastConsumer     : [onMessage][çº¿ç¨‹ç¼–å·:19 æ¶ˆæ¯å†…å®¹ï¼šBroadcastMessage{id=1576390301}]\n")])])]),r("ul",[r("li",[r("strong",[e._v("ä¸¤ä¸ª")]),e._v(" Consumer èŠ‚ç‚¹ï¼Œéƒ½æ¶ˆè´¹äº†è¿™æ¡å‘é€çš„æ¶ˆæ¯ã€‚ç¬¦åˆå¹¿æ’­æ¶ˆè´¹çš„é¢„æœŸ~")])]),e._v(" "),r("h1",{attrs:{id:"_5-å®šæ—¶æ¶ˆæ¯"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_5-å®šæ—¶æ¶ˆæ¯"}},[e._v("#")]),e._v(" 5. å®šæ—¶æ¶ˆæ¯")]),e._v(" "),r("blockquote",[r("p",[e._v("ç¤ºä¾‹ä»£ç å¯¹åº”ä»“åº“ï¼š"),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo-delay",target:"_blank",rel:"noopener noreferrer"}},[e._v("lab-32-activemq-demo-delay"),r("OutboundLink")],1)])]),e._v(" "),r("p",[e._v("ActiveMQ å†…ç½®äº†å¯¹å®šæ—¶æ¶ˆæ¯çš„æ”¯æŒï¼Œä¸äº†è§£çš„èƒ–å‹ï¼Œå¯ä»¥çœ‹çœ‹å¦‚ä¸‹æ–‡æ¡£ï¼š")]),e._v(" "),r("ul",[r("li",[r("a",{attrs:{href:"http://activemq.apache.org/delay-and-schedule-message-delivery.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("ã€ŠActiveMQ å®˜æ–¹æ–‡æ¡£ â€”â€” Delay and Schedule Message Deliveryã€‹"),r("OutboundLink")],1)]),e._v(" "),r("li",[r("a",{attrs:{href:"https://blog.csdn.net/KimmKing/article/details/8443872",target:"_blank",rel:"noopener noreferrer"}},[e._v("ã€ŠActiveMQ æ¶ˆæ¯ç‰¹æ€§ï¼šå»¶è¿Ÿå’Œå®šæ—¶æ¶ˆæ¯æŠ•é€’ï¼ˆDelay and Schedule Message Deliveryï¼‰ã€‹"),r("OutboundLink")],1)])]),e._v(" "),r("p",[e._v("é»˜è®¤æƒ…å†µä¸‹ï¼ŒActiveMQ é»˜è®¤æœªå¼€å¯å®šæ—¶æ¶ˆæ¯çš„åŠŸèƒ½ï¼Œéœ€è¦æˆ‘ä»¬"),r("strong",[e._v("æ‰‹åŠ¨")]),e._v("å»é…ç½®å¼€å¯ã€‚é€šè¿‡ç¼–è¾‘ "),r("code",[e._v("conf/activemq.xml")]),e._v(" é…ç½®æ–‡ä»¶ï¼Œæ·»åŠ  "),r("code",[e._v('schedulerSupport="true"')]),e._v(" æ¥å¼€å¯ã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v('\x3c!--\n    The <broker> element is used to configure the ActiveMQ broker.\n--\x3e\n<broker xmlns="http://activemq.apache.org/schema/core" brokerName="localhost" dataDirectory="${activemq.data}" schedulerSupport="true">\n')])])]),r("p",[e._v("é…ç½®å®Œæˆï¼Œé€šè¿‡ "),r("code",[e._v("bin/macosx/activemq restart")]),e._v(" å°† ActiveMQ é‡å¯å³å¯ç”Ÿæ•ˆã€‚")]),e._v(" "),r("p",[e._v("ä¸‹é¢ï¼Œæˆ‘ä»¬æ¥å®ç°ä¸€ä¸ªå®šæ—¶æ¶ˆæ¯çš„ç¤ºä¾‹ã€‚è€ƒè™‘åˆ°ä¸æ±¡æŸ“ä¸Šè¿°çš„ç¤ºä¾‹ï¼Œæˆ‘ä»¬æ–°å»ºä¸€ä¸ª "),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo-delay",target:"_blank",rel:"noopener noreferrer"}},[e._v("lab-32-activemq-demo-delay"),r("OutboundLink")],1),e._v(" é¡¹ç›®ã€‚")]),e._v(" "),r("h2",{attrs:{id:"_5-1-å¼•å…¥ä¾èµ–"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-å¼•å…¥ä¾èµ–"}},[e._v("#")]),e._v(" 5.1 å¼•å…¥ä¾èµ–")]),e._v(" "),r("p",[e._v("å’Œ "),r("a",{attrs:{href:"https://www.iocoder.cn/Spring-Boot/ActiveMQ/?self#",target:"_blank",rel:"noopener noreferrer"}},[e._v("ã€Œ3.1 å¼•å…¥ä¾èµ–ã€"),r("OutboundLink")],1),e._v(" ä¸€è‡´ï¼Œè§ "),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo-delay/pom.xml",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("pom.xml")]),r("OutboundLink")],1),e._v(" æ–‡ä»¶ã€‚")]),e._v(" "),r("h2",{attrs:{id:"_5-2-åº”ç”¨é…ç½®æ–‡ä»¶"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-åº”ç”¨é…ç½®æ–‡ä»¶"}},[e._v("#")]),e._v(" 5.2 åº”ç”¨é…ç½®æ–‡ä»¶")]),e._v(" "),r("p",[e._v("å’Œ "),r("a",{attrs:{href:"https://www.iocoder.cn/Spring-Boot/ActiveMQ/?self#",target:"_blank",rel:"noopener noreferrer"}},[e._v("ã€Œ3.2 åº”ç”¨é…ç½®æ–‡ä»¶ã€"),r("OutboundLink")],1),e._v(" ä¸€è‡´ï¼Œè§ "),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo-delay/src/main/resources/application.yaml",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("application.yaml")]),r("OutboundLink")],1),e._v(" æ–‡ä»¶ã€‚")]),e._v(" "),r("h2",{attrs:{id:"_5-3-demo02message"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_5-3-demo02message"}},[e._v("#")]),e._v(" 5.3 Demo02Message")]),e._v(" "),r("p",[e._v("åœ¨ "),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo-delay/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/message",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("cn.iocoder.springboot.lab32.activemqdemo.message")]),r("OutboundLink")],1),e._v(" åŒ…ä¸‹ï¼Œåˆ›å»º "),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo-delay/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/message/Demo02Message.java",target:"_blank",rel:"noopener noreferrer"}},[e._v("Demo02Message"),r("OutboundLink")],1),e._v(" æ¶ˆæ¯ç±»ï¼Œæä¾›ç»™å½“å‰ç¤ºä¾‹ä½¿ç”¨ã€‚")]),e._v(" "),r("p",[e._v("å’Œ"),r("a",{attrs:{href:"https://www.iocoder.cn/Spring-Boot/ActiveMQ/?self#",target:"_blank",rel:"noopener noreferrer"}},[e._v("ã€Œ3.4 Demo01Messageã€"),r("OutboundLink")],1),e._v("ä¸€è‡´ï¼Œåªæ˜¯ Queue åå­—ä¸åŒã€‚")]),e._v(" "),r("h2",{attrs:{id:"_5-4-demo02producer"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_5-4-demo02producer"}},[e._v("#")]),e._v(" 5.4 Demo02Producer")]),e._v(" "),r("p",[e._v("åœ¨ "),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo-delay/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/producer",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("cn.iocoder.springboot.lab32.activemqdemo.producer")]),r("OutboundLink")],1),e._v(" åŒ…ä¸‹ï¼Œåˆ›å»º "),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo-delay/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/producer/Demo02Producer.java",target:"_blank",rel:"noopener noreferrer"}},[e._v("Demo02Producer"),r("OutboundLink")],1),e._v(" ç±»ï¼Œå®ƒä¼šä½¿ç”¨ Spring-JMS å°è£…æä¾›çš„ JmsMessagingTemplate ï¼Œå®ç°å‘é€"),r("strong",[e._v("å®šæ—¶")]),e._v("æ¶ˆæ¯ã€‚ä»£ç å¦‚ä¸‹ï¼š")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("// Demo02Producer.java\n\n@Component\npublic class Demo02Producer {\n\n    @Autowired\n    private JmsMessagingTemplate jmsTemplate;\n\n    public void syncSend(Integer id, Integer delay) {\n        // åˆ›å»º Demo02Message æ¶ˆæ¯\n        Demo02Message message = new Demo02Message();\n        message.setId(id);\n        // åˆ›å»º Header\n        Map<String, Object> headers = null;\n        if (delay != null && delay > 0) {\n            headers = new HashMap<>();\n            headers.put(ScheduledMessage.AMQ_SCHEDULED_DELAY, delay);\n        }\n        // åŒæ­¥å‘é€æ¶ˆæ¯\n        jmsTemplate.convertAndSend(Demo02Message.QUEUE, message, headers);\n    }\n\n}\n")])])]),r("ul",[r("li",[e._v("è°ƒç”¨ "),r("code",[e._v("#syncSend(Integer id, Integer delay)")]),e._v(" æ–¹æ³•æ¥å‘é€æ¶ˆæ¯æ—¶ï¼Œå¦‚æœä¼ é€’äº†æ–¹æ³•å‚æ•° "),r("code",[e._v("delay")]),e._v(" ï¼Œåˆ™æˆ‘ä»¬ä¼šè®¾ç½®åˆ°æ¶ˆæ¯çš„ Header çš„ "),r("code",[e._v("AMQ_SCHEDULED_DELAY")]),e._v(" ä¸­ï¼Œå®ç°å»¶è¿Ÿ "),r("code",[e._v("delay")]),e._v(" æ¯«ç§’çš„å®šæ—¶æ¶ˆæ¯ã€‚")])]),e._v(" "),r("h2",{attrs:{id:"_5-5-demo02consumer"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_5-5-demo02consumer"}},[e._v("#")]),e._v(" 5.5 Demo02Consumer")]),e._v(" "),r("p",[e._v("åœ¨ "),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo-delay/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/consumer",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("cn.iocoder.springboot.lab32.activemqdemo.consumer")]),r("OutboundLink")],1),e._v(" åŒ…ä¸‹ï¼Œåˆ›å»º "),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo-delay/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/consumer/Demo02Consumer.java",target:"_blank",rel:"noopener noreferrer"}},[e._v("Demo02Consumer"),r("OutboundLink")],1),e._v(" ç±»ï¼Œæ¶ˆè´¹æ¶ˆæ¯ã€‚")]),e._v(" "),r("p",[e._v("å’Œ"),r("a",{attrs:{href:"https://www.iocoder.cn/Spring-Boot/ActiveMQ/?self#",target:"_blank",rel:"noopener noreferrer"}},[e._v("ã€Œ3.6 Demo01Consumerã€"),r("OutboundLink")],1),e._v("åŸºæœ¬ä¸€è‡´ï¼Œå·®åˆ«åœ¨äºæ¶ˆè´¹çš„é˜Ÿåˆ—æ˜¯ "),r("code",[e._v('"QUEUE_DEMO_02"')]),e._v(" ã€‚")]),e._v(" "),r("h2",{attrs:{id:"_5-6-ç®€å•æµ‹è¯•"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_5-6-ç®€å•æµ‹è¯•"}},[e._v("#")]),e._v(" 5.6 ç®€å•æµ‹è¯•")]),e._v(" "),r("p",[e._v("åˆ›å»º "),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo-delay/src/test/java/cn/iocoder/springboot/lab32/activemqdemo/producer/Demo02ProducerTest.java",target:"_blank",rel:"noopener noreferrer"}},[e._v("Demo02ProducerTest"),r("OutboundLink")],1),e._v(" æµ‹è¯•ç±»ï¼Œç¼–å†™å•å…ƒæµ‹è¯•æ–¹æ³•ï¼Œæµ‹è¯•"),r("strong",[e._v("å®šæ—¶æ¶ˆæ¯")]),e._v("çš„æ•ˆæœã€‚ä»£ç å¦‚ä¸‹ï¼š")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v('// Demo02ProducerTest.java\n\n@RunWith(SpringRunner.class)\n@SpringBootTest(classes = Application.class)\npublic class Demo02ProducerTest {\n\n    private Logger logger = LoggerFactory.getLogger(getClass());\n\n    @Autowired\n    private Demo02Producer producer;\n\n    @Test\n    public void testSyncSend01() throws InterruptedException {\n        // ä¸è®¾ç½®æ¶ˆæ¯çš„è¿‡æœŸæ—¶é—´\n        this.testSyncSendDelay(null);\n    }\n\n    @Test\n    public void testSyncSend02() throws InterruptedException {\n        // è®¾ç½®å‘é€æ¶ˆæ¯çš„è¿‡æœŸæ—¶é—´ä¸º 5000 æ¯«ç§’\n        this.testSyncSendDelay(5000);\n    }\n\n    private void testSyncSendDelay(Integer delay) throws InterruptedException {\n        int id = (int) (System.currentTimeMillis() / 1000);\n        producer.syncSend(id, delay);\n        logger.info("[testSyncSendDelay][å‘é€ç¼–å·ï¼š[{}] å‘é€æˆåŠŸ]", id);\n\n        // é˜»å¡ç­‰å¾…ï¼Œä¿è¯æ¶ˆè´¹\n        new CountDownLatch(1).await();\n    }\n\n}\n')])])]),r("ul",[r("li",[r("code",[e._v("#testSyncSend01()")]),e._v(" æ–¹æ³•ï¼Œä¸è®¾ç½®æ¶ˆæ¯çš„è¿‡æœŸæ—¶é—´ã€‚")]),e._v(" "),r("li",[r("code",[e._v("#testSyncSend02()")]),e._v(" æ–¹æ³•ï¼Œå‘é€æ¶ˆæ¯çš„"),r("strong",[e._v("è¿‡æœŸæ—¶é—´ä¸º 5000 æ¯«ç§’")]),e._v("ã€‚")])]),e._v(" "),r("p",[e._v("æˆ‘ä»¬å…ˆæ¥æ‰§è¡Œ "),r("code",[e._v("#testSyncSend01()")]),e._v(" æ–¹æ³•ï¼Œä¸è®¾ç½®æ¶ˆæ¯çš„è¿‡æœŸæ—¶é—´ã€‚æ§åˆ¶å°è¾“å‡ºå¦‚ä¸‹ï¼š")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("# Producer åŒæ­¥å‘é€æ¶ˆæ¯æˆåŠŸã€‚\n2019-12-15 17:40:07.597  INFO 84240 --- [           main] c.i.s.l.a.producer.Demo02ProducerTest    : [testSyncSendDelay][å‘é€ç¼–å·ï¼š[1576402807] å‘é€æˆåŠŸ]\n\n# Consumer ç«‹å³æ¶ˆè´¹åˆ°è¯¥æ¶ˆæ¯\n2019-12-15 17:40:07.599  INFO 84240 --- [enerContainer-1] c.i.s.l.a.consumer.Demo02Consumer        : [onMessage][çº¿ç¨‹ç¼–å·:18 æ¶ˆæ¯å†…å®¹ï¼šDemo01Message{id=1576402807}]\n")])])]),r("ul",[r("li",[e._v("ç¬¦åˆé¢„æœŸï¼Œæ¶ˆæ¯è¢« Consumer ç«‹å³æ¶ˆè´¹ã€‚")])]),e._v(" "),r("p",[e._v("æˆ‘ä»¬å†æ¥æ‰§è¡Œ "),r("code",[e._v("#testSyncSend02()")]),e._v(" æ–¹æ³•ï¼Œå‘é€æ¶ˆæ¯çš„"),r("strong",[e._v("è¿‡æœŸæ—¶é—´ä¸º 5000 æ¯«ç§’")]),e._v("ã€‚æ§åˆ¶å°è¾“å‡ºå¦‚ä¸‹ï¼š")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("# Producer åŒæ­¥å‘é€æ¶ˆæ¯æˆåŠŸã€‚\n2019-12-15 17:42:34.560  INFO 84344 --- [           main] c.i.s.l.a.producer.Demo02ProducerTest    : [testSyncSendDelay][å‘é€ç¼–å·ï¼š[1576402954] å‘é€æˆåŠŸ]\n\n# Consumer 5 ç§’åï¼Œæ¶ˆè´¹åˆ°è¯¥æ¶ˆæ¯\n2019-12-15 17:42:40.010  INFO 84344 --- [enerContainer-1] c.i.s.l.a.consumer.Demo02Consumer        : [onMessage][çº¿ç¨‹ç¼–å·:18 æ¶ˆæ¯å†…å®¹ï¼šDemo02Message{id=1576402954}]\n")])])]),r("ul",[r("li",[e._v("ç¬¦åˆé¢„æœŸï¼Œæ¶ˆæ¯ 5 ç§’åè¢« Consumer ç«‹å³æ¶ˆè´¹ã€‚")])]),e._v(" "),r("h1",{attrs:{id:"_6-å¹¶å‘æ¶ˆè´¹"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_6-å¹¶å‘æ¶ˆè´¹"}},[e._v("#")]),e._v(" 6. å¹¶å‘æ¶ˆè´¹")]),e._v(" "),r("blockquote",[r("p",[e._v("ç¤ºä¾‹ä»£ç å¯¹åº”ä»“åº“ï¼š"),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo-concurrency",target:"_blank",rel:"noopener noreferrer"}},[e._v("lab-32-activemq-demo-concurrency"),r("OutboundLink")],1)])]),e._v(" "),r("p",[e._v("åœ¨ä¸Šè¿°çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬é…ç½®çš„æ¯ä¸€ä¸ª Spring-JMS "),r("code",[e._v("@JmsListener")]),e._v(" ï¼Œéƒ½æ˜¯"),r("strong",[e._v("ä¸²è¡Œ")]),e._v("æ¶ˆè´¹çš„ã€‚æ˜¾ç„¶ï¼Œè¿™åœ¨ç›‘å¬çš„ Queue æ¯ç§’æ¶ˆæ¯é‡æ¯”è¾ƒå¤§çš„æ—¶å€™ï¼Œä¼šå¯¼è‡´æ¶ˆè´¹ä¸åŠæ—¶ï¼Œå¯¼è‡´æ¶ˆæ¯ç§¯å‹çš„é—®é¢˜ã€‚")]),e._v(" "),r("p",[e._v("è™½ç„¶è¯´ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å¯åŠ¨å¤šä¸ª JVM è¿›ç¨‹ï¼Œå®ç°"),r("strong",[e._v("å¤šè¿›ç¨‹çš„å¹¶å‘æ¶ˆè´¹")]),e._v("ï¼Œä»è€ŒåŠ é€Ÿæ¶ˆè´¹çš„é€Ÿåº¦ã€‚ä½†æ˜¯é—®é¢˜æ˜¯ï¼Œå¦èƒ½å¤Ÿå®ç°"),r("strong",[e._v("å¤šçº¿ç¨‹")]),e._v("çš„å¹¶å‘æ¶ˆè´¹å‘¢ï¼Ÿç­”æ¡ˆæ˜¯"),r("strong",[e._v("æœ‰")]),e._v("ã€‚")]),e._v(" "),r("p",[e._v("åœ¨ "),r("code",[e._v("@JmsListener")]),e._v(" æ³¨è§£ä¸­ï¼Œæœ‰ "),r("code",[e._v("concurrency")]),e._v(" å±æ€§ï¼Œå®ƒå¯ä»¥æŒ‡å®šå¹¶å‘æ¶ˆè´¹çš„çº¿ç¨‹æ•°ã€‚ä¾‹å¦‚è¯´ï¼Œå¦‚æœè®¾ç½® "),r("code",[e._v("concurrency=4")]),e._v(" æ—¶ï¼ŒSpring-AMQP å°±ä¼šä¸º"),r("strong",[e._v("è¯¥")]),e._v(" "),r("code",[e._v("@JmsListener")]),e._v(" åˆ›å»º"),r("strong",[e._v("è‡³å¤š")]),e._v(" 4 ä¸ªçº¿ç¨‹ï¼Œè¿›è¡Œå¹¶å‘æ¶ˆè´¹ã€‚")]),e._v(" "),r("p",[e._v("è€ƒè™‘åˆ°è®©èƒ–å‹èƒ½å¤Ÿæ›´å¥½çš„ç†è§£ "),r("code",[e._v("concurrency")]),e._v(" å±æ€§ï¼Œæˆ‘ä»¬æ¥ç®€å•è¯´è¯´ Spring-JMS åœ¨è¿™å—çš„å®ç°æ–¹å¼ã€‚æˆ‘ä»¬æ¥ä¸¾ä¸ªä¾‹å­ï¼š")]),e._v(" "),r("ul",[r("li",[e._v("é¦–å…ˆï¼Œæˆ‘ä»¬æ¥åˆ›å»ºä¸€ä¸ª Queue ä¸º "),r("code",[e._v('"DEMO_03"')]),e._v(" ã€‚")]),e._v(" "),r("li",[e._v("ç„¶åï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ª Demo03Consumer ç±»ï¼Œå¹¶åœ¨å…¶æ¶ˆè´¹æ–¹æ³•ä¸Šï¼Œæ·»åŠ  "),r("code",[e._v("@JmsListener(concurrency=2)")]),e._v(" æ³¨è§£ã€‚")]),e._v(" "),r("li",[e._v("å†ç„¶åï¼Œæˆ‘ä»¬å¯åŠ¨é¡¹ç›®ã€‚Spring-AMQP ä¼šæ ¹æ® "),r("code",[e._v("@JmsListener(concurrency=2)")]),e._v(" æ³¨è§£ï¼Œåˆ›å»º "),r("strong",[e._v("2")]),e._v(" ä¸ª ActiveMQ Consumer ã€‚æ³¨æ„å™¢ï¼Œæ˜¯ "),r("strong",[e._v("2")]),e._v(" ä¸ª ActiveMQ Consumer å‘¢ï¼ï¼ï¼åç»­ï¼Œæ¯ä¸ª ActiveMQ Consumer ä¼šè¢«"),r("strong",[e._v("å•ç‹¬")]),e._v("åˆ†é…åˆ°ä¸€ä¸ªçº¿ç¨‹ä¸­ï¼Œè¿›è¡Œæ‹‰å–æ¶ˆæ¯ï¼Œæ¶ˆè´¹æ¶ˆæ¯ã€‚")])]),e._v(" "),r("p",[e._v("é…±ç´«è®²è§£ä¸€ä¸‹ï¼Œèƒ–å‹å¯¹ Spring-JMS å®ç°"),r("strong",[e._v("å¤šçº¿ç¨‹")]),e._v("çš„å¹¶å‘æ¶ˆè´¹çš„æœºåˆ¶ï¼Œæ˜¯å¦ç†è§£äº†ã€‚")]),e._v(" "),r("p",[e._v("ä¸‹é¢ï¼Œæˆ‘ä»¬å¼€å§‹æœ¬å°èŠ‚çš„ç¤ºä¾‹ã€‚æœ¬ç¤ºä¾‹å°±æ˜¯ä¸Šè¿°ä¸¾ä¾‹çš„å…·ä½“å®ç°ã€‚è€ƒè™‘åˆ°ä¸æ±¡æŸ“ä¸Šè¿°çš„ç¤ºä¾‹ï¼Œæˆ‘ä»¬æ–°å»ºä¸€ä¸ª "),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo-concurrency",target:"_blank",rel:"noopener noreferrer"}},[e._v("lab-32-activemq-demo-concurrency"),r("OutboundLink")],1),e._v(" é¡¹ç›®ã€‚")]),e._v(" "),r("h2",{attrs:{id:"_6-1-å¼•å…¥ä¾èµ–"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_6-1-å¼•å…¥ä¾èµ–"}},[e._v("#")]),e._v(" 6.1 å¼•å…¥ä¾èµ–")]),e._v(" "),r("p",[e._v("å’Œ "),r("a",{attrs:{href:"https://www.iocoder.cn/Spring-Boot/ActiveMQ/?self#",target:"_blank",rel:"noopener noreferrer"}},[e._v("ã€Œ3.1 å¼•å…¥ä¾èµ–ã€"),r("OutboundLink")],1),e._v(" ä¸€è‡´ï¼Œè§ "),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo-concurrency/pom.xml",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("pom.xml")]),r("OutboundLink")],1),e._v(" æ–‡ä»¶ã€‚")]),e._v(" "),r("h2",{attrs:{id:"_6-2-åº”ç”¨é…ç½®æ–‡ä»¶"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_6-2-åº”ç”¨é…ç½®æ–‡ä»¶"}},[e._v("#")]),e._v(" 6.2 åº”ç”¨é…ç½®æ–‡ä»¶")]),e._v(" "),r("p",[e._v("å’Œ "),r("a",{attrs:{href:"https://www.iocoder.cn/Spring-Boot/ActiveMQ/?self#",target:"_blank",rel:"noopener noreferrer"}},[e._v("ã€Œ3.2 åº”ç”¨é…ç½®æ–‡ä»¶ã€"),r("OutboundLink")],1),e._v(" ä¸€è‡´ï¼Œè§ "),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo-concurrency/src/main/resources/application.yaml",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("application.yaml")]),r("OutboundLink")],1),e._v(" æ–‡ä»¶ã€‚")]),e._v(" "),r("h2",{attrs:{id:"_6-3-demo03message"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_6-3-demo03message"}},[e._v("#")]),e._v(" 6.3 Demo03Message")]),e._v(" "),r("p",[e._v("åœ¨ "),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo-concurrency/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/message",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("cn.iocoder.springboot.lab32.activemqdemo.message")]),r("OutboundLink")],1),e._v(" åŒ…ä¸‹ï¼Œåˆ›å»º "),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo-concurrency/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/message/Demo03Message.java",target:"_blank",rel:"noopener noreferrer"}},[e._v("Demo03Message"),r("OutboundLink")],1),e._v(" æ¶ˆæ¯ç±»ï¼Œæä¾›ç»™å½“å‰ç¤ºä¾‹ä½¿ç”¨ã€‚")]),e._v(" "),r("p",[e._v("å’Œ"),r("a",{attrs:{href:"https://www.iocoder.cn/Spring-Boot/ActiveMQ/?self#",target:"_blank",rel:"noopener noreferrer"}},[e._v("ã€Œ3.4 Demo01Messageã€"),r("OutboundLink")],1),e._v("ä¸€è‡´ï¼Œåªæ˜¯ Queue åå­—ä¸åŒã€‚")]),e._v(" "),r("h2",{attrs:{id:"_6-4-demo03producer"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_6-4-demo03producer"}},[e._v("#")]),e._v(" 6.4 Demo03Producer")]),e._v(" "),r("p",[e._v("åœ¨ "),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo-concurrency/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/producer/",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("cn.iocoder.springboot.lab32.activemqdemo.producer")]),r("OutboundLink")],1),e._v(" åŒ…ä¸‹ï¼Œåˆ›å»º "),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo-concurrency/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/producer/Demo03Producer.java",target:"_blank",rel:"noopener noreferrer"}},[e._v("Demo03Producer"),r("OutboundLink")],1),e._v(" ç±»ï¼Œå®ƒä¼šä½¿ç”¨ Spring-JMS å°è£…æä¾›çš„ JmsMessagingTemplate ï¼Œå®ç°å‘é€æ¶ˆæ¯ã€‚")]),e._v(" "),r("p",[e._v("å’Œ"),r("a",{attrs:{href:"https://www.iocoder.cn/Spring-Boot/ActiveMQ/?self#",target:"_blank",rel:"noopener noreferrer"}},[e._v("ã€Œ3.5 Demo01Producerã€"),r("OutboundLink")],1),e._v("ä¸€è‡´ï¼Œåªæ˜¯ Queue åå­—ä¸åŒã€‚")]),e._v(" "),r("h2",{attrs:{id:"_6-5-demo03consumer"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_6-5-demo03consumer"}},[e._v("#")]),e._v(" 6.5 Demo03Consumer")]),e._v(" "),r("p",[e._v("åœ¨ "),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo-concurrency/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/consumer/",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("cn.iocoder.springboot.lab32.activemqdemo.consumer")]),r("OutboundLink")],1),e._v(" åŒ…ä¸‹ï¼Œåˆ›å»º "),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo-concurrency/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/consumer/Demo03Consumer.java",target:"_blank",rel:"noopener noreferrer"}},[e._v("Demo03Consumer"),r("OutboundLink")],1),e._v(" ç±»ï¼Œ"),r("strong",[e._v("å¹¶å‘")]),e._v("æ¶ˆè´¹æ¶ˆæ¯ã€‚ä»£ç å¦‚ä¸‹ï¼š")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v('// Demo03Consumer.java\n\n@Component\npublic class Demo03Consumer {\n\n    private Logger logger = LoggerFactory.getLogger(getClass());\n\n    @JmsListener(destination = Demo03Message.QUEUE,\n        concurrency = "2")\n    public void onMessage(Demo03Message message) {\n        logger.info("[onMessage][çº¿ç¨‹ç¼–å·:{} æ¶ˆæ¯å†…å®¹ï¼š{}]", Thread.currentThread().getId(), message);\n    }\n\n}\n')])])]),r("ul",[r("li",[e._v("å’Œ"),r("a",{attrs:{href:"https://www.iocoder.cn/Spring-Boot/ActiveMQ/?self#",target:"_blank",rel:"noopener noreferrer"}},[e._v("ã€Œ3.6 Demo06Consumerã€"),r("OutboundLink")],1),e._v("ä¸€è‡´ï¼Œåªå·®åœ¨æ¶ˆè´¹ä¸åŒçš„é˜Ÿåˆ—ã€‚")]),e._v(" "),r("li",[e._v("ã€é‡è¦ã€‘å¦å¤–ï¼Œå¯ä»¥é€šè¿‡ "),r("code",[e._v("@JmsListener")]),e._v(" æ³¨è§£çš„ "),r("code",[e._v("concurrency")]),e._v(" å±æ€§ï¼Œè®¾ç½®å¹¶å‘æ•°ä¸º "),r("strong",[e._v("2")]),e._v("ã€‚")])]),e._v(" "),r("h2",{attrs:{id:"_6-6-ç®€å•æµ‹è¯•"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_6-6-ç®€å•æµ‹è¯•"}},[e._v("#")]),e._v(" 6.6 ç®€å•æµ‹è¯•")]),e._v(" "),r("p",[e._v("åˆ›å»º "),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo-concurrency/src/test/java/cn/iocoder/springboot/lab32/activemqdemo/producer/Demo03ProducerTest.java",target:"_blank",rel:"noopener noreferrer"}},[e._v("Demo03ProducerTest"),r("OutboundLink")],1),e._v(" æµ‹è¯•ç±»ï¼Œç¼–å†™ä¸€ä¸ªå•å…ƒæµ‹è¯•æ–¹æ³•ï¼Œå‘é€ 10 æ¡æ¶ˆæ¯ï¼Œè§‚å¯Ÿå¹¶å‘æ¶ˆè´¹æƒ…å†µã€‚ä»£ç å¦‚ä¸‹ï¼š")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v('// Demo03ProducerTest.java\n\n@RunWith(SpringRunner.class)\n@SpringBootTest(classes = Application.class)\npublic class Demo03ProducerTest {\n\n    private Logger logger = LoggerFactory.getLogger(getClass());\n\n    @Autowired\n    private Demo03Producer producer;\n\n    @Test\n    public void testSyncSend() throws InterruptedException {\n        for (int i = 0; i < 10; i++) {\n            int id = (int) (System.currentTimeMillis() / 1000);\n            producer.syncSend(id);\n//            logger.info("[testSyncSend][å‘é€ç¼–å·ï¼š[{}] å‘é€æˆåŠŸ]", id);\n        }\n\n        // é˜»å¡ç­‰å¾…ï¼Œä¿è¯æ¶ˆè´¹\n        new CountDownLatch(1).await();\n    }\n\n}\n')])])]),r("p",[e._v("æ‰§è¡Œå•å…ƒæµ‹è¯•æ–¹æ³•ï¼Œæ§åˆ¶å°è¾“å‡ºå¦‚ä¸‹ï¼š")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("# çº¿ç¨‹ç¼–å·ä¸º 18\n2019-12-15 18:17:13.796  INFO 85887 --- [enerContainer-1] c.i.s.l.a.consumer.Demo03Consumer        : [onMessage][çº¿ç¨‹ç¼–å·:18 æ¶ˆæ¯å†…å®¹ï¼šDemo03Message{id=1576405033}]\n2019-12-15 18:17:13.800  INFO 85887 --- [enerContainer-1] c.i.s.l.a.consumer.Demo03Consumer        : [onMessage][çº¿ç¨‹ç¼–å·:18 æ¶ˆæ¯å†…å®¹ï¼šDemo03Message{id=1576405033}]\n2019-12-15 18:17:13.802  INFO 85887 --- [enerContainer-1] c.i.s.l.a.consumer.Demo03Consumer        : [onMessage][çº¿ç¨‹ç¼–å·:18 æ¶ˆæ¯å†…å®¹ï¼šDemo03Message{id=1576405033}]\n2019-12-15 18:17:13.805  INFO 85887 --- [enerContainer-1] c.i.s.l.a.consumer.Demo03Consumer        : [onMessage][çº¿ç¨‹ç¼–å·:18 æ¶ˆæ¯å†…å®¹ï¼šDemo03Message{id=1576405033}]\n2019-12-15 18:17:13.808  INFO 85887 --- [enerContainer-2] c.i.s.l.a.consumer.Demo03Consumer        : [onMessage][çº¿ç¨‹ç¼–å·:21 æ¶ˆæ¯å†…å®¹ï¼šDemo03Message{id=1576405033}]\n\n# çº¿ç¨‹ç¼–å· 18\n2019-12-15 18:17:13.796  INFO 85887 --- [enerContainer-2] c.i.s.l.a.consumer.Demo03Consumer        : [onMessage][çº¿ç¨‹ç¼–å·:21 æ¶ˆæ¯å†…å®¹ï¼šDemo03Message{id=1576405033}]\n2019-12-15 18:17:13.800  INFO 85887 --- [enerContainer-2] c.i.s.l.a.consumer.Demo03Consumer        : [onMessage][çº¿ç¨‹ç¼–å·:21 æ¶ˆæ¯å†…å®¹ï¼šDemo03Message{id=1576405033}]\n2019-12-15 18:17:13.804  INFO 85887 --- [enerContainer-2] c.i.s.l.a.consumer.Demo03Consumer        : [onMessage][çº¿ç¨‹ç¼–å·:21 æ¶ˆæ¯å†…å®¹ï¼šDemo03Message{id=1576405033}]\n2019-12-15 18:17:13.807  INFO 85887 --- [enerContainer-1] c.i.s.l.a.consumer.Demo03Consumer        : [onMessage][çº¿ç¨‹ç¼–å·:18 æ¶ˆæ¯å†…å®¹ï¼šDemo03Message{id=1576405033}]\n2019-12-15 18:17:13.811  INFO 85887 --- [enerContainer-1] c.i.s.l.a.consumer.Demo03Consumer        : [onMessage][çº¿ç¨‹ç¼–å·:18 æ¶ˆæ¯å†…å®¹ï¼šDemo03Message{id=1576405033}]\n")])])]),r("ul",[r("li",[e._v("æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œä¸¤ä¸ªçº¿ç¨‹åœ¨æ¶ˆè´¹ "),r("code",[e._v('"QUEUE_DEMO_09"')]),e._v(" ä¸‹çš„æ¶ˆæ¯ã€‚")])]),e._v(" "),r("p",[e._v("æ­¤æ—¶ï¼Œå¦‚æœæˆ‘ä»¬ä½¿ç”¨ "),r("a",{attrs:{href:"https://activemq.apache.org/web-console",target:"_blank",rel:"noopener noreferrer"}},[e._v("ActiveMQ Web Console"),r("OutboundLink")],1),e._v(" æ¥æŸ¥çœ‹ "),r("code",[e._v('"QUEUE_DEMO_03"')]),e._v(" çš„æ¶ˆè´¹è€…åˆ—è¡¨ï¼š")]),e._v(" "),r("p",[r("img",{attrs:{src:"https://raw.githubusercontent.com/lichengcan/images/main/image-20231214143837954.png",alt:""}})]),e._v(" "),r("h1",{attrs:{id:"_7-é¡ºåºæ¶ˆæ¯"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_7-é¡ºåºæ¶ˆæ¯"}},[e._v("#")]),e._v(" 7. é¡ºåºæ¶ˆæ¯")]),e._v(" "),r("blockquote",[r("p",[e._v("ç¤ºä¾‹ä»£ç å¯¹åº”ä»“åº“ï¼š"),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo-orderly",target:"_blank",rel:"noopener noreferrer"}},[e._v("lab-32-activemq-demo-orderly"),r("OutboundLink")],1)])]),e._v(" "),r("p",[e._v("æˆ‘ä»¬å…ˆæ¥ä¸€èµ·äº†è§£ä¸‹é¡ºåºæ¶ˆæ¯çš„"),r("strong",[e._v("é¡ºåºæ¶ˆæ¯")]),e._v("çš„å®šä¹‰ï¼š")]),e._v(" "),r("ul",[r("li",[e._v("æ™®é€šé¡ºåºæ¶ˆæ¯ ï¼šProducer å°†ç›¸å…³è”çš„æ¶ˆæ¯å‘é€åˆ°ç›¸åŒçš„æ¶ˆæ¯é˜Ÿåˆ—ã€‚")]),e._v(" "),r("li",[e._v("å®Œå…¨ä¸¥æ ¼é¡ºåº ï¼šåœ¨ã€æ™®é€šé¡ºåºæ¶ˆæ¯ã€‘çš„åŸºç¡€ä¸Šï¼ŒConsumer ä¸¥æ ¼é¡ºåºæ¶ˆè´¹ã€‚")])]),e._v(" "),r("p",[e._v("é‚£ä¹ˆï¼Œè®©æˆ‘ä»¬æ¥æ€è€ƒä¸‹ï¼Œå¦‚æœæˆ‘ä»¬å¸Œæœ›åœ¨ ActiveMQ ä¸Šï¼Œå®ç°é¡ºåºæ¶ˆæ¯éœ€è¦åšä¸¤ä¸ªäº‹æƒ…ã€‚")]),e._v(" "),r("p",[e._v("â‘  "),r("strong",[e._v("äº‹æƒ…ä¸€")]),e._v("ï¼Œæˆ‘ä»¬éœ€è¦ä¿è¯ ActiveMQ Producer å‘é€ç›¸å…³è”çš„æ¶ˆæ¯å‘é€åˆ°ç›¸åŒçš„ Queue ä¸­ã€‚ä¾‹å¦‚è¯´ï¼Œæˆ‘ä»¬è¦å‘é€ç”¨æˆ·ä¿¡æ¯å‘ç”Ÿå˜æ›´çš„ Message ï¼Œé‚£ä¹ˆå¦‚æœæˆ‘ä»¬å¸Œæœ›ä½¿ç”¨é¡ºåºæ¶ˆæ¯çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥å°†"),r("strong",[e._v("ç”¨æˆ·ç¼–å·")]),e._v("ç›¸åŒçš„æ¶ˆæ¯å‘é€åˆ°ç›¸åŒçš„ Queue ä¸­ã€‚")]),e._v(" "),r("p",[e._v("â‘¡ "),r("strong",[e._v("äº‹æƒ…äºŒ")]),e._v("ï¼Œæˆ‘ä»¬åœ¨æœ‰"),r("strong",[e._v("ä¸”ä»…å¯åŠ¨ä¸€ä¸ª")]),e._v(" Consumer æ¶ˆè´¹è¯¥é˜Ÿåˆ—ï¼Œä¿è¯ Consumer ä¸¥æ ¼é¡ºåºæ¶ˆè´¹ã€‚")]),e._v(" "),r("p",[e._v("ä¸è¿‡å¦‚æœè¿™æ ·åšï¼Œä¼šå­˜åœ¨ä¸¤ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬é€ä¸ªæ¥çœ‹çœ‹ã€‚")]),e._v(" "),r("p",[e._v("â‘  "),r("strong",[e._v("é—®é¢˜ä¸€")]),e._v("ï¼Œæ­£å¦‚æˆ‘ä»¬åœ¨"),r("a",{attrs:{href:"https://www.iocoder.cn/Spring-Boot/ActiveMQ/?self#",target:"_blank",rel:"noopener noreferrer"}},[e._v("ã€Œ6. å¹¶å‘æ¶ˆè´¹ã€"),r("OutboundLink")],1),e._v("ä¸­æåˆ°ï¼Œå¦‚æœæˆ‘ä»¬å°†æ¶ˆæ¯ä»…ä»…æŠ•é€’åˆ°ä¸€ä¸ª Queue ä¸­ï¼Œå¹¶ä¸”é‡‡ç”¨å•ä¸ª Consumer "),r("strong",[e._v("ä¸²è¡Œ")]),e._v("æ¶ˆè´¹ï¼Œåœ¨ç›‘å¬çš„ Queue æ¯ç§’æ¶ˆæ¯é‡æ¯”è¾ƒå¤§çš„æ—¶å€™ï¼Œä¼šå¯¼è‡´æ¶ˆè´¹ä¸åŠæ—¶ï¼Œå¯¼è‡´æ¶ˆæ¯ç§¯å‹çš„é—®é¢˜ã€‚")]),e._v(" "),r("p",[e._v("æ­¤æ—¶ï¼Œæˆ‘ä»¬æœ‰ä¸¤ç§æ–¹æ¡ˆæ¥è§£å†³ï¼š")]),e._v(" "),r("ul",[r("li",[e._v("æ–¹æ¡ˆä¸€ï¼Œåœ¨ Producer ç«¯ï¼Œå°† Queue æ‹†æˆå¤šä¸ª"),r("strong",[e._v("å­")]),e._v(" Queue ã€‚å‡è®¾åŸå…ˆ Queue æ˜¯ "),r("code",[e._v("QUEUE_USER")]),e._v(" ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±åˆ†æ‹†æˆ "),r("code",[e._v("QUEUE_USER_00")]),e._v(" è‡³ "),r("code",[e._v("QUEUE_USER_..${N-1}")]),e._v(" è¿™æ · N ä¸ªé˜Ÿåˆ—ï¼Œç„¶ååŸºäºæ¶ˆæ¯çš„ç”¨æˆ·ç¼–å·å–ä½™ï¼Œè·¯ç”±åˆ°å¯¹åº”çš„"),r("strong",[e._v("å­")]),e._v(" Queue ä¸­ã€‚")]),e._v(" "),r("li",[e._v("æ–¹æ¡ˆäºŒï¼Œåœ¨ Consumer ç«¯ï¼Œå°† Queue æ‹‰å–åˆ°çš„æ¶ˆæ¯ï¼Œå°†ç›¸å…³è”çš„æ¶ˆæ¯å‘é€åˆ°"),r("strong",[e._v("ç›¸åŒçš„çº¿ç¨‹")]),e._v("ä¸­æ¥æ¶ˆè´¹ã€‚ä¾‹å¦‚è¯´ï¼Œè¿˜æ˜¯ Queue æ˜¯ "),r("code",[e._v("QUEUE_USER")]),e._v(" çš„ä¾‹å­ï¼Œæˆ‘ä»¬åˆ›å»º N ä¸ªçº¿ç¨‹æ± å¤§å°ä¸º 1 çš„ "),r("a",{attrs:{href:"https://github.com/JetBrains/jdk8u_jdk/blob/master/src/share/classes/java/util/concurrent/ExecutorService.java",target:"_blank",rel:"noopener noreferrer"}},[e._v("ExecutorService"),r("OutboundLink")],1),e._v(" æ•°ç»„ï¼Œç„¶ååŸºäºæ¶ˆæ¯çš„ç”¨æˆ·ç¼–å·å–ä½™ï¼Œæäº¤åˆ°å¯¹åº”çš„ ExecutorService ä¸­çš„å•ä¸ªçº¿ç¨‹æ¥æ‰§è¡Œã€‚")])]),e._v(" "),r("p",[e._v("ä¸¤ä¸ªæ–¹æ¡ˆï¼Œå¹¶ä¸å†²çªï¼Œå¯ä»¥ç»“åˆä½¿ç”¨ã€‚")]),e._v(" "),r("p",[e._v("â‘¡ "),r("strong",[e._v("é—®é¢˜äºŒ")]),e._v("ï¼Œå¦‚æœæˆ‘ä»¬å¯åŠ¨ç›¸åŒ Consumer çš„"),r("strong",[e._v("å¤šä¸ªè¿›ç¨‹")]),e._v("ï¼Œä¼šå¯¼è‡´ç›¸åŒ Queue çš„æ¶ˆæ¯è¢«åˆ†é…åˆ°å¤šä¸ª Consumer è¿›è¡Œæ¶ˆè´¹ï¼Œç ´å Consumer ä¸¥æ ¼é¡ºåºæ¶ˆè´¹ã€‚")]),e._v(" "),r("p",[e._v("æ­¤æ—¶ï¼Œæˆ‘ä»¬æœ‰ä¸¤ç§æ–¹æ¡ˆæ¥è§£å†³ï¼š")]),e._v(" "),r("ul",[r("li",[e._v("æ–¹æ¡ˆä¸€ï¼Œå¼•å…¥ Zookeeper æ¥åè°ƒï¼ŒåŠ¨æ€è®¾ç½®å¤šä¸ªè¿›ç¨‹ä¸­çš„"),r("strong",[e._v("ç›¸åŒçš„")]),e._v(" Consumer çš„å¼€å…³ï¼Œä¿è¯æœ‰ä¸”ä»…æœ‰ä¸€ä¸ª Consumer å¼€å¯å¯¹"),r("strong",[e._v("åŒä¸€ä¸ª")]),e._v(" Queue çš„æ¶ˆè´¹ã€‚")]),e._v(" "),r("li",[e._v("æ–¹æ¡ˆäºŒï¼Œä»…é€‚ç”¨äºã€é—®é¢˜ä¸€ã€‘çš„ã€æ–¹æ¡ˆä¸€ã€‘ã€‚è¿˜æ˜¯å¼•å…¥ Zookeeper æ¥åè°ƒï¼ŒåŠ¨æ€è®¾ç½®å¤šä¸ªè¿›ç¨‹ä¸­çš„"),r("strong",[e._v("ç›¸åŒçš„")]),e._v(" Consumer æ¶ˆè´¹çš„ Queue çš„åˆ†é…ï¼Œä¿è¯æœ‰ä¸”ä»…æœ‰ä¸€ä¸ª Consumer å¼€å¯å¯¹"),r("strong",[e._v("åŒä¸€ä¸ª")]),e._v(" Queue çš„æ¶ˆè´¹ã€‚")])]),e._v(" "),r("p",[e._v("ä¸‹é¢ï¼Œæˆ‘ä»¬å¼€å§‹æœ¬å°èŠ‚çš„ç¤ºä¾‹ã€‚æœ¬ç¤ºä¾‹å°±æ˜¯ä¸Šè¿°ä¸¾ä¾‹çš„å…·ä½“å®ç°ã€‚è€ƒè™‘åˆ°ä¸æ±¡æŸ“ä¸Šè¿°çš„ç¤ºä¾‹ï¼Œæˆ‘ä»¬æ–°å»ºä¸€ä¸ª "),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo-orderly",target:"_blank",rel:"noopener noreferrer"}},[e._v("lab-32-activemq-demo-orderly"),r("OutboundLink")],1),e._v(" é¡¹ç›®ã€‚")]),e._v(" "),r("ul",[r("li",[e._v("å¯¹äºé—®é¢˜ä¸€ï¼Œæˆ‘ä»¬é‡‡ç”¨æ–¹æ¡ˆä¸€ã€‚å› ä¸ºåœ¨ Spring-JMS ä¸­ï¼Œè‡ªå·±å®šä¹‰çº¿ç¨‹æ¥æ¶ˆè´¹æ¶ˆæ¯ï¼Œæ— æ³•å’Œç°æœ‰çš„ "),r("a",{attrs:{href:"https://github.com/spring-projects/spring-framework/blob/master/spring-jms/src/main/java/org/springframework/jms/listener/DefaultMessageListenerContainer.java",target:"_blank",rel:"noopener noreferrer"}},[e._v("DefaultMessageListenerContainer"),r("OutboundLink")],1),e._v(" çš„å®ç°æ‰€ç»“åˆï¼Œé™¤éè‡ªå®šä¹‰ä¸€ä¸ª MessageListenerContainer å®ç°ç±»ã€‚")]),e._v(" "),r("li",[e._v("å¯¹äºé—®é¢˜äºŒï¼Œå› ä¸ºå®ç°èµ·æ¥æ¯”è¾ƒå¤æ‚ï¼Œæš‚æ—¶å…ˆä¸æä¾›ã€‚")])]),e._v(" "),r("h2",{attrs:{id:"_7-1-å¼•å…¥ä¾èµ–"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_7-1-å¼•å…¥ä¾èµ–"}},[e._v("#")]),e._v(" 7.1 å¼•å…¥ä¾èµ–")]),e._v(" "),r("p",[e._v("å’Œ "),r("a",{attrs:{href:"https://www.iocoder.cn/Spring-Boot/ActiveMQ/?self#",target:"_blank",rel:"noopener noreferrer"}},[e._v("ã€Œ3.1 å¼•å…¥ä¾èµ–ã€"),r("OutboundLink")],1),e._v(" ä¸€è‡´ï¼Œè§ "),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo-orderly/pom.xml",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("pom.xml")]),r("OutboundLink")],1),e._v(" æ–‡ä»¶ã€‚")]),e._v(" "),r("h2",{attrs:{id:"_7-2-åº”ç”¨é…ç½®æ–‡ä»¶"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_7-2-åº”ç”¨é…ç½®æ–‡ä»¶"}},[e._v("#")]),e._v(" 7.2 åº”ç”¨é…ç½®æ–‡ä»¶")]),e._v(" "),r("p",[e._v("å’Œ "),r("a",{attrs:{href:"https://www.iocoder.cn/Spring-Boot/ActiveMQ/?self#",target:"_blank",rel:"noopener noreferrer"}},[e._v("ã€Œ3.2 åº”ç”¨é…ç½®æ–‡ä»¶ã€"),r("OutboundLink")],1),e._v(" ä¸€è‡´ï¼Œè§ "),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo-orderly/src/main/resources/application.yaml",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("application.yaml")]),r("OutboundLink")],1),e._v(" æ–‡ä»¶ã€‚")]),e._v(" "),r("h2",{attrs:{id:"_7-3-demo04message"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_7-3-demo04message"}},[e._v("#")]),e._v(" 7.3 Demo04Message")]),e._v(" "),r("p",[e._v("åœ¨ "),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo-message-model/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/message/",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("cn.iocoder.springboot.lab32.activemqdemo.message")]),r("OutboundLink")],1),e._v(" åŒ…ä¸‹ï¼Œåˆ›å»º "),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo-orderly/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/message/Demo04Message.java",target:"_blank",rel:"noopener noreferrer"}},[e._v("Demo04Message"),r("OutboundLink")],1),e._v(" æ¶ˆæ¯ç±»ï¼Œæä¾›ç»™å½“å‰ç¤ºä¾‹ä½¿ç”¨ã€‚ä»£ç å¦‚ä¸‹ï¼š")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v('// Demo04Message.java\n\npublic class Demo04Message implements Serializable {\n\n    public static final String QUEUE_BASE = "QUEUE_DEMO_04-";\n    public static final String QUEUE_0 = QUEUE_BASE + "0";\n    public static final String QUEUE_1 = QUEUE_BASE + "1";\n    public static final String QUEUE_2 = QUEUE_BASE + "2";\n    public static final String QUEUE_3 = QUEUE_BASE + "3";\n\n    public static final int QUEUE_COUNT = 4;\n\n    /**\n     * ç¼–å·\n     */\n    private Integer id;\n\n    // ... çœç•¥ set/get/toString æ–¹æ³•\n\n}\n')])])]),r("ul",[r("li",[e._v("å®šä¹‰äº† "),r("code",[e._v("QUEUE_DEMO_04-")]),e._v(" çš„å››ä¸ª"),r("strong",[e._v("å­")]),e._v(" Queue ã€‚")])]),e._v(" "),r("h2",{attrs:{id:"_7-4-demo04producer"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_7-4-demo04producer"}},[e._v("#")]),e._v(" 7.4 Demo04Producer")]),e._v(" "),r("p",[e._v("åœ¨ "),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo-orderly/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/producer",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("cn.iocoder.springboot.lab32.activemqdemo.producer")]),r("OutboundLink")],1),e._v(" åŒ…ä¸‹ï¼Œåˆ›å»º "),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo-orderly/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/producer/Demo04Producer.java",target:"_blank",rel:"noopener noreferrer"}},[e._v("Demo04Producer"),r("OutboundLink")],1),e._v(" ç±»ï¼Œå®ƒä¼šä½¿ç”¨ Spring-JMS å°è£…æä¾›çš„ JmsMessagingTemplate ï¼Œå®ç°å‘é€æ¶ˆæ¯åˆ°"),r("strong",[e._v("å­")]),e._v(" Queue ä¸­ã€‚ä»£ç å¦‚ä¸‹ï¼š")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("// Demo04Producer.java\n\n@Component\npublic class Demo04Producer {\n\n    @Autowired\n    private JmsMessagingTemplate jmsTemplate;\n\n    public void syncSend(Integer id) {\n        // åˆ›å»º Demo04Message æ¶ˆæ¯\n        Demo04Message message = new Demo04Message();\n        message.setId(id);\n        // åŒæ­¥å‘é€æ¶ˆæ¯\n        jmsTemplate.convertAndSend(this.getQueue(id), message);\n    }\n\n    private String getQueue(Integer id) {\n        return Demo04Message.QUEUE_BASE + (id % Demo04Message.QUEUE_COUNT);\n    }\n\n}\n")])])]),r("ul",[r("li",[e._v("å‘é€æ¶ˆæ¯æ—¶ï¼Œæˆ‘ä»¬å¯¹ "),r("code",[e._v("Demo04Message.id % é˜Ÿåˆ—ç¼–å·")]),e._v(" è¿›è¡Œå–ä½™ï¼Œè·å¾—"),r("strong",[e._v("é˜Ÿåˆ—ç¼–å·")]),e._v("ä½œä¸º Queue åç¼€ï¼Œä»è€Œè·å¾—åˆ°å¯¹åº”çš„"),r("strong",[e._v("å­")]),e._v(" Queue ä¸­ã€‚")])]),e._v(" "),r("h2",{attrs:{id:"_7-5-demo04consumer"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_7-5-demo04consumer"}},[e._v("#")]),e._v(" 7.5 Demo04Consumer")]),e._v(" "),r("p",[e._v("åœ¨ "),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo-orderly/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/consumer",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("cn.iocoder.springboot.lab32.activemqdemo.consumer")]),r("OutboundLink")],1),e._v(" åŒ…ä¸‹ï¼Œåˆ›å»º "),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo-orderly/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/consumer/Demo04Consumer.java",target:"_blank",rel:"noopener noreferrer"}},[e._v("Demo04Consumer"),r("OutboundLink")],1),e._v(" ç±»ï¼Œ"),r("strong",[e._v("ä¸¥æ ¼")]),e._v("æ¶ˆè´¹"),r("strong",[e._v("é¡ºåº")]),e._v("æ¶ˆæ¯ã€‚ä»£ç å¦‚ä¸‹ï¼š")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v('// Demo04Consumer.java\n\n@Component\npublic class Demo04Consumer {\n\n    private Logger logger = LoggerFactory.getLogger(getClass());\n\n    @JmsListener(destination = Demo04Message.QUEUE_0)\n    @JmsListener(destination = Demo04Message.QUEUE_1)\n    @JmsListener(destination = Demo04Message.QUEUE_2)\n    @JmsListener(destination = Demo04Message.QUEUE_3)\n    public void onMessage(Demo04Message message) {\n        logger.info("[onMessage][çº¿ç¨‹ç¼–å·:{} æ¶ˆæ¯å†…å®¹ï¼š{}]", Thread.currentThread().getId(), message);\n    }\n\n}\n')])])]),r("ul",[r("li",[e._v("ä¸ºäº†å®ç°æ¯ä¸ª"),r("strong",[e._v("å­")]),e._v(" Queue èƒ½å¤Ÿè¢«æ¯ä¸ª Consumer "),r("strong",[e._v("ä¸²è¡Œ")]),e._v("æ¶ˆè´¹ï¼Œä»è€Œå®ç°åŸºäº"),r("strong",[e._v("å­")]),e._v(" Queue çš„"),r("strong",[e._v("å¹¶è¡Œ")]),e._v("çš„"),r("strong",[e._v("ä¸¥æ ¼")]),e._v("æ¶ˆè´¹"),r("strong",[e._v("é¡ºåº")]),e._v("æ¶ˆæ¯ï¼Œæˆ‘ä»¬åªå¥½åœ¨ç±»ä¸Šæ·»äº†å››ä¸ª "),r("code",[e._v("@JmsListener")]),e._v(" æ³¨è§£ï¼Œæ¯ä¸ªå¯¹åº”ä¸€ä¸ª"),r("strong",[e._v("å­")]),e._v(" Queue ã€‚")]),e._v(" "),r("li",[e._v("å¦‚æœèƒ–å‹ä½¿ç”¨ä¸€ä¸ª "),r("code",[e._v("@JmsListener")]),e._v(" æ³¨è§£ï¼Œå¹¶æ·»åŠ å››ä¸ª"),r("strong",[e._v("å­")]),e._v(" Queue ï¼Œç„¶åè®¾ç½® "),r("code",[e._v("concurrency = 4")]),e._v(" æ—¶ï¼Œå®é™…æ˜¯å¹¶å‘å››ä¸ªçº¿ç¨‹ï¼Œæ¶ˆè´¹å››ä¸ª"),r("strong",[e._v("å­")]),e._v(" Queue çš„æ¶ˆæ¯ï¼Œæ— æ³•ä¿è¯"),r("strong",[e._v("ä¸¥æ ¼")]),e._v("æ¶ˆè´¹"),r("strong",[e._v("é¡ºåº")]),e._v("æ¶ˆæ¯ã€‚")])]),e._v(" "),r("h2",{attrs:{id:"_7-6-ç®€å•æµ‹è¯•"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_7-6-ç®€å•æµ‹è¯•"}},[e._v("#")]),e._v(" 7.6 ç®€å•æµ‹è¯•")]),e._v(" "),r("p",[e._v("åˆ›å»º "),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo-orderly/src/test/java/cn/iocoder/springboot/lab32/activemqdemo/producer/Demo04ProducerTest.java",target:"_blank",rel:"noopener noreferrer"}},[e._v("Demo04ProducerTest"),r("OutboundLink")],1),e._v(" æµ‹è¯•ç±»ï¼Œç¼–å†™ä¸€ä¸ªå•å…ƒæµ‹è¯•æ–¹æ³•ï¼Œå‘é€ 8 æ¡æ¶ˆæ¯ï¼Œè§‚å¯Ÿé¡ºåºæ¶ˆè´¹æƒ…å†µã€‚ä»£ç å¦‚ä¸‹ï¼š")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v('// Demo04ProducerTest.java\n\n@RunWith(SpringRunner.class)\n@SpringBootTest(classes = Application.class)\npublic class Demo04ProducerTest {\n\n    private Logger logger = LoggerFactory.getLogger(getClass());\n\n    @Autowired\n    private Demo04Producer producer;\n\n    @Test\n    public void testSyncSend() throws InterruptedException {\n        for (int i = 0; i < 2; i++) {\n            for (int id = 0; id < 4; id++) {\n                producer.syncSend(id);\n//                logger.info("[testSyncSend][å‘é€ç¼–å·ï¼š[{}] å‘é€æˆåŠŸ]", id);\n            }\n        }\n\n        // é˜»å¡ç­‰å¾…ï¼Œä¿è¯æ¶ˆè´¹\n        new CountDownLatch(1).await();\n    }\n\n}\n')])])]),r("ul",[r("li",[e._v("å‘é€ 2 è½®æ¶ˆæ¯ï¼Œæ¯ä¸€è½®æ¶ˆæ¯çš„ç¼–å·éƒ½æ˜¯ 0 è‡³ 3 ã€‚")])]),e._v(" "),r("p",[e._v("æ‰§è¡Œå•å…ƒæµ‹è¯•æ–¹æ³•ï¼Œæ§åˆ¶å°è¾“å‡ºå¦‚ä¸‹ï¼š")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("# çº¿ç¨‹ç¼–å·ä¸º 21\n2019-12-15 21:44:05.582  INFO 90457 --- [enerContainer-1] c.i.s.l.a.consumer.Demo04Consumer        : [onMessage][çº¿ç¨‹ç¼–å·:21 æ¶ˆæ¯å†…å®¹ï¼šDemo04Message{id=0}]\n2019-12-15 21:44:05.599  INFO 90457 --- [enerContainer-1] c.i.s.l.a.consumer.Demo04Consumer        : [onMessage][çº¿ç¨‹ç¼–å·:21 æ¶ˆæ¯å†…å®¹ï¼šDemo04Message{id=0}]\n\n# çº¿ç¨‹ç¼–å·ä¸º 18\n2019-12-15 21:44:05.591  INFO 90457 --- [enerContainer-1] c.i.s.l.a.consumer.Demo04Consumer        : [onMessage][çº¿ç¨‹ç¼–å·:18 æ¶ˆæ¯å†…å®¹ï¼šDemo04Message{id=2}]\n2019-12-15 21:44:05.605  INFO 90457 --- [enerContainer-1] c.i.s.l.a.consumer.Demo04Consumer        : [onMessage][çº¿ç¨‹ç¼–å·:18 æ¶ˆæ¯å†…å®¹ï¼šDemo04Message{id=2}]\n\n# çº¿ç¨‹ç¼–å·ä¸º 20\n2019-12-15 21:44:05.597  INFO 90457 --- [enerContainer-1] c.i.s.l.a.consumer.Demo04Consumer        : [onMessage][çº¿ç¨‹ç¼–å·:20 æ¶ˆæ¯å†…å®¹ï¼šDemo04Message{id=3}\n2019-12-15 21:44:05.606  INFO 90457 --- [enerContainer-1] c.i.s.l.a.consumer.Demo04Consumer        : [onMessage][çº¿ç¨‹ç¼–å·:20 æ¶ˆæ¯å†…å®¹ï¼šDemo04Message{id=3}]\n\n# çº¿ç¨‹ç¼–å·ä¸º 19\n2019-12-15 21:44:05.583  INFO 90457 --- [enerContainer-1] c.i.s.l.a.consumer.Demo04Consumer        : [onMessage][çº¿ç¨‹ç¼–å·:19 æ¶ˆæ¯å†…å®¹ï¼šDemo04Message{id=1}]\n2019-12-15 21:44:05.602  INFO 90457 --- [enerContainer-1] c.i.s.l.a.consumer.Demo04Consumer        : [onMessage][çº¿ç¨‹ç¼–å·:19 æ¶ˆæ¯å†…å®¹ï¼šDemo04Message{id=1}]\n")])])]),r("ul",[r("li",[e._v("ç›¸åŒç¼–å·çš„æ¶ˆæ¯ï¼Œè¢«æŠ•é€’åˆ°ç›¸åŒçš„"),r("strong",[e._v("å­")]),e._v(" Queue ï¼Œè¢«ç›¸åŒçš„çº¿ç¨‹æ‰€æ¶ˆè´¹ã€‚ç¬¦åˆé¢„æœŸ~")])]),e._v(" "),r("h1",{attrs:{id:"_8-æ¶ˆè´¹é‡è¯•"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_8-æ¶ˆè´¹é‡è¯•"}},[e._v("#")]),e._v(" 8. æ¶ˆè´¹é‡è¯•")]),e._v(" "),r("blockquote",[r("p",[e._v("ç¤ºä¾‹ä»£ç å¯¹åº”ä»“åº“ï¼š"),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo-consume-retry",target:"_blank",rel:"noopener noreferrer"}},[e._v("lab-32-activemq-demo-consume-retry"),r("OutboundLink")],1)])]),e._v(" "),r("p",[e._v("åœ¨æ¶ˆæ¯"),r("strong",[e._v("æ¶ˆè´¹å¤±è´¥")]),e._v("çš„æ—¶å€™ï¼ŒActiveMQ ä¼šé€šè¿‡"),r("strong",[e._v("è‡ªå¸¦çš„")]),e._v(" "),r("a",{attrs:{href:"https://activemq.apache.org/message-redelivery-and-dlq-handling",target:"_blank",rel:"noopener noreferrer"}},[e._v("ReDelivery(é‡æ–°æŠ•é€’)"),r("OutboundLink")],1),e._v(" æœºåˆ¶ï¼Œé‡æ–°æŠ•é€’è¯¥æ¶ˆæ¯ç»™ Consumer ï¼Œè®© Consumer æœ‰æœºä¼šé‡æ–°æ¶ˆè´¹æ¶ˆæ¯ï¼Œå®ç°æ¶ˆè´¹æˆåŠŸã€‚")]),e._v(" "),r("p",[e._v("å½“ç„¶ï¼ŒActiveMQ å¹¶ä¸ä¼šæ— é™é‡æ–°æŠ•é€’æ¶ˆæ¯ç»™ Consumer é‡æ–°æ¶ˆè´¹ï¼Œè€Œæ˜¯åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œè¾¾åˆ° N æ¬¡é‡è¯•æ¬¡æ•°æ—¶ï¼ŒConsumer è¿˜æ˜¯æ¶ˆè´¹å¤±è´¥æ—¶ï¼Œè¯¥æ¶ˆæ¯å°±ä¼šè¿›å…¥åˆ°"),r("strong",[e._v("æ­»ä¿¡é˜Ÿåˆ—")]),e._v("(é»˜è®¤ä¸º "),r("code",[e._v('"ActiveMQ.DLQ"')]),e._v(" é˜Ÿåˆ—)ã€‚åç»­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å¯¹æ­»ä¿¡é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯è¿›è¡Œé‡å‘ï¼Œæ¥ä½¿å¾—æ¶ˆè´¹è€…å®ä¾‹å†æ¬¡è¿›è¡Œæ¶ˆè´¹ã€‚")]),e._v(" "),r("p",[e._v("å¦å¤–ï¼Œæ¯æ¡æ¶ˆæ¯çš„å¤±è´¥é‡è¯•ï¼Œæ˜¯å¯ä»¥é…ç½®ä¸€å®šçš„"),r("strong",[e._v("é—´éš”æ—¶é—´")]),e._v("ã€‚å…·ä½“ï¼Œæˆ‘ä»¬åœ¨ç¤ºä¾‹çš„ä»£ç ä¸­ï¼Œæ¥è¿›è¡Œå…·ä½“çš„è§£é‡Šã€‚")]),e._v(" "),r("p",[e._v("ä¸‹é¢ï¼Œæˆ‘ä»¬æ¥å®ç°ä¸€ä¸ª Consumer æ¶ˆè´¹é‡è¯•çš„ç¤ºä¾‹ã€‚è€ƒè™‘åˆ°ä¸æ±¡æŸ“ä¸Šè¿°çš„ç¤ºä¾‹ï¼Œæˆ‘ä»¬æ–°å»ºä¸€ä¸ª "),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo-consume-retry",target:"_blank",rel:"noopener noreferrer"}},[e._v("lab-32-activemq-demo-consume-retry"),r("OutboundLink")],1),e._v(" é¡¹ç›®ã€‚")]),e._v(" "),r("h2",{attrs:{id:"_8-1-å¼•å…¥ä¾èµ–"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_8-1-å¼•å…¥ä¾èµ–"}},[e._v("#")]),e._v(" 8.1 å¼•å…¥ä¾èµ–")]),e._v(" "),r("p",[e._v("å’Œ "),r("a",{attrs:{href:"https://www.iocoder.cn/Spring-Boot/ActiveMQ/?self#",target:"_blank",rel:"noopener noreferrer"}},[e._v("ã€Œ3.1 å¼•å…¥ä¾èµ–ã€"),r("OutboundLink")],1),e._v(" ä¸€è‡´ï¼Œè§ "),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo-consume-retry/pom.xml",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("pom.xml")]),r("OutboundLink")],1),e._v(" æ–‡ä»¶ã€‚")]),e._v(" "),r("h2",{attrs:{id:"_8-2-åº”ç”¨é…ç½®æ–‡ä»¶"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_8-2-åº”ç”¨é…ç½®æ–‡ä»¶"}},[e._v("#")]),e._v(" 8.2 åº”ç”¨é…ç½®æ–‡ä»¶")]),e._v(" "),r("p",[e._v("å’Œ "),r("a",{attrs:{href:"https://www.iocoder.cn/Spring-Boot/ActiveMQ/?self#",target:"_blank",rel:"noopener noreferrer"}},[e._v("ã€Œ3.1.2 åº”ç”¨é…ç½®æ–‡ä»¶ã€"),r("OutboundLink")],1),e._v(" ä¸€è‡´ï¼Œè§ "),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo-consume-retry/src/main/resources/application.yaml",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("application.yaml")]),r("OutboundLink")],1),e._v(" æ–‡ä»¶ã€‚")]),e._v(" "),r("h2",{attrs:{id:"_8-3-activemqconfig"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_8-3-activemqconfig"}},[e._v("#")]),e._v(" 8.3 ActiveMQConfig")]),e._v(" "),r("p",[e._v("åœ¨ "),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo-consume-retry/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/config",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("cn.iocoder.springboot.lab32.activemqdemo.config")]),r("OutboundLink")],1),e._v(" åŒ…ä¸‹ï¼Œåˆ›å»º "),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo-consume-retry/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/config/ActiveMQConfig.java",target:"_blank",rel:"noopener noreferrer"}},[e._v("ActiveMQConfig"),r("OutboundLink")],1),e._v(" ç±»ï¼Œå®ç° "),r("a",{attrs:{href:"https://github.com/spring-projects/spring-boot/blob/master/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/jms/activemq/ActiveMQConnectionFactoryCustomizer.java",target:"_blank",rel:"noopener noreferrer"}},[e._v("ActiveMQConnectionFactoryCustomizer"),r("OutboundLink")],1),e._v(" æ¥å£ï¼Œå¯ä»¥å¯¹ Spring Boot è‡ªåŠ¨åˆ›å»ºçš„ "),r("a",{attrs:{href:"https://github.com/apache/activemq/blob/master/activemq-client/src/main/java/org/apache/activemq/ActiveMQConnectionFactory.java",target:"_blank",rel:"noopener noreferrer"}},[e._v("ActiveMQConnectionFactory"),r("OutboundLink")],1),e._v(" è¿›è¡Œ"),r("strong",[e._v("è‡ªå®šä¹‰é…ç½®")]),e._v("ã€‚ä»£ç å¦‚ä¸‹ï¼š")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v('// ActiveMQConfig.java\n\n@Configuration\npublic class ActiveMQConfig implements ActiveMQConnectionFactoryCustomizer {\n\n    private Logger logger = LoggerFactory.getLogger(getClass());\n\n    @Override\n    public void customize(ActiveMQConnectionFactory factory) {\n        logger.info("[customize][é»˜è®¤é‡è¯•ç­–ç•¥: {}]", factory.getRedeliveryPolicy());\n    }\n\n}\n')])])]),r("ul",[r("li",[r("p",[e._v("é»˜è®¤æƒ…å†µä¸‹ï¼Œå·²ç»å¼€å¯ ActiveMQ ReDelivery æœºåˆ¶ã€‚è¿™é‡Œï¼Œæˆ‘ä»¬å…ˆæ‰“å°ä¸‹é»˜è®¤çš„ "),r("a",{attrs:{href:"https://github.com/apache/activemq/blob/master/activemq-client/src/main/java/org/apache/activemq/RedeliveryPolicy.java",target:"_blank",rel:"noopener noreferrer"}},[e._v("RedeliveryPolicy"),r("OutboundLink")],1),e._v(" é‡æŠ•ç­–ç•¥ã€‚å¦‚ä¸‹ï¼š")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("2019-12-15 23:01:41.406  INFO 93850 --- [           main] QConfig$$EnhancerBySpringCGLIB$$13367ef1 : [customize][é»˜è®¤é‡è¯•ç­–ç•¥: RedeliveryPolicy {destination = null, collisionAvoidanceFactor = 0.15, maximumRedeliveries = 6, maximumRedeliveryDelay = -1, initialRedeliveryDelay = 1000, useCollisionAvoidance = false, useExponentialBackOff = false, backOffMultiplier = 5.0, redeliveryDelay = 1000, preDispatchCheck = true}]\n")])])]),r("ul",[r("li",[e._v("é»˜è®¤é‡æŠ• 6 æ¬¡ï¼Œæ¯æ¬¡é—´éš” 1000 æ¯«ç§’ã€‚")])])]),e._v(" "),r("li",[r("p",[e._v("å¦‚æœèƒ–å‹æƒ³è¦åˆ›å»º RedeliveryPolicy å¯¹è±¡ï¼Œè‡ªå®šä¹‰é‡æŠ•ç­–ç•¥ã€‚æ›´å¤šå¯ä»¥å‚è€ƒ "),r("a",{attrs:{href:"https://activemq.apache.org/redelivery-policy",target:"_blank",rel:"noopener noreferrer"}},[e._v("ã€ŠActiveMQ æ–‡æ¡£ â€”â€” Redelivery Policyã€‹"),r("OutboundLink")],1),e._v(" ã€‚")])])]),e._v(" "),r("h2",{attrs:{id:"_8-4-demo05message"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_8-4-demo05message"}},[e._v("#")]),e._v(" 8.4 Demo05Message")]),e._v(" "),r("p",[e._v("åœ¨ "),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo-consume-retry/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/message",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("cn.iocoder.springboot.lab32.activemqdemo.message")]),r("OutboundLink")],1),e._v(" åŒ…ä¸‹ï¼Œåˆ›å»º "),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo-consume-retry/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/message/Demo05Message.java",target:"_blank",rel:"noopener noreferrer"}},[e._v("Demo05Message"),r("OutboundLink")],1),e._v(" æ¶ˆæ¯ç±»ï¼Œæä¾›ç»™å½“å‰ç¤ºä¾‹ä½¿ç”¨ã€‚")]),e._v(" "),r("p",[e._v("å’Œ"),r("a",{attrs:{href:"https://www.iocoder.cn/Spring-Boot/ActiveMQ/?self#",target:"_blank",rel:"noopener noreferrer"}},[e._v("ã€Œ3.4 Demo01Messageã€"),r("OutboundLink")],1),e._v("ä¸€è‡´ï¼Œåªæ˜¯ Queue åå­—ä¸åŒã€‚")]),e._v(" "),r("h2",{attrs:{id:"_8-5-demo05producer"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_8-5-demo05producer"}},[e._v("#")]),e._v(" 8.5 Demo05Producer")]),e._v(" "),r("p",[e._v("åœ¨ "),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo-consume-retry/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/producer",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("cn.iocoder.springboot.lab32.activemqdemo.producer")]),r("OutboundLink")],1),e._v(" åŒ…ä¸‹ï¼Œåˆ›å»º "),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo-consume-retry/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/producer/Demo05Producer.java",target:"_blank",rel:"noopener noreferrer"}},[e._v("Demo05Producer"),r("OutboundLink")],1),e._v(" ç±»ï¼Œå®ƒä¼šä½¿ç”¨ Spring-JMS å°è£…æä¾›çš„ JmsMessagingTemplate ï¼Œå®ç°å‘é€æ¶ˆæ¯ã€‚")]),e._v(" "),r("p",[e._v("å’Œ"),r("a",{attrs:{href:"https://www.iocoder.cn/Spring-Boot/ActiveMQ/?self#",target:"_blank",rel:"noopener noreferrer"}},[e._v("ã€Œ3.5 Demo01Producerã€"),r("OutboundLink")],1),e._v("ä¸€è‡´ï¼Œåªæ˜¯ Queue åå­—ä¸åŒã€‚")]),e._v(" "),r("h2",{attrs:{id:"_8-6-demo05consumer"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_8-6-demo05consumer"}},[e._v("#")]),e._v(" 8.6 Demo05Consumer")]),e._v(" "),r("p",[e._v("åœ¨ "),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo-consume-retry/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/consumer",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("cn.iocoder.springboot.lab32.activemqdemo.consumer")]),r("OutboundLink")],1),e._v(" åŒ…ä¸‹ï¼Œåˆ›å»º "),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-32/lab-32-activemq-demo-consume-retry/src/main/java/cn/iocoder/springboot/lab32/activemqdemo/consumer/Demo05Consumer.java",target:"_blank",rel:"noopener noreferrer"}},[e._v("Demo05Consumer"),r("OutboundLink")],1),e._v(" ç±»ï¼Œæ¶ˆè´¹æ¶ˆæ¯ã€‚ä»£ç å¦‚ä¸‹ï¼š")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v('// Demo05Consumer.java\n\n@Component\npublic class Demo05Consumer {\n\n    private Logger logger = LoggerFactory.getLogger(getClass());\n\n    @JmsListener(destination = Demo05Message.QUEUE)\n    public void onMessage(Demo05Message message) {\n        logger.info("[onMessage][çº¿ç¨‹ç¼–å·:{} æ¶ˆæ¯å†…å®¹ï¼š{}]", Thread.currentThread().getId(), message);\n        // <X> æ³¨æ„ï¼Œæ­¤å¤„æŠ›å‡ºä¸€ä¸ª RuntimeException å¼‚å¸¸ï¼Œæ¨¡æ‹Ÿæ¶ˆè´¹å¤±è´¥\n        throw new RuntimeException("æˆ‘å°±æ˜¯æ•…æ„æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸");\n    }\n\n}\n')])])]),r("ul",[r("li",[e._v("åœ¨ "),r("code",[e._v("<X>")]),e._v(" å¤„ï¼Œæˆ‘ä»¬åœ¨æ¶ˆè´¹æ¶ˆæ¯æ—¶å€™ï¼ŒæŠ›å‡ºä¸€ä¸ª RuntimeException å¼‚å¸¸ï¼Œæ¨¡æ‹Ÿæ¶ˆè´¹å¤±è´¥ã€‚")])]),e._v(" "),r("h2",{attrs:{id:"_8-7-ç®€å•æµ‹è¯•"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_8-7-ç®€å•æµ‹è¯•"}},[e._v("#")]),e._v(" 8.7 ç®€å•æµ‹è¯•")]),e._v(" "),r("p",[e._v("åˆ›å»º "),r("a",{attrs:{href:"https://github.com/YunaiV/SpringBoot-Labs/blob/master/lab-32/lab-32-activemq-demo-consume-retry/src/test/java/cn/iocoder/springboot/lab32/activemqdemo/producer/Demo05ProducerTest.java",target:"_blank",rel:"noopener noreferrer"}},[e._v("Demo05ProducerTest"),r("OutboundLink")],1),e._v(" æµ‹è¯•ç±»ï¼Œç¼–å†™å•å…ƒæµ‹è¯•æ–¹æ³•ï¼Œæµ‹è¯•"),r("strong",[e._v("æ¶ˆè´¹é‡è¯•")]),e._v("çš„æ•ˆæœã€‚ä»£ç å¦‚ä¸‹ï¼š")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v('// Demo05ProducerTest.java\n\n@RunWith(SpringRunner.class)\n@SpringBootTest(classes = Application.class)\npublic class Demo05ProducerTest {\n\n    private Logger logger = LoggerFactory.getLogger(getClass());\n\n    @Autowired\n    private Demo05Producer producer;\n\n    @Test\n    public void testSyncSend() throws InterruptedException {\n        // å‘é€æ¶ˆæ¯\n        int id = (int) (System.currentTimeMillis() / 1000);\n        producer.syncSend(id);\n        logger.info("[testSyncSend][å‘é€ç¼–å·ï¼š[{}] å‘é€æˆåŠŸ]", id);\n\n        // é˜»å¡ç­‰å¾…ï¼Œä¿è¯æ¶ˆè´¹\n        new CountDownLatch(1).await();\n    }\n\n}\n')])])]),r("p",[e._v("æˆ‘ä»¬æ¥æ‰§è¡Œ "),r("code",[e._v("#testSyncSend()")]),e._v(" æ–¹æ³•ï¼Œæµ‹è¯• Consumer æ¶ˆè´¹é‡è¯•çš„æ•ˆæœã€‚æ§åˆ¶å°è¾“å‡ºå¦‚ä¸‹ï¼š")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("// Producer åŒæ­¥å‘é€æ¶ˆæ¯æˆåŠŸã€‚\n2019-12-15 23:04:26.865  INFO 94045 --- [           main] c.i.s.l.a.producer.Demo05ProducerTest    : [testSyncSend][å‘é€ç¼–å·ï¼š[1576422266] å‘é€æˆåŠŸ]\n\n// Consumer ç¬¬ 1 æ¬¡æ¶ˆè´¹\n2019-12-15 23:04:26.868  INFO 94045 --- [enerContainer-1] c.i.s.l.a.consumer.Demo05Consumer        : [onMessage][çº¿ç¨‹ç¼–å·:18 æ¶ˆæ¯å†…å®¹ï¼šDemo05Message{id=1576422266}]\n2019-12-15 23:04:26.877  WARN 94045 --- [enerContainer-1] o.s.j.l.DefaultMessageListenerContainer  : Execution of JMS message listener failed, and no ErrorHandler has been set.\n\norg.springframework.jms.listener.adapter.ListenerExecutionFailedException: Listener method 'public void cn.iocoder.springboot.lab32.activemqdemo.consumer.Demo05Consumer.onMessage(cn.iocoder.springboot.lab32.activemqdemo.message.Demo05Message)' threw exception; nested exception is java.lang.RuntimeException: æˆ‘å°±æ˜¯æ•…æ„æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸\n    // ... çœç•¥å¼‚å¸¸å †æ ˆ\n\n// 1 ç§’åï¼ŒConsumer ç¬¬ 1 æ¬¡é‡è¯•æ¶ˆè´¹\n2019-12-15 23:04:27.875  INFO 94045 --- [enerContainer-1] c.i.s.l.a.consumer.Demo05Consumer        : [onMessage][çº¿ç¨‹ç¼–å·:18 æ¶ˆæ¯å†…å®¹ï¼šDemo05Message{id=1576422266}]\n2019-12-15 23:04:27.877  WARN 94045 --- [enerContainer-1] o.s.j.l.DefaultMessageListenerContainer  : Execution of JMS message listener failed, and no ErrorHandler has been set.\n\norg.springframework.jms.listener.adapter.ListenerExecutionFailedException: Listener method 'public void cn.iocoder.springboot.lab32.activemqdemo.consumer.Demo05Consumer.onMessage(cn.iocoder.springboot.lab32.activemqdemo.message.Demo05Message)' threw exception; nested exception is java.lang.RuntimeException: æˆ‘å°±æ˜¯æ•…æ„æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸\n    // ... çœç•¥å¼‚å¸¸å †æ ˆ\n\n// 1 ç§’åï¼ŒConsumer ç¬¬ 2 æ¬¡é‡è¯•æ¶ˆè´¹\n2019-12-15 23:04:28.878  INFO 94045 --- [enerContainer-1] c.i.s.l.a.consumer.Demo05Consumer        : [onMessage][çº¿ç¨‹ç¼–å·:18 æ¶ˆæ¯å†…å®¹ï¼šDemo05Message{id=1576422266}]\n2019-12-15 23:04:28.879  WARN 94045 --- [enerContainer-1] o.s.j.l.DefaultMessageListenerContainer  : Execution of JMS message listener failed, and no ErrorHandler has been set.\n\norg.springframework.jms.listener.adapter.ListenerExecutionFailedException: Listener method 'public void cn.iocoder.springboot.lab32.activemqdemo.consumer.Demo05Consumer.onMessage(cn.iocoder.springboot.lab32.activemqdemo.message.Demo05Message)' threw exception; nested exception is java.lang.RuntimeException: æˆ‘å°±æ˜¯æ•…æ„æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸\n    // ... çœç•¥å¼‚å¸¸å †æ ˆ\n\n// 1 ç§’åï¼ŒConsumer ç¬¬ 3 æ¬¡é‡è¯•æ¶ˆè´¹\n2019-12-15 23:04:29.884  INFO 94045 --- [enerContainer-1] c.i.s.l.a.consumer.Demo05Consumer        : [onMessage][çº¿ç¨‹ç¼–å·:18 æ¶ˆæ¯å†…å®¹ï¼šDemo05Message{id=1576422266}]\n2019-12-15 23:04:29.887  WARN 94045 --- [enerContainer-1] o.s.j.l.DefaultMessageListenerContainer  : Execution of JMS message listener failed, and no ErrorHandler has been set.\n\norg.springframework.jms.listener.adapter.ListenerExecutionFailedException: Listener method 'public void cn.iocoder.springboot.lab32.activemqdemo.consumer.Demo05Consumer.onMessage(cn.iocoder.springboot.lab32.activemqdemo.message.Demo05Message)' threw exception; nested exception is java.lang.RuntimeException: æˆ‘å°±æ˜¯æ•…æ„æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸\n    // ... çœç•¥å¼‚å¸¸å †æ ˆ\n\n// 1 ç§’åï¼ŒConsumer ç¬¬ 4 æ¬¡é‡è¯•æ¶ˆè´¹\n2019-12-15 23:04:30.887  INFO 94045 --- [enerContainer-1] c.i.s.l.a.consumer.Demo05Consumer        : [onMessage][çº¿ç¨‹ç¼–å·:18 æ¶ˆæ¯å†…å®¹ï¼šDemo05Message{id=1576422266}]\n2019-12-15 23:04:30.890  WARN 94045 --- [enerContainer-1] o.s.j.l.DefaultMessageListenerContainer  : Execution of JMS message listener failed, and no ErrorHandler has been set.\n\norg.springframework.jms.listener.adapter.ListenerExecutionFailedException: Listener method 'public void cn.iocoder.springboot.lab32.activemqdemo.consumer.Demo05Consumer.onMessage(cn.iocoder.springboot.lab32.activemqdemo.message.Demo05Message)' threw exception; nested exception is java.lang.RuntimeException: æˆ‘å°±æ˜¯æ•…æ„æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸\n    // ... çœç•¥å¼‚å¸¸å †æ ˆ\n\n// 1 ç§’åï¼ŒConsumer ç¬¬ 5 æ¬¡é‡è¯•æ¶ˆè´¹\n2019-12-15 23:04:31.893  INFO 94045 --- [enerContainer-1] c.i.s.l.a.consumer.Demo05Consumer        : [onMessage][çº¿ç¨‹ç¼–å·:18 æ¶ˆæ¯å†…å®¹ï¼šDemo05Message{id=1576422266}]\n2019-12-15 23:04:31.895  WARN 94045 --- [enerContainer-1] o.s.j.l.DefaultMessageListenerContainer  : Execution of JMS message listener failed, and no ErrorHandler has been set.\n\norg.springframework.jms.listener.adapter.ListenerExecutionFailedException: Listener method 'public void cn.iocoder.springboot.lab32.activemqdemo.consumer.Demo05Consumer.onMessage(cn.iocoder.springboot.lab32.activemqdemo.message.Demo05Message)' threw exception; nested exception is java.lang.RuntimeException: æˆ‘å°±æ˜¯æ•…æ„æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸\n    // ... çœç•¥å¼‚å¸¸å †æ ˆ\n\n// 1 ç§’åï¼ŒConsumer ç¬¬ 6 æ¬¡é‡è¯•æ¶ˆè´¹\n2019-12-15 23:04:32.897  INFO 94045 --- [enerContainer-1] c.i.s.l.a.consumer.Demo05Consumer        : [onMessage][çº¿ç¨‹ç¼–å·:18 æ¶ˆæ¯å†…å®¹ï¼šDemo05Message{id=1576422266}]\n2019-12-15 23:04:32.901  WARN 94045 --- [enerContainer-1] o.s.j.l.DefaultMessageListenerContainer  : Execution of JMS message listener failed, and no ErrorHandler has been set.\n\norg.springframework.jms.listener.adapter.ListenerExecutionFailedException: Listener method 'public void cn.iocoder.springboot.lab32.activemqdemo.consumer.Demo05Consumer.onMessage(cn.iocoder.springboot.lab32.activemqdemo.message.Demo05Message)' threw exception; nested exception is java.lang.RuntimeException: æˆ‘å°±æ˜¯æ•…æ„æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸\n    // ... çœç•¥å¼‚å¸¸å †æ ˆ\n")])])]),r("ul",[r("li",[e._v("Consumer é‡è¯•æ¶ˆè´¹æ¶ˆæ¯ 6 æ¬¡ï¼Œæ¯æ¬¡é—´éš” 1 ç§’ï¼Œå…¨éƒ¨éƒ½å¤±è´¥ï¼Œæœ€ç»ˆè¯¥æ¶ˆæ¯è½¬å‘åˆ°æ­»ä¿¡é˜Ÿåˆ—ä¸­ã€‚")])]),e._v(" "),r("p",[e._v("æ­¤æ—¶ï¼Œå¦‚æœæˆ‘ä»¬ä½¿ç”¨ "),r("a",{attrs:{href:"https://activemq.apache.org/web-console",target:"_blank",rel:"noopener noreferrer"}},[e._v("ActiveMQ Web Console"),r("OutboundLink")],1),e._v(" æ¥æŸ¥çœ‹ "),r("code",[e._v('"ActiveMQ.DLQ"')]),e._v(" çš„é˜Ÿåˆ—çš„æ¶ˆæ¯ï¼š")]),e._v(" "),r("p",[r("img",{attrs:{src:"https://raw.githubusercontent.com/lichengcan/images/main/activemq02.png",alt:""}})]),e._v(" "),r("ul",[r("li",[r("code",[e._v('"ActiveMQ.DLQ "')]),e._v(" é˜Ÿåˆ—ä¸­æœ‰ 1 æ¡æ¶ˆæ¯ï¼Œå°±æ˜¯æˆ‘ä»¬åˆšæ¶ˆè´¹å¤±è´¥åˆ°è¾¾ä¸Šé™çš„è¯¥æ¶ˆæ¯ã€‚")])])])}),[],!1,null,null,null);r.default=t.exports}}]);