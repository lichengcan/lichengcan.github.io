(window.webpackJsonp=window.webpackJsonp||[]).push([[70],{486:function(a,t,s){"use strict";s.r(t);var e=s(2),n=Object(e.a)({},(function(){var a=this,t=a._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("blockquote",[t("p",[a._v("参考："),t("a",{attrs:{href:"https://www.cnblogs.com/aeolian/p/14837822.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("https://www.cnblogs.com/aeolian/p/14837822.html"),t("OutboundLink")],1)])]),a._v(" "),t("h2",{attrs:{id:"安装nginx和nginx-rtmp-module"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装nginx和nginx-rtmp-module"}},[a._v("#")]),a._v(" 安装Nginx和nginx-rtmp-module")]),a._v(" "),t("h3",{attrs:{id:"安装make等命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装make等命令"}},[a._v("#")]),a._v(" 安装make等命令")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("yum "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-y")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" gcc automake autoconf libtool "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("make")]),a._v("\nyum "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("wget")]),a._v("\nyum "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("unzip")]),a._v("\n")])])]),t("h3",{attrs:{id:"下载nginx-rtmp-module"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#下载nginx-rtmp-module"}},[a._v("#")]),a._v(" 下载nginx-rtmp-module")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("mkdir")]),a._v(" ~/module     "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 创建下载module的文件夹")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" ~/module\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("wget")]),a._v(" https://github.com/arut/nginx-rtmp-module/archive/master.zip        "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 下载模块")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("unzip")]),a._v(" master.zip      "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 解压")]),a._v("\n")])])]),t("h3",{attrs:{id:"安装nginx"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装nginx"}},[a._v("#")]),a._v(" 安装nginx")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" /\nyum "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-y")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" pcre-devel openssl openssl-devel  "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#安装依赖包")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("wget")]),a._v(" http://nginx.org/download/nginx-1.12.2.tar.gz   "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#下载nginx包")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("tar")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-zxvf")]),a._v(" nginx-1.12.2.tar.gz\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" nginx-1.12.2\n./configure "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--prefix")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/opt/nginx-1.12.2 --with-http_stub_status_module --add-module"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/root/module/nginx-rtmp-module-master --with-http_ssl_module    "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#--prefix=/opt/nginx-1.12.2为安装位置")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("make")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("make")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v("\n")])])]),t("h2",{attrs:{id:"修改nginx配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#修改nginx配置"}},[a._v("#")]),a._v(" 修改nginx配置")]),a._v(" "),t("h3",{attrs:{id:"rtsp转rtmp配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#rtsp转rtmp配置"}},[a._v("#")]),a._v(" rtsp转rtmp配置")]),a._v(" "),t("p",[a._v("vi /opt/nginx-1.12.2/conf/nginx.conf")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("rtmp "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n   "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 转流服务,可以存在多个,每个服务端口要不同")]),a._v("\n   server "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n     listen "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1935")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n     application myapp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("    "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#应用名,可以存在多个")]),a._v("\n        live on"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n        record off"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n        allow play all"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n     "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n   "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])])]),t("p",[t("img",{attrs:{src:"video-stream.assets/image-20240103172622057.png",alt:"image-20240103172622057"}})]),a._v(" "),t("p",[a._v("rtmp协议和http协议是同为应用层的不同协议，rtmp配置需要写在http外面同级。")]),a._v(" "),t("h3",{attrs:{id:"rtsp转hls配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#rtsp转hls配置"}},[a._v("#")]),a._v(" rtsp转hls配置")]),a._v(" "),t("p",[a._v("在http配置中添加如下，直接把m3u8和切片文件放入nginx/hls文件夹下即可。")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("server "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n  listen       "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("8002")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n  server_name  server_hls"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n  location / "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    types "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n       application/vnd.apple.mpegusr m3u8"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n       video/mp2t ts"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n    root hls"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("    "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#8002端口服务的根目录,nginx目录下的hls目录")]),a._v("\n    add_header Cache-Control no-cache"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n    add_header Access-Control-Allow-Origin *"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n    add_header Access-Control-Allow-Headers "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"Origin, X-Requested-With,      Content-Type, Accept"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n    add_header Access-Control-Methods "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"GET, POST, OPTIONS"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])])]),t("p",[t("img",{attrs:{src:"https://img2020.cnblogs.com/blog/1208477/202106/1208477-20210602150925361-417100890.png",alt:"image"}})]),a._v(" "),t("h3",{attrs:{id:"重新载入nginx"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#重新载入nginx"}},[a._v("#")]),a._v(" 重新载入nginx")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("/opt/nginx-1.12.2/sbin/nginx "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-s")]),a._v(" reload\n")])])]),t("p",[a._v('出现如下问题,没有nginx.pid\nnginx: [error] open() "/opt/nginx-1.12.2/logs/nginx.pid" failed (2: No such file or directory)')]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("/opt/nginx-1.12.2/sbin/nginx "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-c")]),a._v(" /opt/nginx-1.12.2/conf/nginx.conf\n")])])]),t("p",[t("img",{attrs:{src:"https://img2020.cnblogs.com/blog/1208477/202106/1208477-20210602095644691-1626029173.png",alt:"image"}})]),a._v(" "),t("h3",{attrs:{id:"启动nginx"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#启动nginx"}},[a._v("#")]),a._v(" 启动nginx")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("/opt/nginx-1.12.2/sbin/nginx\n/opt/nginx-1.12.2/sbin/nginx "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-s")]),a._v(" stop\n")])])]),t("p",[t("img",{attrs:{src:"https://img2020.cnblogs.com/blog/1208477/202106/1208477-20210602095944351-1624208242.png",alt:"image"}})]),a._v(" "),t("h2",{attrs:{id:"安装ffmpeg"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装ffmpeg"}},[a._v("#")]),a._v(" 安装FFmpeg")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("yum "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" yasm "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-y")]),a._v("   "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#安装依赖,自动不行就手动")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" /opt\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("git")]),a._v(" clone https://git.ffmpeg.org/ffmpeg.git ffmpeg  "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#下载ffmpeg,没有git就安装，下面有写Git安装方法")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" ffmpeg\n./configure "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--prefix")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/usr/local/ffmpeg\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("make")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("make")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v("\n")])])]),t("h3",{attrs:{id:"手动安装依赖yasm"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#手动安装依赖yasm"}},[a._v("#")]),a._v(" 手动安装依赖yasm")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("wget")]),a._v(" http://www.tortall.net/projects/yasm/releases/yasm-1.3.0.tar.gz\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("tar")]),a._v(" zxvf yasm-1.3.0.tar.gz\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" yasm-1.3.0\n./configure\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("make")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&&")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("make")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v("\n")])])]),t("h3",{attrs:{id:"拷贝命令到-usr-bin"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#拷贝命令到-usr-bin"}},[a._v("#")]),a._v(" 拷贝命令到/usr/bin")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("ls")]),a._v(" /usr/local/ffmpeg/\nbin    include    lib    share\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("cp")]),a._v(" /usr/local/ffmpeg/bin/*   /usr/bin/\n")])])]),t("p",[t("img",{attrs:{src:"https://img2020.cnblogs.com/blog/1208477/202106/1208477-20210602093711522-371795684.png",alt:"image"}})]),a._v(" "),t("h2",{attrs:{id:"测试"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#测试"}},[a._v("#")]),a._v(" 测试")]),a._v(" "),t("h3",{attrs:{id:"rtsp转rtmp"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#rtsp转rtmp"}},[a._v("#")]),a._v(" RTSP转RTMP")]),a._v(" "),t("p",[a._v("rtsp地址为源地址，rtmp后面为Nginx视频服务器的ip+Nginx配置的1935端口/application名/视频名")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("ffmpeg "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-rtsp_transport")]),a._v(" tcp  "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-i")]),a._v(" rtsp://10.23.6.199:554/openUrl/PUjewmI "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-acodec")]),a._v(" aac "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-strict")]),a._v(" experimental "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-ar")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("44100")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-ac")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-b:a")]),a._v(" 96k "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-r")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("25")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-b:v")]),a._v(" 500k "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-s")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("640")]),a._v("*480 "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-f")]),a._v(" flv rtmp://192.168.104.129:1935/myapp/23\n")])])]),t("p",[a._v("正常情况：")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://img2020.cnblogs.com/blog/1208477/202106/1208477-20210602103234658-1749735345.png",alt:"image"}})]),a._v(" "),t("p",[a._v("实际报错了：")]),a._v(" "),t("p",[t("img",{attrs:{src:"video-stream.assets/image-20240103172918659.png",alt:"image-20240103172918659"}})]),a._v(" "),t("p",[a._v("成功后可以在vlc中打开转换后的rtmp地址")]),a._v(" "),t("h3",{attrs:{id:"rtsp转hls"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#rtsp转hls"}},[a._v("#")]),a._v(" RTSP转HLS")]),a._v(" "),t("p",[a._v("HLS (HTTP Live Streaming)是Apple的动态码率自适应技术。主要用于PC和Apple终端的音视频服务。包括一个m3u(8)的索引文件，TS媒体分片文件和key加密串文件。\n在上文nginx中/hls的root部分配置了html路径，对应nginx目录下的html文件夹，用于存储m3u8文件及ts文件\n此时ffmpeg的命令使用,将在nginx/hls文件夹生成test.m3u8文及切片视频。")]),a._v(" "),t("p",[a._v("转成hls也报错：")]),a._v(" "),t("p",[t("img",{attrs:{src:"video-stream.assets/image-20240103174621565.png",alt:"image-20240103174621565"}})]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("ffmpeg "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-f")]),a._v(" rtsp "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-rtsp_transport")]),a._v(" tcp "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-i")]),a._v(" rtsp://10.23.6.199:554/openUrl/NqfcHMA "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-codec")]),a._v(" copy "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-f")]),a._v(" hls "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-hls_list_size")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("10")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-hls_wrap")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("20")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-hls_time")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("15")]),a._v("  /opt/nginx-1.12.2/hls/test.m3u8\n\nffmpeg "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-rtsp_transport")]),a._v(" tcp "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-i")]),a._v(" rtsp://10.23.6.199:554/openUrl/gwpV2YE "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-codec")]),a._v(" copy "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-f")]),a._v(" hls "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-hls_list_size")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("10")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-hls_time")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("15")]),a._v(" /opt/nginx-1.12.2/hls/test.m3u8\n\n\nffmpeg "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-rtsp_transport")]),a._v(" tcp "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-i")]),a._v(" rtsp://10.23.6.199:554/openUrl/oAVQ93O "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-fflags")]),a._v(" +genpts "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-codec")]),a._v(" copy "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-f")]),a._v(" hls "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-hls_list_size")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("10")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-hls_time")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("15")]),a._v(" /opt/nginx-1.12.2/hls/test.m3u8\n\nffmpeg "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-rtsp_transport")]),a._v(" tcp "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-i")]),a._v(" rtsp://10.23.6.199:554/openUrl/ooK7MiY "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-codec")]),a._v(" copy "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-f")]),a._v(" hls "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-hls_list_size")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("10")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-hls_time")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("5")]),a._v(" /opt/nginx-1.12.2/hls/test.m3u8\n\n\nffmpeg "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-rtsp_transport")]),a._v(" tcp "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-i")]),a._v(" rtsp://10.23.6.199:554/openUrl/ooK7MiY "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-fflags")]),a._v(" +genpts "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-codec")]),a._v(" copy "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-f")]),a._v(" hls "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-hls_list_size")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("10")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-hls_time")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("5")]),a._v(" /opt/nginx-1.12.2/hls/test.m3u8\n\n\n\nhttp://192.168.104.129/hls/test.m3u8\n")])])]),t("p",[a._v("换了命令后可以了：")]),a._v(" "),t("p",[t("img",{attrs:{src:"video-stream.assets/image-20240103174645035.png",alt:"image-20240103174645035"}})]),a._v(" "),t("p",[a._v("但是vlc播不了")]),a._v(" "),t("p",[t("img",{attrs:{src:"video-stream.assets/image-20240103174716551.png",alt:"image-20240103174716551"}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://img2020.cnblogs.com/blog/1208477/202106/1208477-20210602151437293-723366573.png",alt:"image"}}),a._v("+")]),a._v(" "),t("p",[a._v("vlc中输入http://192.168.104.129:80/test.m3u8\nvlc不播放时，在浏览器输入地址看看是否可以直接下载m3u8文件，如果不能下载检查nginx根目录下hls文件夹内是否生成文件,如果已经生成检查conf/nginx.conf配置文件是否配置正确。")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://img2020.cnblogs.com/blog/1208477/202106/1208477-20210602151515959-1317822291.png",alt:"image"}})]),a._v(" "),t("h3",{attrs:{id:"git安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#git安装"}},[a._v("#")]),a._v(" Git安装")]),a._v(" "),t("blockquote",[t("p",[a._v("git clone https://git.ffmpeg.org/ffmpeg.git ffmpeg\nbash: git: 未找到命令...")])]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("对于Debian/Ubuntu系统：\nsudo apt-get update\nsudo apt-get install git\n\n对于CentOS/RHEL系统：\nsudo yum install git\n")])])])])}),[],!1,null,null,null);t.default=n.exports}}]);